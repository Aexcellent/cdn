国内图书分类号：U293.1 国际图书分类号：656.2

密 级：公开

西 南 交 通 大 学 研 究 生 学 位 论 文

云环境下铁水联运信息平台 关键技术研究

年

级

姓

名

申请学位级别

专

业

指导老 师

2009 黄强 工学博士 物流工程 倪少权

二零一七年八月

Classified Index: U293.1 U.D.C: 656.2
Southwest Jiaotong University Doctor Degree Dissertation
Research on the Key Technology of the Rail-Water Intermodal Transportation
Information Platform under Cloud Environment
Grade: 2009 Candidate: HuangQiang Academic Degree Applied for : Doctor of Engineering Speciality: Logistics Engineering Supervisor: NiShaoQuan
Aug, 2017

西 南 交 通 大 学   学 位论 文版 权使 用 授 权 书

本 学 位 论文 作 者完 全 了 解 学 校有 关 保 ｍ 、 使 川 学 位论 文 的 规 定 ，

冋 ．  

留 并向 国 家有关 部 门或机构送交 论文的 复印 件和 电

版 ｒ

，

允 许论 文被 作 阅 和借 阅

、  

本 人授 权 西 南 交 通 大 学 可 以 将 本 论 文 的 全 部 或 部 分 内 容 编 入 有 关 数 据 库 进 行 检

索 ， 可 以 采 用 影 印 、 缩 印 或 扫 描 等 复 印 手段 保 存 和 汇 编 本 学 位 论 文 。  

本 学位 论文 属 于  

保 密 在 １ ．

□ ，

年 解 密 后 适 用 本 授 权 书 ；  

２ ． 不 保 密 ０＾ 使 用 本 授权 书 。  

请在 方 框 打 （

以上

内

Ｖ ＂ ＂ ）

＼

学位 论 文作 者 签 名 ：

指 导 老 师 签 名 ：

於 作 期 曰

：

．

 期 ？

日

：

１  

西 南交通大学傅士学 位论 文创 新性 声 明  

本人郑重声明 ：

所呈交的 学位论 文，

是在 异师指 妤

卜 独 立迸 彳丨 研 宂

： 作 所 以
丨

的 成 果 。 除 文 中 已 经 注 明 引 用 的 内 容 外 ， 木 论 文 不 包 含 任 何 其 他 个 人 成 圯 体

发表 或 撰 写 过 的 研 宄 成 果 。 对 本 文 的 研 宂 做 山 贡 献 的 个 人 和 集 休 ， 均 已 作 义 中 作

了 明 确 的 说 明 。 本 人 完 全意 识 到 本 声 明 的 法 律 结 果 由 木 人 承 祀 。  

本 学位 论 文 的 主 要 创 新 点 如 下 ：  

１ ． 构 建 了 基 于虚 拟 资 源 分 层 融 合 管 理 的 铁 水 联 运 云 平 台 技 术 构 架 （ Ｈ Ｆ ＣＡ ） 。 该 构 架 结 合 铁 水 联 运 云 平 台 的 云 服 务 栈 对 “ 烟 囱 式 ” 系 统 进 行 横 向 解 耦 ， 自 底 向 上   划 分 为 资 源 、 业 务 和 数据 三层 ， 利 用 虚 拟 化 技 术对 资 源 进 行 池 化 ， 并 通 过 抽 象 运  

行环境（ ＡＲＥ）为业 务层提 供

ｌ ａａ Ｓ

和

Ｐａ ａ Ｓ

融合 的资源 设

施

；

将

联

运 应

用

划

分

为

四

大

功

能

基 于

源池

立

云

资

，

建

基

原

生

于

的

应

用

重

和

基

于

的

构

成

熟

度

Ｓ

ａ

ａ

Ｓ

应

Ｄ

Ｏ

对

Ａ

架

构

碎

片

化

联运业

的

务

数

据

进

行 集

注 中

册

、

存

储

和 检

服

用

务

模

式

；

形 据  

成

数

，

索

源池 通 可

资

，

并

过

对 量业

进

二

扩

展

的

数

据

应

用

型

行

按

需

挖

掘

和

次

利

大

模

海

数

据

务

，

用

打

破

港

了

以

口

心

运

为

中

的

联

信

息

分

散

局

布

下

系

统

互孤立 的 相

建

式

构

模

。

（

详

３

．２

见

和

３

．４

节

）

２ ？

构

建

云环
了 境

基

下

于

所 理 应 统一

层

管

的

用

抽

象

为

Ｄ

ｅ

ｖ／

Ｏ

ｓ

的

ｐ

“
联

运

应

用

一

联运

体

化

应

理

用

体

管

元

”

ＩＴ

Ａ

Ｐ

Ｐ

单

以

屏

蔽

其

（

）

Ｍ

ＩＡ

Ｓ

。

系

（

）

将

硬
软 件

异

构

性

业 务
， 并

用 采

Ｄ

ｅ

ｖ

Ｏ

ｓ

作

ｐ

云环境

为

下

的

信

一

理

息

体

化

管

模

式

，

使

联

运应 用

的

交

付

和 运 维 合  

二

一

镜

为

，

首

先

，

以

虚

拟

像

为

载

体

设

计

应

用

持

续

集

建

型

，

了

成

构

模

避

免

人工

程其

交

过

付

；

次

，

在

源
资

撑

运环

Ａ

Ｒ

Ｅ

上

提

支

体

系

的

抽

象

行

境

，

（

出

了

）

运应 用

元”
单 的

动署 法 可

理

自

部

和

高

用

集

群

管

模

算

提

型

，

高

联运应

了

用

服
和

可 靠

后

立

基于 Ｓ

Ｓ

Ｏ

率

务

性

：

最

，

建

了

和

Ｒ

Ｂ

Ａ

Ｃ

的

统一 应

用

访

控
问 制

现

环

了

租

户

境

多

联运应 池

的

下

用

集

中 访

理。

见

问

控

制

管

（

４

．３

详

和

４ ．４ 节

立 了

提

３

？

出

Ｅ

Ｄ



Ｉ 系

云环
了 境

面 下

统

的

自

伸

缩

机

向

微

服

Ｍ

Ｓ

Ｏ

Ａ

运

共

务

构

架

的

轻

量

（

）

级

联

息

信

享

模

。

用

量

制

采

轻

级

的

Ｍ

Ｓ

Ａ

代

替

总

线

型

息

信

共

享

服

层

建

了

面

向

的

两

共

型

，

微

务

享

模

并

基

于

运 “

”

联

服

Ｉ

Ｓ

Ｕ

务

单

元

Ｔ

（

）

对

信

互

进

角

色

、

交

和

流

程

行

虚

拟

封
化 装

，

建

立 了 去

心

中

化

“ 运应

联

的

用

集

联运应 理

使

用

管

与

信

息

合二为 一

服

共

享

利

；

用

微

和

务

分

式

队

布

列

对

成 单

Ｅ

Ｄ

Ｉ

重 构

立

Ｋ

Ｓ

Ｓ

环

，

建

了



下

境

可 动

态

展

扩

的

分

布

式

报

理

文

并

发

处

体

系

和

ｐ 〇

基

缩

模

型

，

提

并

出

了

于

多

指

载

和

标

负

集

排

队

论

应组

优

化

控

制

适

的

自

件

伸

了

低

基 于

的 效
“ 联  

运维
的 效

策

略

，

实

）

型

，

并

建

，

构

架

构

共
息 享 的

元ｍ

ｕ

，

（

广

统进

系

行

Ｄ 水

平 伸

法

，

缩

算

过

通

时

的

实

负

载

伸

缩

阈

值

对

Ｐ

Ｄ

Ｏ

副

源

负

载

、

限

和

资

额

需

求

差

异

，

用

性

采

化

优

，

提

源

了

虚

高

拟

资

用

和

报

利

率

文

４

？

提

出

入 Ｓ

￥

Ｓ Ｊ

订

单

ａ

ｒ

ｋ

ｐ

撮

合

推

高

了

被

荐

于运

了

基

联

大

据

的

数

智

能

Ｈ

ａ

ｄ

和

ｏ

ｏ

ｐ

分

计

布

式

算

框

题立
问

批量

建

基

了

于

订

单

細 — 人 工

鱼

群

的

力

和

束

条

件

货

主

行

为

反

联巧 运 经 营

可

人

的

接

。

受

度

本

集

自

量

扩

动

定

缩

，

容

同

时

考

虑

ｐ

Ｄ

〇

改

进

的

Ｄ

Ｒ

Ｆ

算

法

对

Ｐ

Ｏ

Ｄ

副

本

资

吐。

见

吞

量

（

２

５

．

５

．

详

，

３

和

５



４

节

Ｍ

订

单

撮

合

系

统

｜〇 （

Ｓ

型

和

）模

个

性

源 分 ）

化

撮

架

对

既

有

的

离

“

推 荐

进 扩 展 型

，

模

行

、

业

特

征

历

史

数

务

据

和

行

为

銅过騰制翻进行 求

馈

数

据

对推 荐

列

表

进

持
行 续

反 馈

， 解

的

闭

（

具

体

章

见文 ６

和

节

论

３

６



４

）

节

数 据

结

合

环 调

的

动

＾

配进 行

合

法 。  

算

对联
针

三 层  
的

特  
订 ｉ
， 提  
整

论

签

学

位

文

作

者

：

名

曰 期

： ２ ０ 氏

年 月
５

曰 ０

西南交通大学博士研究生学位论文

第I页

摘 要
随着进出口贸易量的迅速增长，铁水联运已经成为我国国际贸易的主流运输 方式。作为铁水联运业务信息的载体和协调系统，联运信息平台建设水平的高低 不但直接影响铁水联合物流运输的效率和安全，在很大程度上也决定了铁水联运 的业务质量和服务水平。
近年来，我国主要大型港口基本实现了铁水联运的业务信息化，但由于不同 区域的联运信息化发展不均衡、系统构架僵化、信息共享程度不高、以及数据管 理分析手段欠缺等问题，在很大程度制约了联运信息化的整体发展水平。随着云 计算技术的逐步成熟，以其灵活性、可扩展性、资源共享性和高可靠性等优势， 对从技术上解决这些瓶颈，实现铁水联运信息化的全面转型提供了新方向。
论文围绕云环境下的联运信息平台构建、应用管理、信息共享和大数据处理 过程中的关键问题，主要进行了以下几方面研究工作：
1.分析并构建了铁水联运云平台的技术构架。针对我国目前铁水联运信息系 统建设模式的弊端，将云计算技术引入铁水联运信息化建设，提出了基于虚拟资 源管理的分层融合云构架(HFCA)，自底向上分为资源，业务和数据三层支撑体 系，在资源层采用虚拟化技术对资源进行池化并为业务层提供 IaaS 和 PaaS 融合 的虚拟资源设施；在业务层将联运应用划分为功能资源池，并建立基于云原生的 应用重构和基于成熟度的 SaaS 应用服务模式；在数据层基于 DOA 对碎片化的 联运业务数据进行集中注册、存储和检索，形成数据资源池，并通过建立可扩展 的大数据应用对海量业务数据进行挖掘和二次利用，打破了以港口为中心相互孤 立的“烟囱式”系统构建模式；此外，通过对联运业务需求进行梳理，优化了云 环境下的货运进出口信息流程。
2.建立了云环境下基于 DevOps 的一体化联运应用管理体系(IAMS)。针对联 运信息系统异构化严重，管理效率低下的问题，通过将业务应用抽象为“联运应 用单元(ITAPP)”以屏蔽其软硬件差异，并采用 DevOps 作为云环境下的信息一体 化管理模式，统一了联运应用的交付和运维过程，首先，以虚拟镜像为载体设计 了应用持续集成构建模型，避免了低效的人工交付过程；其次，在资源支撑体系 的抽象运行环境(ARE)上，提出了基于“联运应用单元”的自动部署算法和高可 用集群管理模型，提高了联运应用的运维效率和服务可靠性；然后，建立了基于 SSO 和 RBAC 的统一应用访问控制策略，实现了多租户环境下联运应用池的集 中安全管理；最后，通过云平台构建和应用部署测试验证了虚拟环境的性能优势。
3.提出了基于 MSOA 的联运信息共享模型，并建立了数据交换系统的自伸 缩机制。针对目前联运行业主流的信息集成技术成本高，结构笨重，性能低下的

第 II 页

西南交通大学博士研究生学位论文

问题，首先，采用轻量级的 MSA 代替总线型信息共享构架，构建了面向微服务 的两层共享模型，并利用“联运服务单元(ITSU)”对信息共享的角色、交互和流 程进行虚拟化封装，建立了去中心化的“联运应用集成单元(ITIU)”，使联运应用 管理与信息共享的合二为一，实现低成本的信息按需共享；其次，利用微服务和 分布式队列对 EDI 系统进行重构，建立了 K8S 环境下可动态扩展的分布式报文 并发处理体系和 POD 水平伸缩模型，并提出了基于多指标负载集和排队论优化 控制的自适应组件伸缩算法，通过实时负载的伸缩阈值对 POD 副本集自动定量 扩缩容，同时考虑 POD 的动态负载、资源限额和需求差异性，采用改进的 DRF 算法对 POD 副本资源分配进行优化，利用虚拟资源的按需分配特性提高报文数 据的吞吐量。
4.建立了基于联运大数据的智能订单撮合系统(IOMS)模型，并利用人工鱼群 优化的协同过滤算法对模型进行求解。针对目前联运业务办理过程中，货主与联 运经营人线下匹配不合理和效率低下的问题，基于 Spark 和 Hadoop 分布式计算 框架对既有的离线推荐模型进行扩展，建立了基于批量订单特征、历史业务数据 和行为反馈数据的三层 IOMS 模型，并采用人工鱼群优化的协同过滤算法对模型 进行求解，结合订单特征、运载能力约束条件和货主行为反馈数据对推荐列表进 行持续的闭环调整，可在近线时间内为具有不同偏好的货主识别出若干个满足订 单需求的，可接受度更高的联运经营人。
本文的研究将云计算领域最新技术引入铁水联运信息化建设，在铁水联运云 平台构建的不同层次，结合其业务特点，分别对云环境下应用管理，业务信息共 享和大数据处理等一系列关键技术问题进行了探索，并在作者工作单位的物联云 平台环境下，对相关模型和算法进行了实验分析，验证了铁水联运云平台构建的 可行性，为我国铁水联运信息化的发展提供可借鉴的理论和实践支持。

关键词: 铁水联运云平台，容器云，信息集成即服务，自动伸缩，智能订单撮合， 联运大数据

西南交通大学博士研究生学位论文

第 III 页

Abstract
With the rapid growth of import and export trade, the Rail-river intermodal transport has become the mainstream of the international trade mode of transportation in China. As the carrier and coordinate system of the information of the Rail-river intermodal transport, the level of construction of the combined transport information platform not only directly affects the efficiency and security of the joint logistics transportation, but also determines the quality and service level of the combined transport.
In recent years, China's major large-scale port of the Rail-river intermodal transport business information has been basically achieved. However, due to the uneven development of transport information in different regions, the system framework is rigid, degree of information sharing is not high, and lack of data management analysis and other issues, to a large extent restricted the overall development level of intermodal informatization. With the gradual maturity of cloud computing technology, with its advantages such as flexibility, extensibility, resource sharing and high reliability, it provides a new direction to solve these bottlenecks technically and realize the comprehensive transformation of the informatization of the Rail-river intermodal transport.
In this thesis, the key problems in the construction, application management, information sharing and big data processing of the combined transport information platform in the cloud environment are mainly carried out in the following aspects:
1. The technical framework of the Rail-river intermodal transport cloud platform is analyzed and constructed. In view of the shortcomings of China's current rail-river intermodal transportation information system construction model, the cloud computing technology is introduced into the information construction of the Rail-river intermodal transportation. Based on virtual resource management, hierarchical fusion cloud architecture (HFCA) is proposed, which is divided into three layers: resources, business and data. In the resource layer adopt virtualization technology for pooling resources and providing the business layer IaaS and PaaS fusion virtual resource facilities. In the business layer, the intermodal application is divided into the functional resource pool, and the application reconstruction based on cloud native and the SaaS application service mode based on maturity are established. The data layer is based on the DOA to centralize, store and retrieve the data of the combined transport business of fragmentation, and form a data resource pool, and to excavate and re-use

第 IV 页

西南交通大学博士研究生学位论文

the massive business data through the establishment of scalable big data applications. In this way, the model of "chimney-type" system is broken through the isolation of the port as the center. In addition, by combing through the needs of the combined transport business, the information flow of freight import and export in the cloud environment is optimized.
2. An integrated intermodal application management system (IAMS) based on DevOps in cloud environment is established. The problem is that the system is heterogeneous and inefficient. By abstracting the business application into "intermodal transport application unit (ITAPP)" to shield its hardware and software differences, and DevOps is used as the information integration management mode in the cloud environment to unify the delivery and operation and maintenance of the transport application. First of all, the continuous integration build model is designed with the virtual image as the carrier, which avoids the inefficient manual delivery process; secondly, based on the abstract runtime environment (ARE) of the resource support system, an automatic deployment algorithm and a high availability cluster management model based on the "transport application unit" are proposed to improve the operation and maintenance efficiency and service reliability; then, a unified application access control strategy based on SSO and RBAC is established, which realizes the centralized access control management of the transport application pool in multi-tenant environment; finally, the performance benefits of the virtual environment are verified by application deployment testing.
3. Based on MSOA, this paper presents a model of intermodal transport information sharing and the self-scaling mechanism of data exchange system. In view of the high cost, heavy structure and low performance of the mainstream information integration technology in the transport industry, this thesis puts forward some solutions. First of all, a lightweight MSA is used instead of the bus-type information sharing architecture to construct a two-layer shared model for micro-service. And using the "intermodal transport service unit (ITSU)" to virtualize the role, interaction and process of information sharing, a decentralized intermodal transport integration unit (ITIU) is established. In this way, multimodal transportation application management and information sharing are combined to realize the sharing of low-cost information on demand. There is one more point, the EDI system is reconstructed by micro service and distributed queue, and the distributed packet concurrency processing system and POD horizontal scalable model can be dynamically extended

西南交通大学博士研究生学位论文

第V页

in K8S environment. The adaptive component scaling algorithm based on multi-indicator load set and queuing theory is proposed. The POD replica set is automatically quantified by the scaling threshold of real-time load, while taking into account the dynamic load, resource quota and demand difference of the POD, using the improved DRF algorithm to optimize the allocation of POD replica resources, and the throughput of the message data is improved by using the on - demand feature of virtual resources.
4. An intelligent order matching system (IOMS) model based on the combined transport big data is established, and the model is solved by using the collaborative filtering algorithm of artificial fish swarm optimization. In the process of the current combined operation, the problem of unreasonable and inefficient matching between shippers and co-operators is unreasonable and inefficiencies. Based on the Spark and Hadoop distributed computing framework, the existing off-line recommendation model is extended, and a three-layer IOMS model based on batch order characteristics, historical business data and behavior feedback data is established. What’s more, the collaborative filtering algorithm was optimized by using artificial fish to find the solution to the model. Combined with the order characteristics, carrying capacity constraints and the owner of the behavior of the feedback data on the recommended list of continuous closed-loop adjustment, in the near-line time for the different preferences of the owner to identify a number of orders to meet the needs of the higher acceptable intermodal transport operator.
In this thesis, the latest technology in the field of cloud computing is introduced into the construction of molten metal intermodal information. At the different levels of the construction of the Rail-river intermodal transport cloud platform, combined with its business characteristics, the key technologies such as application management, business information sharing and large data processing are respectively technical issues were explored. The feasibility of the construction of the rail-river intermodal transport cloud platform is verified by the experimental analysis of the IOT cloud platform environment of the author's work unit, which can provide theoretical and practical support for the development of China's rail-river intermodal transport information. Keywords: rail-water intermodal transportation cloud platform, container cloud, information integration as a service, auto-scaling, itelligent order matching, intermodal transportation big-data

第 VI 页

西南交通大学博士研究生学位论文

目录
西南交通大学博士学位论文创新性声明...................................................................................... V 摘 要 ...............................................................................................................................................I
Abstract ........................................................................................................................................... III 目录 ................................................................................................................................................ VI 第 1 章 绪论.....................................................................................................................................1
1.1 研究背景及意义................................................................................................................1 1.1.1 研究背景.................................................................................................................1 1.1.2 研究意义.................................................................................................................2
1.2 国内外研究现状................................................................................................................4 1.2.1 关于铁水联运信息化的研究现状.........................................................................4 1.2.2 关于云计算的研究现状.........................................................................................7
1.3 论文研究目标..................................................................................................................10 1.4 论文的研究内容与组织结构..........................................................................................11
1.4.1 论文研究内容.......................................................................................................11 1.4.2 论文的组织结构...................................................................................................13 第 2 章 铁水联运和云计算技术...................................................................................................16 2.1 铁水联运概述...................................................................................................................16 2.1.1 铁水联运的业务分类和构成主体.......................................................................16 2.1.2 集装箱进出口作业流程分析...............................................................................17
2.1.2.1 集装箱出口作业流程................................................................................17 2.1.2.2 集装箱进口作业流程................................................................................18 2.1.3 集装箱进出口过程的信息共享需求...................................................................19 2.2 云计算概述......................................................................................................................21 2.2.1 云计算定义和特点...............................................................................................21 2.2.2 云计算特征...........................................................................................................21 2.2.3 云服务模型...........................................................................................................22 2.2.4 云构建模式...........................................................................................................23 2.3 云计算关键技术..............................................................................................................23 2.3.1 云平台构建技术...................................................................................................24 2.3.2 大数据技术...........................................................................................................25 2.3.2.1 大数据的定义及特征................................................................................25 2.3.2.2 大数据技术分类........................................................................................26 2.3.2.3 铁水联运的行业大数据............................................................................27 2.4 云计算相关框架..............................................................................................................27 2.4.1 云平台构建框架...................................................................................................27 2.4.2 大数据处理平台...................................................................................................30 2.5 本章小结..........................................................................................................................33 第 3 章 铁水联运云平台的构架设计...........................................................................................35 3.1 现有铁水联运信息系统构建模式弊端分析..................................................................35 3.2 铁水联运云平台的提出..................................................................................................39 3.3 铁水联运云平台的构架设计思路..................................................................................41 3.3.1 采用集约型的大集中管理模式...........................................................................41

西南交通大学博士研究生学位论文

第 VII 页

3.3.2 采用分层的虚拟资源管理构架...........................................................................42 3.3.3 采用业务应用与信息共享融合的设计方案.......................................................42 3.3.4 构建可扩展的数据服务体系...............................................................................43 3.4 铁水联运云平台的系统构架设计..................................................................................43 3.4.0 铁水联运云平台的构建模式...............................................................................44 3.4.1 铁水联运云平台的云服务栈设计.......................................................................46 3.4.2 铁水联运云平台的总体构架设计.......................................................................47 3.4.3 资源支撑体系的构架设计...................................................................................49
3.4.3.1 资源支撑体系的技术构架........................................................................49 3.4.3.2 资源支撑体系的虚拟资源池....................................................................50 3.4.3.3 资源支撑体系的冗余构架........................................................................52 3.4.3.4 基于资源支撑体系的信息交互模式........................................................54 3.4.3.5 基于资源支撑体系的运维模式................................................................55 3.4.4 业务支撑体系的构架设计...................................................................................55 3.4.4.1 业务支撑体系的功能资源池....................................................................55 3.4.4.2 业务支撑体系的系统构架........................................................................57 3.4.4.3 业务支撑体系的应用重构策略................................................................58 3.4.4.4 业务支撑体系的 SaaS 服务模式设计 ......................................................59 3.4.5 数据支撑体系的构架设计...................................................................................60 3.4.5.1 联运大数据的应用需求分析....................................................................61 3.4.5.2 数据支撑体系的技术构架........................................................................63 3.4.6 铁水联运云平台的运营模式...............................................................................65 3.5 云环境下的铁水联运信息流优化..................................................................................66 3.5.1 现有铁水联运流程存在问题...............................................................................66 3.5.2 货运流程优化思路...............................................................................................67 3.5.3 基于 FPMS 的集装箱出口信息流设计...............................................................68 3.5.4 基于 FPMS 的集装箱进口信息流设计...............................................................71 3.5.5 基于 Petri 网的 FPMS 集装箱进出口信息流建模和模型检测 ..........................72 3.5.5.1 Petri 网的基本理论和 OOPN 技术 ............................................................72 3.5.5.2 基于 OOPN 的 FPMS 集装箱进出口流建模.............................................73 3.5.5.3 FPMS 集装箱进出口信息流模型检测.......................................................79 3.5.6 基于 FPMS 的联运数据交换................................................................................82 3.5.5.1 货主/联运经营人提交和获取的数据 ......................................................82 3.5.5.2 铁路与水路部门交换的数据....................................................................83 3.5.5.3 水路与铁路部门交换的数据....................................................................84 3.5.5.4 其他部门对 FPMS 的业务数据需求........................................................85 3.5.5.5 联运公共基础数据....................................................................................85 3.6 本章小结...........................................................................................................................86 第 4 章 云环境下的联运应用管理体系关键技术.......................................................................87 4.1 问题提出..........................................................................................................................87 4.2 构建思路..........................................................................................................................89 4.2.1 建立抽象联运应用模型.......................................................................................89 4.2.2 采用基于持续集成的应用构建模式...................................................................89 4.2.3 建立统一的异构应用部署模型...........................................................................90

第 VIII 页

西南交通大学博士研究生学位论文

4.2.4 建立高可用的弹性集群管理模型.......................................................................90 4.2.5 建立基于 SaaS 的应用安全机制.........................................................................91 4.3 联运应用的抽象定义......................................................................................................91 4.4 基于 DevOps 的一体化联运应用管理体系...................................................................93 4.4.1 应用管理体系的组件设计...................................................................................93 4.4.2 应用持续集成模型...............................................................................................94 4.4.3 应用集群部署模型...............................................................................................95 4.4.4 高可用的应用集群管理模型...............................................................................98
4.4.4.1 模型设计....................................................................................................99 4.4.4.2 基于 MSA 的应用管理优化 ...................................................................100 4.4.5 基于 SaaS 的应用访问控制安全模型...............................................................102 4.4.5.1 SSO 认证模型 ..........................................................................................103 4.4.5.2 基于角色的访问控制模型......................................................................103 4.4.5.3 基于 SSO 和改进 RBAC 模型的 SaaS 访问控制策略..........................104 4.5 应用管理体系实现与云平台的性能测试....................................................................108 4.5.1 云平台的部署模式选择.....................................................................................108 4.5.2 云环境下的 IAMS 部署实现.............................................................................109 4.5.2.1 部署组件..................................................................................................109 4.5.2.2 硬件环境..................................................................................................109 4.5.2.3 虚拟网络..................................................................................................111 4.5.3 云平台的应用性能测试.....................................................................................112 4.5.3.1 应用部署..................................................................................................112 4.5.3.2 实验结果分析..........................................................................................114 4.6 本章小结........................................................................................................................115 第 5 章 云环境下的联运信息共享机制...................................................................................116 5.1 问题提出........................................................................................................................116 5.2 基于 MSOA 的信息共享模型 ......................................................................................119 5.2.1 模型构架设计.....................................................................................................119 5.2.2 ITIU 的定义与设计.............................................................................................121 5.2.2.1 ITIU 的信息共享技术标准......................................................................121 5.2.3.2 ITIU 的定义..............................................................................................121 5.2.3.3 ITIU 的设计实现......................................................................................123 5.3 云环境下的 EDI 系统构架优化 ...................................................................................125 5.3.1 现有 EDI 构架的弊端和优化思路 ....................................................................125 5.3.2 XEDI 的层次构架 ...............................................................................................126 5.3.3 云环境下 XEDI 的组件体系 .............................................................................127 5.3.4 XEDI 的报文处理模型 .......................................................................................129 5.4 XEDI 的伸缩性问题研究 ..............................................................................................131 5.4.1 伸缩性机制研究现状和问题分析.....................................................................132 5.4.2 XEDI 的 POD 状态模型 .....................................................................................132 5.4.3 XEDI 的伸缩模型 ...............................................................................................134 5.4.3.1 伸缩策略的定义.......................................................................................134 5.4.3.2 单指标伸缩模型.......................................................................................135 5.4.3.3 多指标伸缩模型.......................................................................................137

西南交通大学博士研究生学位论文

第 IX 页

5.4.4 XEDI 的负载指标集 ...........................................................................................137 5.4.5 XEDI 的自动伸缩算法 .......................................................................................141 5.4.6 基于排队论模型的 POD 副本集优化...............................................................145 5.4.7 基于 XDRF 的 POD 副本资源分配 ..................................................................147
5.4.7.1 DRF 资源分配算法 ..................................................................................147 5.4.7.2 XDRF 资源分配算法定义 .......................................................................149 5.4.7.3 XDRF 算法公平性分析 ...........................................................................151 5.4.7.4 基于 XDRF 的 POD 扩容过程 ...............................................................152 5.4.8 XEDI 的伸缩性能测试 .......................................................................................154 5.4.8.1 XEDI 的扩容效果测试 ............................................................................155 5.4.8.2 XEDI 在不同伸缩策略下的性能测试 ....................................................157 5.4.8.3 XEDI 在不同虚拟环境的伸缩性能对比.................................................159 5.5 本章小结........................................................................................................................160 第 6 章 基于联运大数据的订单撮合问题研究.........................................................................161 6.1 问题提出........................................................................................................................161 6.2 智能订单撮合系统........................................................................................................163 6.3 IOMS 的数据处理模型和数据传输模块......................................................................164 6.3.1 IOMS 的数据处理模型.......................................................................................164 6.3.2 IOMS 数据传输模块...........................................................................................165 6.3.2.1 离线数据传输模块...................................................................................165 6.3.2.2 在线反馈数据传输模块...........................................................................167 6.4 IOMS 的撮合算法..........................................................................................................168 6.4.1 算法模型.............................................................................................................169 6.4.2 算法性能优化.....................................................................................................169 6.4.3 算法变量定义.....................................................................................................171 6.4.4 算法目标函数.....................................................................................................174 6.4.5 算法约束条件.....................................................................................................174 6.4.6 算法执行步骤.....................................................................................................175 6.4.7 算法评估指标.....................................................................................................176 6.4.8 算法测试与评估.................................................................................................176 6.4.8.1 IOMS 的性能测试....................................................................................176 6.4.8.2 IOMS 推荐效果评估................................................................................177 6.5 本章小结........................................................................................................................181 第 7 章 总结与展望.....................................................................................................................182 7.1 总结.................................................................................................................................182 7.2 展望.................................................................................................................................183 致 谢 ............................................................................................................................................185 参考文献....................................................................................................................................... 186 攻读博士学位期间完成的论文 ................................................................................................... 198

西南交通大学博士研究生学位论文

第1页

第 1 章 绪论
1.1 研究背景及意义
1.1.1 研究背景
随着我国一带一路发展战略的提出，铁水联运在物流领域的重要地位日益凸 显，已经成为中国铁路总公司(铁总)提倡监督改革的重点发展方向。交通运输部， 铁总和基础产业司在推进铁水联运产业发展方面做出了大量卓有成效的工作，有 效促进了铁水联运业务的发展，2011 年 5 月，国内铁路总公司以及交通运输部 共同进行了《有关一起促进铁水联运发展协作合同》的建立，随后进行了《有关 促进铁水联运发展的指导观点和看法》的建立，预计到 2018 年时，集装箱铁水 联运量平均年增长率超过 20%，港口煤炭、矿石、粮食、化肥等大宗散货的铁路 集疏运比重，比 2010 年提高 10 个百分点[1][2]。铁总为了更好的迎合和满足新型 联运市场的基本发展诉求，保证运输监督与控制，成本管理和控制等相关问题得 到妥善应对和处理，进行了“千百战略”的建立和落实，对于原有的运输路线进 行改进和完善，积极进行国内货运干线的发展建设，促进服务质量以及服务效率 的全面提高，逐步进行良好品牌形象的塑造，促进铁水联运领域吸引力的进一步 提升。同时，交通运输部也积极加强港口建设，充分学习国际先进经验，提倡无 纸化单据流通，建设区域性联运电子商务平台，推广国际 EDI (Electronic Data Interchange,电子数据交换)信息交换标准，着力打造了 6 个铁水联运示范通道的 港口及口岸建设，为联运的大力开展积累了宝贵经验。
交通运输部也相继进行了《国务院有关带动海运业稳定迅速发展的相关意见》 的制定和实施，积极促进铁水联运重要通道的发展建设，将铁水联运当成是海上 丝绸之路以及海运实现有机结合的重要通道，切实提升发展建设力度[3]。根据《铁 道统计公报》显示，2014 年全国铁路口岸共完成进出口货运量 0.58 亿吨，同比 增长 7.3%。查阅和分析铁总所公布的数据信息，在前半年当中，固定资产投资 金额达到了 2351.95 亿元以上，和去年同期进行对比分析能够得出，实现了 8.9% 的提升，而且，重要建设投资所涉及的金额达到了 1996.27 亿元，和去年同期进 行对比分析能够得出，实现了 6.8%的提升[4]。
2016 年 5 月，交通运输部联合铁总在辽宁大连召开铁水联运暨多式联运现

第2页

西南交通大学博士研究生学位论文

场推进会，铁路部门将深入推进供给侧改革，与其他交通运输企业共同创造良好 发展环境、统筹做好多式联运规划、推进联运装备多样化、加强铁水联运衔接、 创新联运组织方式，更好推动多式联运的发展[5]。
铁路和港口是铁水联运业务的两大主体，目前各自的建设相对完善。我国铁 路发展水平相对较高，运营水平已处于世界前列，而且港口的发展也十分迅速。 根据我国交通运输部关于港口码头的统计公报统计显示，截至 2015 年我国沿海 大型港口百余个，内陆小型港口达千余个，3.4 万余个生产泊位，居世界第一位， 已经成为世界港口大国，从分布来看，沿海大型港口主要分布在环渤海地区，长 江三角洲地区，东南亚地区，珠江三角洲地区和西南沿海地区，内陆地区在湖北 省，安徽省，江苏省，广西省，广东省，四川省，贵州省，浙江省，福建省，海 南省，湖南省和重庆市等省份均有较多中小型港口分布，集装箱总吞吐量超过 2 亿标准箱(Twentyfoot Equivalent Unit，TEU)，同比增长 4.1%，吞吐量增速也呈 现出明显的区域不均衡性[6]。
虽然我国铁路和港口运输取得了较大发展，但目前铁水联运仍然处在低水平 阶段，联运比重约占港口吞吐量的 1.5%和铁路货运量的 2%，与欧美国家各大港 口铁路集疏量超过 20%的比重落差很大。全国铁路适箱货物仅 25%采用集装箱， 其货物发送量仅占总量的 3%。由于我国铁水联运缺乏统筹，联运技术装备水平 相对落后，联运信息化发展层次不齐，标准未统一等问题都制约了铁水联运整体 水平的发展[7]。
铁水联运作为多式联运的一个分支，是一个由铁路、港口、码头、物流企业 等多角色合作、业务逻辑严密的跨部门物流活动，通常由联运经营人负责全程组 织，铁路和水路运输相互衔接、转运，按联运合同共同完成的货物运输过程，具 有角色多、过程长、环节繁锁、信息量大的特点。作为铁水联运物流活动的重要 组成部分，铁水联运信息化是协调各参与部门，有效提高业务效率和服务质量的 关键，其建设水平的高低直接决定业务系统的运作效率，甚至影响我国整个物流 行业的发展。
1.1.2 研究意义
铁水联运信息化的建设需要打通包括铁路、港口、码头、内陆场站以及国检 等多个跨部门的物流节点，由于我国幅员辽阔，铁路覆盖范围广，港口数量居世 界第一，大规模的货物运输量和运输节点分布使联运信息化建设复杂性与困难性 较其它国家更为突出。目前我国的铁路和各大中型港口均已实现了信息化管理, 部分参与铁水联运活动的港口也自建了的联运信息系统，为港口铁水联运业务的 开展提供了有力的基础保障。但目前我国的联运信息化建设主要还存在以下四方

西南交通大学博士研究生学位论文

第3页

面较问题，影响了整个行业服务水平的提高： (1) 信息布局不合理。由于铁路和水路运输各自成为一个体系,目前的铁水
联运信息系统均以各大型港口为中心，重复建设现象比较严重，港口部门往往着 眼于自身业务需求，铁路和港口均无法从全局掌握业务和运输资源的分布情况； 同时由于缺乏统筹规划，不同港口的联运信息系统之间缺乏业务流程和信息交换 等体系标准，导致信息服务水平参差不齐，也阻碍了铁水联运行业整体水平的迅 速提升。
(2) 信息系统技术落后。现有的铁水联运信息系统普遍采用了软硬件捆绑的 “烟囱式”构架，由于硬件资源利用不充分、分配不均衡、系统可靠性差、不具 备可扩展性，不但成本高昂，服务能力十分有限，而且造成了巨大的资源浪费。
(3) 信息共享不充分。由于缺乏统一的行业标准,不同港口的业务流程不一 致,导致物流转换作业不协调，作业环节衔接时间长,货物中转率低,影响了铁水 联运运输效率的发挥。虽然部分港口通过 EDI 数据交换系统，解决了局部范围 内的信息共享问题，但由于未形成统一的行业数据标准，也造成联运参与部门之 间的业务信息无法充分共享。
(4) 数据管理体系匮乏。以港口为中心的联运信息化布局和“烟囱式”系统 构建模式，使联运业务数据分散沉淀在港口的各个业务系统中，形成信息孤岛， 港口之间联运业务数据的无法集中存储和管理，导致联运数据所蕴藏的巨大潜在 价值无法在现有体系下，得到有效的挖掘和二次利用。云计算作为信息系统建设 的全新理念和发展方向，在工业界和学术界都得到了广泛的关注，已被众多发达 国家已被确立为国家级发展战略，我国也制定了相关运营计划。云计算为分布式 计算、网格计算以及互联网等一系列技术的有机结合，与传统的信息技术相比， 主要有以下三方面优势：
(1) 从硬件角度，云计算采用计算资源的按需分配方式，能以很低的成本按 需获取足够的计算资源，而无需耗费太多时间去估算提供服务所需要的资源，大 幅降低信息化的硬件成本投入。
(2) 从软件角度，云计算提供了模块化的大规模分布式计算和存储模型，并 且通过云服务进行高效的应用服务交付，为快速构建弹性的信息系统提供了技术 可能性；同时云计算的软件接口也可以使开发人员从繁复的底层硬件搭建和配置 工作中解放出来，使其更专注于业务软件的设计和研发。
(3) 从能源角度，云计算可以通过强大的虚拟化和资源调度能力，将分散的 信息系统迁移和运行在统一的云平台上进行集中管理运营，以资源共享增方式加 服务器集群的整体利用率，充分的利用规模经济效应大幅减少能源消耗和气体排 放，营造绿色计算环境。

第4页

西南交通大学博士研究生学位论文

而将云计算的关键技术和服务理念引入联运信息化建设，为解决上述问题提 供了很好的途径，针对目前联运信息化建设所存在的问题，主要体现在以下几方 面：
(1) 信息布局重构。利用云计算技术，可以将我国千余个港口和码头所有信 息系统整合到统一的平台之上，通过整体规划、集约管理、集中部署和按需付费， 有效减少软硬件设备和人力投入，提高资源利用率，并降低平台的整体运营成本 和能源消耗；特别对于资金匮乏中小型港口来说，以计算资源租用方式替代软硬 件购买，可以避免前期高昂的资金投入，快速实现联运信息化。
(2) 信息服务优化。利用云计算的虚拟资源管理机制建立通用的应用管理模 型，不但可以实现异构联运信息系统在云平台上的统一管理，同时也能对目前笨 重的信息交换体系进行优化，使其在服务过程中根据需求动态调整计算资源，提 高信息共享水平；并进一步采用服务租用方式代替系统直接交付，在短时间内为 联运参与部门提供高效的按需信息服务。
(3) 促进数据利用。随着联运信息系统的迁移和集中管理，结构化和非结构 化的业务相关信息会逐步沉淀到云平台形成联运大数据，这些数据蕴含了很多潜 在的财富，传统的数据管理体系无法处理非结构化数据，而云存储和分布式计算 体系为联运大数据的管理和二次利用提供了有效手段。
从铁水联运信息化的发展需求来看，如何利用云计算技术，在保持现有联运 业务正常运行的前提下，构建新型的铁水联运信息平台对信息布局进行优化，并 解决云环境下的信息系统管理，信息共享和数据分析等关键问题，是提高联运信 息服务和管理的整体水平，促进我国联运信息化革新与改进的实际诉求。
1.2 国内外研究现状
1.2.1 关于铁水联运信息化的研究现状
(1) 国外铁水联运信息化研究现状
随着时间的推移，交通运输体系在进行发展建设的过程当中，信息技术扮演 着更加重要的角色，发挥着关键性的作用。进行进一步研究和分析得出，因为西 方国家和地区生产力发展水平要明显超出我国，交通运输建设时间已经很长，基 础设施发展建设十分的成熟，对于一系列先进技术进行选择与运用，而且，各个 国家和地区的职能部门根据实际情况以及实际需要进行交通运输体系的改进和 升级，制定和实施科学合理的法律法规，在这种情况下，铁水联运等先进运输方 式在进行发展的过程当中获得了更多的动力支持，而且，这也使得内陆多式联运 在进行发展的过程当中得到诸多帮助，各种交通运输方式能够实现有机结合，从

西南交通大学博士研究生学位论文

第5页

总体上逐步建立其科学成熟的铁水综合联运体系[8]。 通过进行前面的论述和分析能够得出，西方国家和地区生产力发展水平要明
显超出我国，交通运输建设时间已经很长，基础设施发展建设十分的成熟，对于 一系列先进技术进行选择与运用，就像现代通信技术、3S 等电子信息技术实现 了多种运输手段的数据信息沟通和交流，切实促进业务效率的提升，同时，逐步 提升管理水平，进行智能化建设，提升服务质量并赢得了市场份额[9]。其中比较 有代表性的是欧美发达国家在铁水联运建设上，通过建设国际运输线路走廊和双 层集装箱列车，同时，进行科学完善装卸设施的发展建设,使得联运业务开展的 过程当中其周转效率获得显著提升[10]。
德国等西方国家和地区已经逐步建立起了成熟完善的铁水联运运输网络，不 同的运输方式实现有机结合，进行信息化发展建设，铁水联运类型更加丰富，而 且，鹿特丹港在进行装卸工作的时候，全部通过计算机进行智能管理和控制，此 外，积极进行物流园区的发展建设,使得港口物流的优势作用更加充分全面的发 挥出来；同时，英国地区同样有着成熟完善的铁路运输系统，积极和港口运输进 行相互协作，使得运输的质量和效率实现全面提升；美国地区更是将“构造一个 统一、无缝、有效、经济、安全和环保的国家多式联运系统”作为运输体系核心， 在铁水联运发展建设方面积极进行技术革新和升级，为运输系统的发展建设提供 更多的支持和保障,合理配置和利用运输资源,进行综合完善运输体系的全面建 设；同时也十分重视信息技术在联运行业中的应用，尤其是 EDI 技术，已经建 立了 EDI 国际集装箱信息网络系统，实现了联运信息共享，保证了各种运输方 式之间的紧密衔接，充分发挥了多式联运的协同运输优势[11-14]。
(2) 我国铁水联运信息化研究现状
在借鉴国外先进经验的基础上，随着互联网技术发展，我国铁路和水路信息 化建设都有了长足的发展。通过进行铁路运输管理信息系统的发展建设，使得相 关参与主体能够根据实际情况以及实际需要进行相关信息的查询以及利用。在进 行 TMIS 网络平台发展建设的过程当中不断有关管理，进行不同运输系统的构建 和完善，促进铁路运输和生产活动的有机结合，然而，因为 TMIS 为内部系统, 在这种情况下，各种运输方式之间难以及时全面的进行信息的沟通和交流[15]。大 型集装箱运输港口的管理信息系统也有了很大发展,陆续建成了比较要完善的港 口和码头综合运营信息系统，配合物联网技术基本实现了集装箱业务自动化，并 初步具备了联运信息管理能力，提高了码头的装卸能力、堆场的储存能力以及道 口通过能力[16][17]。但由于我国铁水联运信息化建设起步较晚，目前的理论研究成 果相对较少，大多以业务流程优化和信息共享技术为重点进行研究，联运行业相 关信息化的研究主要包括以下文献:

第6页

西南交通大学博士研究生学位论文

王占中在博士论文《基于 Petri 网的多式联运流程优化研究》中研究了基于 Petri 网对多式联运优化流程优化，其核心内容是基于信息技术将多式联运流程 进行再造以及采用 Web 服务对多式联运流程进行优化[18]。
聂闻聪在论文《基于 Petri 网的铁路物流中心业务流程优化》中分析了铁路 物流中心建设情况以及其现行的业务流程，对流程进行的抽象提炼，采用 Petri 网对铁路物流中心的业务流程进行建模，构建目标函数和适应度函数选用遗传算 法进行求解，对流程进行优化[19]。
叶姿琴在论文《基于 Petri 网的港口供应链业务流程优化》中对港口供应链 的流程进行了深刻剖析，进而对港口供应链进行模型重构，从供应链的方向分析 港口的业务流程，构建业务流程模型并利用 Petri 网证明了模型的正确性、对模 型的时间性能进行分析以及提出了模型的优化方法[20]。
潘常虹在论文《集装箱多式联运系统仿真及优化方法研究》中研究了集装箱 多式联运货流子系统，并建立集装箱多式联运业务流程的 Petri 网模型,并探讨了 基于 RFID 的集装箱多式联运信息系统应用方法,并对现行的集装箱多式联运业 务流程系统进行了优化[21]。
姜久雷在论文《云计算下跨组织业务流程建模方法研究》中以云计算环境下 跨组织业务流程建模作为研究课题，基于云计算环境下对跨组织业务流进行深入 分析，对业务流程从组织间的流程柔性、流程交互以及流程编排等三个方面进行 了形式化建模方法研究[22]。
赵晓娇在论文《集装箱铁水联运信息服务设计》研究信息服务理论方法的基 础上，结合集装箱铁水联运信息服务实例,重点研究了 KANO 理论、卡分类法、 服务蓝图法等在集装箱信息服务设计中的应用[23]。
郑雄燕在《面向多式联运的信息集成与服务优化研究中》中以多式联运信息 集成服务为背景，以信息应用为中心，以多式联运信息为研究对象，利用多式联 运理论、信息集成理论、信息集成服务理论等学科的知识对多式联运中数据集成、 应用集成进行研究并提出了服务优化方法[24]。
王平和秦鸣夏在论文《基于 EDI 技术的铁水联运数据交换应用》中阐述了 EDI 技术在铁水联运数据交换中的应用，分析了数据交换架构和报文处理模式， 并对铁路与港口的协同作业模式和数据靶向进行了分析[25]。
钱继锋和刘占东等人在论文《EDI 技术在集装箱无缝运输中的应用研究》中 对 EDI 在集装箱运输过程的应用进行了探讨，提出了利用 EDI 技术对集装箱业务 流程进行重构[26]。
秦长城在《EDI 功能在天津港集装箱码头管理系统中的设计与实现》中以天 津港集装箱码头 EDI 系统建设为背景对 EDI 系统的构建和数据标准进行了研究，

西南交通大学博士研究生学位论文

第7页

设计了一个开放的、灵活、通用的体系架构，用于连接口岸内相关企事业单位, 支持用户以不同通信方式、传输协议以及不同格式标准实现相关业务单证和报文 方便、快捷、安全、可靠的传输和交换，实现了报文传输的相关信息在应用系统 之间实现共享,以满足各方业务应用系统的需求[27]。
王琳在《基于 XML 的 EDI 系统在物流应用中的设计与实现》中通过对传统 EDI 的技术特点及其缺陷进行分析和对比,提出了一种基于 XML 的 EDI 电子数 据交换系统,并对系统中的一些关键技术如标准单证 Schema 的制定、XML 格式 数据的转换和存取等做了深入的研究，有效提高了数据交换效率[28]。
贺洪煜在《基于 SOA 与 BPM 的航运 EDI 系统设计与实现》中采用基于 SOA 与 BPM 相结合对 EDI 系统进行重构，解决集装箱航运企业在日益增长的业务量与 大数据量背景下的信息共享和业务集成问题，有效提高了系统的利用率和企业收 益[29]。
铁水联运信息化的相关研究工作对联运业务流程优化，联运信息系统和数据 中心建设等方面具有极其重要的作用，较好的解决了联运信息化的流程建模和关 键系统构建问题；但同时也可以看出，现有研究成果除了业务流程优化和信息共 享机制外，对联运信息技术方面的研究相对较少。缺乏关键信息管理技术和软件 服务方面的系统性研究，造成这些理论在我国信息化建设过程中落地困难，也导 致我国联运信息化建设过程都是分点自治，影响范围有限，建设水平参差不齐。
1.2.2 关于云计算的研究现状
云计算的相关研究主要包括云平台构建技术和大数据分析两个方面，研究现 状如下：

(1) 关于云平台技术的研究现状

在云平台构建方面，不仅得到了各国企业界和学术界的大力推广，而且政府

也高度关注并推出多项措施致力云平台的建设，其中最具代表性的四大云计算企

业，其核心技术和特点如下表 1.1 所示：

表 1-1 美国四大 IT 巨头的云计算平台

公司名称 技术名称

技术特点

Google

GAE

通过 GFS 分布式文件系统、MapReduce 编程模式、分布式的 缩服务 Chubby 和分布式存储 BigTable，高效的管理大规模分 布式集群，最大化降低成本

IBM

Blue Cloud 可通过 Internet 访问的云计算系统，在 Tivoli 部署管理系统和

监控系统的控制下，提高云计算数据服务安全性，配合开源

Microsoft

Windows Azure

HDFS 数据存储技术，提供更加可靠的服务 重在云端计算，提出了云计算服务整体集成，为用户提供从开 发、运维到监管一系列服务

第8页

西南交通大学博士研究生学位论文

Amazon

Amazon EC2 提供于 Linux 的虚拟集群运行环境和远程云服务平台，充分挖 掘资源并发现其价值

云平台通过资源虚拟化，提供按需分配的计算资源和服务交付模式，包括但

不限于 IT 和软件、互联网的相关服务。近几年云平台(主要是 IaaS 和 SaaS 平台)

构建的相关技术在我国发展十分迅速并已经得到了普及，也有不少学者们围绕存

在的问题进行了大量研究工作，并提出了相应解决方案，其中包括以下文献：

杨光在《基于云计算的基础设施云服务平台设计和实现》中对基础设施云服

务平台的关键技术和架构模型进行了研究，并根据该平台的规模和用途，采用开

源云平台管理软件对平台进行了实现[30]。

汪楠在《基于 OpenStack 云平台的计算资源动态调度及管理》中对云数据中

心的资源调度和管理的需求和关键技术进行详细的研究，基于 OpenStack 的架构

对虚拟化资源进行建模,从服务层面和资源层面分别对资源进行描述,并提出了

面向计算资源实时监测反馈综合负载均衡调度策略和算法[31]。

陈俊汝在《基于 OpenStack 的维修信息中心云平台设计与实现》 中提出了

基于 OpenStack 维修信息系统信息中心云平台进行了总体设计，然后结合维修系 统信息中心自身特点，设计了维修系统信息中心云平台逻辑结构，并搭建了维修

信息中心云平台的验证平台，在其上对各个功能模块进行了验证测试[32]。

黎明在《云计算资源管理关键技术研究》中针对云计算资源管理的四个关键

技术:即云计算资源管理模型、云计算资源语义组织模型、云计算资源发现策略

以及云计算资源调度策略进行了深入的研究，设计了一种基于多代理系统的云计

算资源语义组织模型和一种基于语义搜索引擎的云计算资源发现策略，并提出了

一种基于改进并行遗传退火算法的云计算资源调度策略, 有效的解决云计算资

源的优化调度问题[33]。

邓自立在《云计算中的网络拓扑设计和 Hadoop 平台研究》中分析了云计算 的网络拓扑结构特点,利用图论和最优化理论,结合贪心算法思想,针对其主干交

换网络的拓扑设计提出了自动拓扑设计算法 RGA，并对 Hadoop 的 MapReduce

工作模式进行分析,针对它的多任务调度提出了基于优先级的加权轮询算法

(PBWRR)，最后对 PBWRR 和 Hadoop 平台默认使用的 FIFO 调度算法进行了综 合对比分析[34]。

袁文成在《面向 IaaS 的云计算自适应资源管理机制》中本文着重对 IaaS 中 的虚拟资源管理机制,以及其在高性能应用集群、Web 服务集群中的自适应资源

分配及调度机制等方面进行了深入研究，提出了一种面向虚拟资源的 IaaS 资源

管理机制，以及面向网格化 Web 集群的按需 IaaS 资源管理机制和分配调度策略，

并建立了面向高性能应用集群(HPC)的自适应 IaaS 资源弹性管理机制和两种基

于递归最小成分分析的 IaaS 自适应系统识别算法[35]。

西南交通大学博士研究生学位论文

第9页

张莉艳在《基于云计算的铁路信息共享平台及关键技术研究》中将云计算理 论和关键技术用于铁路信息共享平台的研究，提出了采用云计算构建铁路信息共 享平台的新思路，并对基于云计算的铁路信息共享平台的总体框架，逻辑架构、 物理架构和支撑体系、共享存储等关键技术进行了研究[36]。
王会颖在《基于 MapReduce 蚁群算法的多租户 SaaS 服务定制与部署方法研 究》中提出了基于 MapReduce 的改进背包问题蚁群算法(MIAM)，并将云计算 环境下的蚁群算法应用于解决 SaaS 平台中多租户服务定制问题，并解决了能量 感知的服务放置问题[37]。
何文娜在《大数据时代基于物联网和云计算的地质信息化研究》中从地质信 息化工作即将进入大数据时代的角度出发，以大数据、物联网、云计算等前沿技 术在地质调查领域信息化工作的应用作为研究对象，深入研究了各种技术对推动 地质信息化产生的影响及应用方案，并提出了包括地质物联网和地质云计算平台 的相关技术路线、框架体系和关键实现技术[38]。
与 IaaS 的快速发展不同，由于 PaaS 云平台由于面向开发者，环境比较复杂， 至今仍未普及，目前最新的研究方向和热点是轻量级的容器云技术，有效的解决 了传统 PaaS 平台的资源限制和灵活性问题，所以本论文采用容器云技术为基础 构建联运云平台。但由于其起步较晚，关键技术的相关研究成果较少，检索到的 主要研究文献如下：
马越等在《基于 Docker 的应用软件虚拟化研究》中探讨了现有的应用软件 虚拟化技术,分析比较现有的应用虚拟化的解决方案,并提出了新的一套基于 Docker 技术和 VNC 协议的应用软件虚拟化方案[39]。
王飞在《基于 Docker 的研发部署管理平台的设计与实现》中研究了基于 Docker 的研发部署管理平台的整个研发过程，从多用户角度分析需求，并设计 了满足统一无差异性的研发部署管理平台[40]。
杜军在《基于 Kubernetes 的云端资源调度器改进》中全面分析了 Kubernetes 体系结构和资源调度器模块活动步骤，然后，进一步丰富了 Kubernetes 资源调度 器自带的计算方法体系，建立起 Kubernetes 资源调度器资源抢占式调度规划，进 行相关应对和处理方案的科学构建[41]。
陈星宇《基于容器云平台的网络资源管理与配置系统设计与实现》中重点分 析了目前容器云平台网络方面的挑战,并通过对业界现有的容器网络工具分析, 研究了容器云平台的网络隔离,网络资源控制及网络弹性扩展等方面的关键技术 和优化方案[42]。
(2) 关于大数据分析的研究
大数据是云计算的核心发展趋势，如果能够实现大数据的全面沟通与交流，

第 10 页

西南交通大学博士研究生学位论文

那么，能够在很大程度上促进经济的增长，带动社会实现健康稳定的发展，从现 在的基本情况来看，大数据研究领域的研究主要包括大数据处理模型、分布式存 储、大数据分析技术等方面，主要包括以下研究文献：
研究人员程学旗等通过对于相关问题实施深入细致的研究和分析，进行了 《大数据系统以及研究技术综合评述》的著述，参考处理形式的差异性，依次对 于各种形式数据的基本属性等进行了全面的论述和说明，归纳和梳理了大数据处 理系统所具有的发展方向，在这个基础上对于系统帮助和支持情况下的大数据研 究技术以及实际运用实施了进一步分析，归纳和梳理了一系列技术在大数据研究 当中所扮演的角色，接下来，整理了大数据处理以及研究所遇到的各种问题，在 这个基础上进行进一步的研究和分析，提出合理化的意见和建议[43]。
研究人员韩晶通过对于相关问题实施深入细致的研究和分析，进行了《大数 据服务相关核心技术分析》的著述，对于大数据服务架构以及模型等相关的核心 技术和算法进行了系统研究[44]。
张常淳在《基于 MapReduce 的大数据连接算法的设计与优化》中围绕基于 MapReduce 的数据连接算法效率优化问题，深入研究其处理机制，并提出了多种 大数据处理过程中数据连接的优化算法[45]。
楼巍淳在《面向大数据的高维数据挖掘技术研究》中通过将数据个体研究变 为数据系统研究，提出了面向大数据的高维数据挖掘模型和相关计算方法[46]。
任崇广在《朝着海量数据信息处理方面的云计算和核心技术分析》当中进行 了云计算条件前提下的海量小文件处理模型 C-MSFPM 的构建，并构建了基于 XML 和多 Value 的改进 MapReduce 模型，在 MapReduce 以及属性向量降低的前 提下，革新和升级 KNN 算法，进行云存储数据分配手段和方法的制定[47]。
李凌在《云计算服务中数据安全的若干问题研究》中分析了目前有关数据完 整性保护相关问题的分析活动，归纳和总结了其中所处在的缺陷与不足，在这个 基础上通过进行更为深入细致的研究和分析，进行相关应对举措和办法的制定[48]。
上述研究成果也对联运信息平台的构建具有值得借鉴的巨大价值，但如何将 联运业务和信息优化方面的研究，与云计算先进的技术和理念相结合的研究涉及 甚少，严重的缺乏理论和实践支持，造成云计算技术很难在联运行业落地；此外 对于目前联运信息系统中存储的联运大数据收集，处理及二次利用，也未有相关 研究给出明确的解决方法。本文将在现有研究成果的基础上，就云环境下铁水联 运信息平台构建的关键技术进行深入研究工作。

1.3 论文研究目标

西南交通大学博士研究生学位论文

第 11 页

随着我国铁水联运基础设施的日趋完备，以及在线跟踪技术、智能交通技术 (ITS)和物联网射频识别技术(RFID)在联运信息化中的普及，联运业务的自动化 和智能化趋势也越来越明显，对既有联运信息系统在软硬件性能、运营成本、流 程管理和数据整合等方面提出了更高要求。由于我国港口众多，发展不均衡，造 成了铁水联运的信息化建设的困难性和复杂性都较其它国家更为突出。云计算作 为信息化建设的全新理念和发展方向，在工业界和学术界都得到了广泛的关注， 在很多发达国家已被确立为国家级发展战略，我国也制定了相关的发展规划。
由于铁水联运信息平台是一个由多个联运业务相关的信息系统构成的有机 整体，本文的目标旨在将云计算技术引入铁水联运信息化建设，构建全国统一的 新型铁水联运信息平台。首先，定义铁水联运云平台和联运应用的相关概念，并 设计铁水联运云平台的技术构架，实现联运信息化的布局优化和资源整合；然后， 在此基础上构建联运应用的一体化管理体系，使目前分散的大量异构联运信息系 统在同一虚拟化环境下进行自动化构建，部署和交付；其次，在分析目前联运信 息集成技术局限性的基础上，研究和探讨基于容器云的轻量化信息共享模型和 EDI 弹性伸缩机制，解决在虚拟化环境下的信息按需共享问题；最后针对联运订 单的撮合问题，深入研究大数据相关技术，并设计订单撮合的大数据处理模型和 算法，提高货主的业务办理效率，为我国铁水联运云平台的设计和开发提供理论 和技术支持。

1.4 论文的研究内容与组织结构

1.4.1 论文研究内容
论文在结合背景项目:中国铁路总公司科技研究计划课题《铁水联运技术标 准及关键技术研究》的研究成果基础上，对现有铁水联运信息化方面存在的问题 进行优化，主要研究铁水联运云平台构建的目标和技术方案、云环境下的联运应 用管理，信息共享机制，以及联运大数据应用构建的关键技术，具体包括如下内 容:
(1) 提 出 了 基 于 虚 拟 资 源 分 层 融 合 管 理 的 铁 水 联 运 云 平 台 技 术 构 架 (HFCA)
针对目前我国联运信息化布局分散，信息系统结构僵化等问题，本文利用云 计算技术对铁水联运云平台相关概念进行定义，并提出了基于虚拟资源管理的分 层融合云构架(HFCA)，自底向上分为资源，业务和数据三层支撑体系，打破了 相互孤立的“烟囱式”系统构建模式，实现了大集中管理模式下的联运应用和数 据集约化低成本管理，其中在资源层利用虚拟化技术对资源进行池化和按需分配，

第 12 页

西南交通大学博士研究生学位论文

并通过抽象运行环境(ARE)为业务层提供 IaaS 和 PaaS 融合的资源设施；在业务 层根据业务需求，将联运应用划分为四大功能资源池，并提出基于云原生的应用 重构策略和基于成熟度的 SaaS 应用服务模式，优化了云环境下的应用迁移和信 息交互过程；而在数据层基于 DOA 构架对碎片化的联运业务数据进行集中注册、 存储和检索，形成统一的数据资源池，并通过建立可扩展的联运大数据应用模型 对海量业务数据进行按需挖掘和二次利用；此外，通过对联运业务需求进行梳理， 优化了云环境下的货运进出口信息流，为铁水联运云平台的构建奠定了设施基础。
(2) 提出了云环境下基于 DevOps 的一体化联运应用管理体系(IAMS) 如何提高应用管理的便利性、可靠性和安全性是云平台需要解决的关键问题， 由于联运应用具有较大的异构性，而目前主流云平台基于虚拟机的应用管理模式， 存在资源调度粒度大，灵活性和性能较较差等问题，无法适应云环境下的联运应 用管理。 本文通过对业务层所管理的应用统一抽象为“联运应用单元(ITAPP)”对其 软硬件异构性进行屏蔽，提出了云环境下基于 DevOps 的一体化联运应用管理体 系(IAMS)，实现应用交付和运维的统一管理，同时考虑应用分布式部署、可靠 性和安全性需求，对联运应用的构建，部署和应用安全机制进行了研究，首先， 以虚拟镜像为载体设计了持续集成构建模型，避免了低效的人工应用交付过程； 其次，在资源支撑体系的抽象运行环境(ARE)上，提出了基于“联运应用单元” 的自动部署算法和高可用集群管理模型，提高了联运应用的运维效率和服务可靠 性；然后，建立了基于 SSO 和 RBAC 的统一应用访问控制策略，对多租户环境 下联运应用池进行集中安全管理；最后，通过云平台构建和应用部署测试，验证 了虚拟环境的性能优势。 (3) 提出了基于 MSOA 构架的联运信息共享模型，并建立了 EDI 系统的自 伸缩机制 信息共享的便捷性，灵活性和经济性是衡量联运信息服务水平的重要指标， 由于目前联运行业主流的信息集成技术成本高，结构笨重，性能低下的问题，因 此如何利用云计算技术优化联运信息共享模型，对铁水联运云平台的落地至关重 要。 本文采用轻量级的 MSA 代替总线型信息共享构架，构建了面向微服务的两 层共享模型，并利用“联运服务单元(ITSU)”对信息共享的角色、交互和流程 进行虚拟化封装，建立了去中心化的“联运应用集成单元(ITIU)”，使联运应用 管理与信息共享的合二为一，实现低成本的信息集成即服务；进一步利用 MSA 和支持异步数据传输的分布式队列对 EDI 系统进行重构，形成 K8S 环境下可动 态扩展的分布式报文并发处理体系；最后在新的 EDI 体系上建立了 POD 水平伸

西南交通大学博士研究生学位论文

第 13 页

缩模型，并提出了基于多指标负载集和排队论优化控制的自适应 EDI 组件伸缩 算法，通过实时负载的伸缩阈值对 POD 副本集自动定量扩缩容，同时考虑报文 处理过程中 POD 的动态负载、资源限额和需求的差异性，采用改进的 DRF 算法 对 POD 的资源分配过程进行优化。实验结果表明，伸缩机制可以在虚拟资源总 量有限的情况下，显著提高 EDI 的报文吞吐量。
(4) 建立了基于联运大数据的智能订单撮合系统(IOMS)模型，并利用人工 鱼群优化的协同过滤算法对模型进行求解
联运订单不但代表了货主的联运货物运输需求，也是货主与联运经营人建立 关系的桥梁。在目前的联运信息化环境下，货主需根据货物运输需求，在线下确 定与联运经营人的运输关系，不但效率低下，而且无法全局考虑联运业务的分布 情况，具有较大的主观性。
大数据处理是联运信息化发展的必然趋势，协同过滤模型在内容大数据推荐 方面得到了普遍的应用，也为订单撮合模型的构建提供了理论基础，但由于目前 的协同过滤模型只考虑了离线用户信息和内容等特征，并没有考虑用户偏好、以 及运输能力和时间约束等因素，因此，直接将协同过滤模型应用于订单撮合过程， 会出现准确率低和不合理解的问题。
本文基于 Spark 和 Hadoop 等分布式计算框架对既有的离线协同过推荐型进 行扩展，在数据支撑体系上建立了基于批量订单特征、历史业务数据和行为反馈 数据的三层 IOMS 模型，并采用人工鱼群优化的协同过滤算法对 IOMS 模型进行 求解，结合订单特征、运载能力约束条件和货主行为反馈数据对推荐列表进行持 续的闭环调整。实验结果表明，该模型可在近线的时间内为具有不同偏好的货主 识别出若干个满足订单需求的，可接受度更高的联运经营人。
1.4.2 论文的组织结构
本文主要研究和探讨铁水联运云平台的构建理论与技术方法，共分为 6 章， 结构如下:
第 1 章 对论文的研究背景、意义、必要性和论文研究目标进行论述，在对 国内外研究文献进行综述的基础上，提出论文的研究目标、内容与组织结构。
第 2 章 对目前铁水联运主体和业务进行分析，并概述本文研究所涉及的云 计算关键技术和相关框架，为后面章节的研究提供技术支持。
第 3 章 设计了铁水联运云平台的技术构架。针对目前我国联运信息化现状 分析存在的弊端，设计联运云平台的技术层次构架；对铁水联运云平台的云服务 模式和业务应用资源池进行详细分析；对云环境下的联运作业流程进行优化，并 建立了 OOPN 模型对集装箱进出口信息流进行检测。

第 14 页

西南交通大学博士研究生学位论文

第 4 章 构建了云环境下的一体化联运应用管理体系。在对现有联运信息系 统管理过程中存在问题进行分析的基础上，结合资源支撑体系的虚拟资源池，提 出基于“联运应用单元”封装的一体化应用管理体系；然后对联运应用的持续集 成、集群部署和应用安全等关键技术进行了研究；最后通过应用部署测试，验证 其可行性和性能优势，为铁水联运云平台的落地提供理论基础。
第 5 章 研究了云环境下的联运信息共享模型和伸缩机制。针对目前系统集 成技术结构笨重，成本过高的问题，提出基于 MSOA 的轻量级联运信息共享模 型，采用去中心化的按需共享方式，提高信息共享的灵活性并降低信息的共享成 本；然后考虑目前 EDI 数据交换系统成本过高，结构僵化，利用率低和性能瓶 颈等问题，在兼容现有报文处理过程的条件下，利用 MSA 对 EDI 进行构架优化， 建立 EDI 伸缩模型，并设计基于多指标动态负载预测，排队论模型和改进 DRF 资源分配的自动伸缩算法；最后通过定量实验分析，验证其性能优势。
第 6 章 研究了大数据环境下的联运订单撮合问题。针对目前联运业务办理 过程中，货主与联运经营人线下匹配效率低下的问题，建立订单撮合大数据应用 的数据处理模型和数据传输模块；并利用人工鱼改进的协同过滤算法对模型进行 求解，在运输能力约束条件下，同时利用离线业务数据和用户实时行对撮合结果 进行修正，以提高推荐的可接受度；最后通过将该模型与基于内容的推荐算法， 以及分布式遗传算法的定量实验比较研究，分析其有效性以及可行性。
第 7 章 归纳和梳理研究结论，做出进一步的展望。 论文结构如图 1-1 所示：

西南交通大学博士研究生学位论文
论文研究背景意义

第 15 页

国内外相关技术研究现状

论文研究目标

论文研究内容与组织结构

铁水联运和云计算技术

铁水联运云平台 的构架研究与设计

云环境下的 联运应用管理体系构建

基于MSOA的联运 信息共享机制研究

基于联运大数据的 订单撮合问题研究

总结与展望
图 1-1 论文结构关系图

第 16 页

西南交通大学博士研究生学位论文

第 2 章 铁水联运和云计算技术
本章首先对铁水联运的构成主体和作业流程进行概述，然后介绍了云计算的 相关概念，特征和服务模型，最后针对构建铁水联运云平台所涉及的关键技术和 计算框架进行概述，为后续章节的分析内容奠定基础。
2.1 铁水联运概述
2.1.1 铁水联运的业务分类和构成主体
目前我国铁水联运的相关业务主要围绕港口进行开展，根据港口的类型和从 事物流活动不同，铁水联运可划分为面向内陆运输的铁江、铁河联运和面向货物 进出口的铁海联运两类。由于内河港口的航道水深和码头泊位等级与沿海港口具 有先天不足，运输过程繁琐，且与水水运输相比不具备优势，所以目前我国发展 最快，受到最广泛关注的，是基于大型海港和河口港的铁海联运业务，主要包括 以下两种运输方式:
(1) 集装箱运输 集装箱运输是我国铁路货运主要的运输方式，由于为了满足物流需求，铁路 集中建设了集装箱中心站，制定相关集装箱标准，积极发展国际化集装箱运输。 集装箱运输正以其标准化流程、简捷化包装、高速化转运和低货差货损率,吸引 着更多中小型企业的参与。 (2) 大宗散货运输 而大宗散货的运输主要是矿物资源的运输，我国的矿藏资源主要集中于内陆 省市,因此需要通过专有铁路线路输送给全国其他省份,同时某些物质也有巨大 的出口需求。大宗散货的出口能够有效拉动内陆经济的发展,并且促进沿线交通 网络的壮大。通过对大宗散货进行分析,可知其存在运输有运量大、班次稳定等 优势,同时也存在包装不规整、转运和倒货的时间长等问题。 铁路和港口是铁海联运的两大主体。其中，铁路部门采用五定班列与港口进 行对接，“五定”班列是指铁路货物列车运行定点、定线、定车次、定时、定价。 与普通货物列车相比具有运行速度快、到发时间准、运输价格低等优势。同时， 在海关通过“两点一线”直通式监管模式，以火车的班列为单元实现“整体转关、 整体核销”,并对铁水联运进出口货物“即到即办”；而港口根据位置和规模的不

西南交通大学博士研究生学位论文

第 17 页

同，可以分为以下三类： (1)海港 是指位于海岸或海湾内的港口，通常须建较大规模的防波堤，如大连港、青
岛港、连云港、基隆港和西顿港等，这类港口可提供巨型油轮或矿石船靠泊的单 点或多点系泊码头和岛式码头。
(2)河口港 是指位于河流入海口或受潮汐影响的河口段内，可兼为海船和河船服务。一 般有大城市作依托，水陆交通便利，内河水道往往深入内地广阔的经济腹地，承 担大量的货流量，全球很多大港都建在河口附近，如鹿特丹港、伦敦港、纽约港 和上海港等。河口港的特点是码头设施沿河岸布置，离海不远而又不需建防波堤， 如岸线长度不够，可增设挖入式港池。 (3)内陆港 是指没有水、没有船的陆地港口，海关、检验检疫部门可进入港区行使监管 职能，具备港口除装、卸船以外的其他所有功能，通过内陆港即可办理所有进出 港关手续,货物进港即是进关，而出港即是出关，以有效加快铁海联运的整体运 输效率。 由于集装箱和大宗散货这两种运输过程基本相同,本文后续内容均以更具代 表性的集装箱进出口业务，作为铁水联运信息平台构建相关研究的主要对象。
2.1.2 集装箱进出口作业流程分析

2.1.2.1 集装箱出口作业流程
根据论文的背景项目《铁水联运技术标准及关键技术研究》对铁水联运业务 流程的梳理，目前集装箱出口作业如下图 2-1 所示，可以归纳为以下步骤：
(1) 货物托运人联系货运代理人并办理托运手续。 (2) 货运代理人接受托运人运输请求委托后，向船公司租船订船。 (3) 船公司接受托运申请，船公司在接受托运申请后制作集装箱预配清单， 安排货运交接事宜。 (4) 装箱单制作，制作集装箱装箱单，并将货物及装箱单交由货物代理人。 (5) 货代将货物发货人仓库运输到内陆集装箱办理站，车站货代签发铁路货 物运单。 (6) 内陆集装箱中心办理站在接受货物后，编制运输计划，并向铁路相关部 门提交运输计划申请。 (7) 集装箱列车到站，集装箱列车一般到达港口中心站或港前站，以取送车 的方式输送到相应卸车区。

第 18 页

西南交通大学博士研究生学位论文

(8) 港口卸车，集装箱列车到达出口港集装箱中心站后，中心站安排卸车工 作，集装箱根据预先制定好的堆场计划，卸到相应分区进行堆垛。
(9) 报关报检，货物代理人提交相关资料向海关和国检报关报检。 (10) 集装箱交接，根据船期计划，出口集装箱按期运至集装箱码头，堆场 码头接收集装箱时，核对场站收据、装箱单、设备交接单，并代表船公司在场站 收据签字确认。 (11) 堆场堆放，在货箱进入船公司堆场后，理货人员在与订船单核对后， 提交船公司，由船公司签发清洁提单给货代；集装箱运到港口后，一般不能立刻 进行装船工作，需港口码头堆场堆放一段时间并等待装船。 (12) 集装箱装船，准备装船阶段：根据船期、船公司编制的集装箱预配清 单及计划预配船图，码头堆场着手编制堆场计划和装船计划；装船作业为：码头 堆场人员将预配船图交船方，根据装船顺序单、预备船图，发箱装船。 (13) 船舶离港，船舶在本次到港货物装卸完毕后，根据船舶离港计划，离 港。

货主货物 托运办理

贷代 向船公司订舱

船公司 订舱确认发出提单号和提单箱

货主 委托空箱托运

内陆集装箱站 装车
铁路 内陆运输

铁路局货运部 配送空车
港站 卸车安排

贷代 向铁路部门申请要车
贷代 向检疫部门报检

船公司堆场 空箱交接
贷代 向海关报关

船公司 装船离港

码头堆场 编制装船计划

堆场进行 集装箱交接

图 2-1 集装箱货运出口作业流程

贷代 集装箱进场申请

2.1.2.2 集装箱进口作业流程

集装箱进口流程与出口过程相反，作业如下图 2-2 所示，可以归纳为以下步 骤：
(1) 船代理人申请泊船位，船代提前向需要停靠的泊港口申请泊位，港口方 按照船代提供的信息安排泊位，做出货物堆场计划。
(2) 接收船舶到港信息，按照船公司向港方提供的船舶动态和单证资料，安 排集装箱船舶靠港卸货计划。
(3) 卸船准备，编制靠泊计划、装卸作业计划、编制卸船计划、堆场计划， 为货物卸船做准备工作。
(4) 货物卸船，在船舶靠泊后，按计划卸船；卸船完成后，码头堆场整理有

西南交通大学博士研究生学位论文

第 19 页

关卸船的集装箱单证资料将相关交于相关参与方并归档。

(5) 堆场堆放，集装箱货物从船上卸下后，需要在堆场进行堆放，按照预先 编制好的堆场计划，将其搬运至预定箱区。
(6) 报关报检，货物在运输之前，需完成报关报检手续；货代需持报关单、 提货单和提单副本以及装箱单等单证，到海关办理申报手续；经海关审核同意后，

在提货单上盖章放行，如需查验，双方另约时间进行查验，同时与港口方堆场沟 通查验安排。
(7) 货物装车，报告空车送到达货物线时间；装车前进行票、箱、车三检， 并报告作业开始时间，同时将装载清单信息录入追踪系统。

(8) 装卸线或到发场发车，若装卸线有整列发车能力，则可安排直接装车地

发车。 (9) 内陆运输，完成内陆交付。

船代 泊位申请

船代 船舶到港、预确报信息

码头堆场 泊位安排

船公司 船舶到港靠泊

贷代 向海关申请报关

贷代 向检验部门报检

码头堆场 堆放

码头前沿 卸船

堆场大门 集装箱交接

港站 取车

港站 取车

港站 到发场发车

贷代 空箱回运

铁路 内陆交付
图 2-2 集装箱货运进口作业流程

铁路 内陆运输

2.1.3 集装箱进出口过程的信息共享需求

由文献[23]相关研究可知，制约我国铁水联运发展的主要障碍，是多个部门， 以及用户之间信息未充分共享、不同部门之间的技术标准尚未统一等问题。我国 铁水联运的信息共享均基于港口 EDI 系统实现，结合上述作业流程分析和港口调 研，目前集装箱进出口过程的数据交换需求和数据共享程度如图 2-3 所示：

第 20 页

西南交通大学博士研究生学位论文

1a1:托运请求 1a2:联系代理人 1a3:填写联运运单 1a4:制定运输计

划 1a5:进出口装箱单、货运信息报文

1b:代理人向内地铁路局货物部发送提铁路箱申请

1c:内地铁路局发送放箱单报文

1d:装箱信息，箱、货、车

1e:内地铁路局或货代发送发运清单(货票)

1f:发运车实时过站信息

1g:电子支付单 1h:联运贸易发票

1i:投保单证

1j:保险凭证

2a:订舱报文，根据过站情况，安排船期，订舱

2b:卸车委托，指明箱号、目的港、倒箱、拆箱标志，码头据此数据

卸车堆存

2c:列车至中转货运站的实际编组、货票数据 2d:铁路实时拖车数据

2e:铁路实际发往港口站的编组信息 2f:卸车计划

2g:码头实际卸车数据

3a:向港口站报放箱申请

3b:港口站放箱指令 4a:理货证明报文

4b/c：下海箱、货代报检/报关 4d/e:国检、海关查验放行数据

5a:船公司出口清单(外贸)

5b:出口预配清单

5c:装箱报告、出口舱单

5d:出口船图

6a:提箱申请:船公司箱由船公司放箱、铁路箱持货票直接提箱

6b:船公司放箱单

6c:拆、倒箱申请

6d:提箱确认，委托场站提箱 6e:装箱单

船公司

货主

未交换数据 已共享数据

内陆站
2c2d2e 1b1c 1d1e1f

6b 6a 5c/d 5a 2a

6a

5b5a4e

4d

1c1i1h1g1f1e1c1a11a31a4

4a

2e2b2a

理货

铁路EDI中心

报文交换

港 站
4b 4d

2b 2c 2e 2f 2g 3a 3b
4c 4e

海关

港口EDI中心

1a2

1a5

1b

1c

1d

1e 1f

代

2a

2b 3a

理

4b 4c

人

6a

6b

6c

6d

6e

铁水联运信息系统

1g
1j 1i

银

保险

行

2b2e2f2g3b4d4e5b5c6a6b6d6e

6e

6d

6c

国检

码头

场站

图 2-3 集装箱货运进口作业流程 由上图可以看出，目前港口，铁路等几大参与主体的信息已经初步实现共享， 但在货主，代理人与铁路港口进行业务交接，以及办理一关两检等环节，并未对 共享信息进行有效整合，还存在较多的线下环节，主要会导致以下问题： (1) 流程衔接不顺畅。由于联运参与部门间缺少预确报信息共享，货物等待 时间下一操作环节时间较长；此外，部分业务信息沟通不充分，配送空车和货物 在码头堆场作业，以及报关报检时间无法有效衔接，造成货物堆放和等待时间较 长。 (2) 作业并行化程度低。由于集装箱发运站在收到货物进站信息后才向铁路 部门请车，集装箱货物需在站内等待较长时间；此外，对于货物出口，到达港站 的货物需得到海关检验放行信息后才向码头提出进场申请，码头才能安排堆场计 划；同时对于货物进口，港口收到货物到达码头的信息后，才向铁路部门申请制

西南交通大学博士研究生学位论文

第 21 页

定运输计划，造成运输过程中的木桶效应。 (3) 纸质票据制作交接时间长，影响作业进度。在集装箱运输在途过程中，
集装箱装卸车釆用的是自动化机械，集装箱装车作业耗时较短，作业流程衔接中 时间占用最多的是相关票据制作和交接时间。由于货物运输的相关票据还未完全 实现无纸化，而集装箱运输过程中所涉及到的票据种类、数量繁多，票据制作和 填写效率较低，频繁出现在铁路运输时列车等待票据，或在港口中转时货物等待 票据的情况。
针对上述问题，本文利用云平台的集约化管理模式对联运信息流进行优化， 并对云环境下的 EDI 信息交换系统进行重构(详见 3.5 节和 5.4 节)。
2.2 云计算概述

2.2.1 云计算定义和特点
云计算对不同都用户类型和角度有不同的内涵界定手段，参考权威机构对于 云计算内涵的界定情况，其基本内涵可以概括为，借助于网络对于共享同时能够 进行合理运用的计算数据信息实施合理配置和利用的基本模式，供给主体能够借 助于可控的管理手段实施迅速的配置以及发布，使用主体能够借助于最小化的交 互工作进行各种计算服务的获取[49]。
云计算的特点是通过对资源池实行最小化的管理或者与服务提供商之间的 相互通信，实现资源的按需供给以及释放，而且，还能够借助于最简化的互动以 及交互实施迅速的应用配置以及发布。
2.2.2 云计算特征
云计算是各领域企业或组织追求低成本、高效益的基础上开发出的一种完全 独立的新型计算模式，以解决单点硬件瓶颈和集中式构架灵活性问题。云计算本 质上不但是并行计算 Parallel Computing、分布式计算 Distributed Computing 和 网格计算 Grid Computing 的发展融合，也是虚拟化 Virtualization、面向服务架 构 SOA 等概念混合演进的结果，云计算主要包括五个基本特征:
(1) 按需分配服务:用户无需与服务提供商进行人为的交互即可根据自己的 需要自动获取诸如服务器使用时间、网络存储等计算资源。
(2) 广泛的网络接入:用户可通过网络根据标准机制在任意异构的终端上对 资源进行访问，例如智能手机、PC 电脑和 PAD 终端等。
(3) 资源池化:所有计算资源(包括计算、网络、存储及应用等资源)均被“池 化”，并完全根据用户需求重新动态分配，将其所拥有的不同物理及虚拟资源用

第 22 页

西南交通大学博士研究生学位论文

于服务多个用户。基于这种高层次的抽象理念，即使用户对实际的物理资源没有 概念也没有控制权，却也可以获得与以往一样的计算服务。
(4) 快速弹性:所有计算资源都可以快速弹性地配置和发布，给用户提供无 限的供应能力。对于用户而言，他们可以根据自己的需求对获取的计算资源自动 增配或者减配。
(5) 可控服务:云提供者需通过对计算资源的计量与控制以实现服务资源分 配时的优化。
云环境下的联运信息化建设目标是提供“以联运用户为中心”的业务信息服 务，本文认为，由于不同的联运参与机构对联运信息化的需求不同，成熟度也不 一致，云计算能以资源池化的方式快速弹性的配置和发布联运信息化资源，在自 身动态控制的条件下，实现针对不同参与机构的按需联运信息化服务。
2.2.3 云服务模型
云计算服务(简称：云服务)是指通过云计算使用户根据自身需求进行以租代 买的基本运作模式，向用户提供信息化产品的供给模式。和传统信息化模式相比， 这种服务模式使用户在 IT 领域的灵活性更为突出，可以严格的管理和控制成本。 根据资源类别的不同，目前主流的云服模型有如下三种[49]:
(1) 软件即服务(Software as a Service, SaaS ),为全新的软件应用和交付 模式，通过将云基础设施上运行的应用程序，以应用软件服务的方式交付给用户， 使应用程序可以通过各种终端通过网络接入，用户无需管理或控制软件运行所需 的底层云基础设施，以及软件本身的维护[50-52]。
(2) 平台即服务(Platfrom as a Service, PaaS),为全新的软件托管服务模式， 用户能够通过服务提供商提供的接口，将自身的应用在云基础设施当中进行托管 。 [53]
(3) 基础设施即服务(Infrastructure as a Service, IaaS),为全新的基础设施 外包运作模式，用户可以根据自身的需求获取基础计算资源(CPU、内存、存储、 网络等)。用户可以通过该层服务，部署、运行和控制操作系统及相关的应用软 件，而无需关心或实现底层云基础设施的维护[54]。
这三种服务模式分别处于不同层次，均能独立对外提供相应的云服务。三种 服务模式之间有一定但不是必须的依赖关系，通常 SaaS 可以但不是必须运行在 PaaS 之上，PaaS 可以但不是必须运行在 IaaS 之上。就服务对象而言，SaaS 面向 的用户就是常规应用层用户，PaaS 提供的平台开发、测试环境作为服务，一般 面向开发人员，而 IaaS 提供底层 IT 基础设施服务，一般面向运营管理人员。
在联运信息化领域，应该分析行业自身的发展现状，并按照联运信息化过程

西南交通大学博士研究生学位论文

第 23 页

中资源再利用的要求，将其与云计算进行融合。与很多传统领域不同，铁水联运 是一个多机构共同参与协作的运输过程，在信息化过程中会出现大量的信息共享 需求和碎片数据，从云服务模型的建立上来看，应该从基础设施到应用服务进行 逐级重构，并结合其业务特点进行服务扩展(详见 3.4.2 节)。
2.2.4 云构建模式
根据云基础设施构建模式的区别，满足不同用户的需求，目前主要有以下四 种基本的构建方式：
(1)私有云:云平台只为某一个机构服务，可提供对数据安全和服务质量的最 直接有效的控制。这种模式下，整个云的基础设施、平台及软件需要该单位自己 投资、建设、管理及维护，风险自担[55]。
(2)公有云:由云服务商提供免费或廉价的计算、存储或消息等服务，其核心 属性是通过互联网提供虚拟资源共享服务(如阿里云、腾讯云等)[56,57]。
(3)行业云:新型的云构建模式，是具有共同目标或者需求的多个单位共享使 用一套云基础设施，利益、成本和风险共同承担[58]。
(4)混合云:两种或以上的构建模式的混合体，通常将公有云与私有云进行混 合[59]。
在以上几种构建模式中，私有云构建相对简单，主要用于相对局部范围内(如 企业或机构内部)的资源整合；公有云能有效的实现大范围内低成本的计算、存 储或服务设施，并通过互联网共享这些资源，是大规模云计算平台的基础构架模 式；行业云更关注行业自身的特性，能有效的通过业务集成，实现联运参与机构 在共享的云基础设施上，按照利益、成本和风险共同承担的方式，按需获取各自 需要的信息服务；而混合云则能灵活的组合其他几种模式，使行业内部与其他行 业，以及外部用户进行更好的信息互联和安全控制，本文对云环境下铁水联运信 息平台的构建模式分析详见 3.4.1 节。
2.3 云计算关键技术

云计算主要包括云平台和大数据两方面技术，颠覆了传统 IT 行业的消费模 式和服务模式，完成了从重复“购买软硬件产品”向“购买 IT 服务”转变，并 通过自助式服务获取提高 IT 系统效率和计算资源利用率。云平台与传统 IT 系统 的本质区别在于整体性和敏捷性，从管理角度上看，云平台的构建站在宏观层面， 应用范围弹性较大，而传统 IT 系统只考虑了局部业务应用，无法为高层管理者 提供整个行业的决策支持；从技术角度看，云平台也能充分利用云计算技术对传 统 IT 系统进行软硬件解耦、重构和标准化封装，并提供按需分配的资源环境。

第 24 页

西南交通大学博士研究生学位论文

2.3.1 云平台构建技术
云平台的构建主要包括虚拟化技术、并行计算技术、数据存储管理技术、和 云平台管理等技术，其基本内容可以概括为：
(1) 虚拟化技术 虚拟化(Virtualization)技术是一种通过隐藏计算平台的物理特性，提供给用 户一个抽象的模拟计算环境的技术，通过将物理计算机抽象为虚拟机，实现计算、 存储及网络等设备脱离真实的环境而在虚拟的环境下运行。虚拟化环境下，在同 一台物理计算机上可以模拟出多台逻辑计算机同时运行，每台逻辑计算机亦可独 立安装完全不同的操作系统，且有效的虚拟资源隔离使应用程序都可以在互不干 扰的独立空间内运行。虚拟化技术包括服务器虚拟化、存储虚拟化、网络虚拟化 和容器虚拟化等不同的虚拟层次，不同于物理系统，虚拟资源可以根据需要非常 容易地进行配置和维护，可以把有限的固定的计算资源根据不同的需求进行重新 规划以达到最大利用率。作为云计算的基础，其本质上是一种资源管理技术，其 目的是让资源得到合理的利用，从而降低前期成本和运营成本[60-62]。 (2) 并行计算技术 并行计算是通过将被求解的问题分解成多个独立的计算任务，在资源虚拟化 基础上，并行的使用计算速度和处理能力一般的计算资源，实现问题高效协同处 理的技术。云环境下的并行计算系统可以是任何的虚拟计算集群，无论是虚拟机 还是容器甚至是云计算机，均能在完成数据处理后自动汇集和返回计算结果 。 [63][64] (3) 数据存储管理技术 云平台使用分布式的虚拟存储技术对海量数据进行存储和管理，通过冗余存 储的方式保证数据的高可用性、高可靠性以及经济性；同时为了向用户提供高效 的数据服务，云平台必须能利用数据管理技术对数据进行一系列的加工，并从海 量的数据集中快速找出符合用户需求的结果数据[65][66] 。 (4) 云平台管理技术 云平台拥有的服务器集群通常跨越了多个处于不同位置的数据中心，并且还 运行着大量的业务应用。如何将这些服务资源管理和维护在更有效的范围内，并 保证这些应用能持续的提供服务，是云平台管理技术必须考虑和解决的问题。作 为是云的中枢神经，云平台管理系统不但可以通过服务器的协同工作，完成高效 的应用部署和服务提供，而且能够快速的发现系统故障并对其进行修复，通过自 动化和智能化的管理手段实现资源的运营和管理[67][68] 。 (5) 云安全技术

西南交通大学博士研究生学位论文

第 25 页

在云计算架构下，云平台管理着大量的并行业务应用，其开放的网络和业务 共享场景更加复杂多变，海量数据集中存储的安全性挑战更加严峻，云安全技术 主要包括以下几方面：
a)共享业务安全问题 云平台通过虚拟化技术实现资源共享，在提高利用率的同时也会出现新的安 全问题，一方面需要保证用户间的资源隔离;另一方面需要面向虚拟机、虚拟存 储等虚拟对象的安全保护策略。 b)业务数据安全问题 业务数据安全性是用户最关注的问题，主要包括数据丢失、泄漏、篡改等风 险，特别在铁水联运业务的多机构协作共享环境下，如何保证各部门自身的数据 安全变得尤为重要。云平台的业务数据通常存储在离用户很远的数据中心中，需 要采取有效的保护措施，如数据存储冗余和加密，以确保数据安全。 c)用户身份安全问题 云计算通过网络提供弹性的信息服务，用户须登录到云端使用应用与服务， 系统需要在用户身份认证和授权后才能提供服务。如果非法用户取得了合法身份， 则会危及其他合法用户的业务数据。 上述技术对云环境下铁水联运信息平台构建至关重要，其中，虚拟化技术和 数据存储管理技术是计算资源池化的基础(详见 3.4.3 节)；并行计算技术通常用 于云环境下分布式组件的设计(详见 5.3 节和 6.3 节)；云平台管理技术用于实现 虚拟资源和应用的调度(详见 4.4 节和 3.4.3.1 节)；而信息系统的业务共享和业 务数据的安全性问题，本文通过安全资源池实现对资源的隔离控制(详见 3.4.3.2 节)；对于用户身份安全性问题，本文建立了基于 SaaS 的应用安全模型， 实现对云端业务应用的统一认证和授权(详见 4.4.5 节)。
2.3.2 大数据技术

2.3.2.1 大数据的定义及特征
大数据(Big Data)是指因为其自身的容量太大、增速过快、类型复杂且密度 低，须使用新的处理模式进行挖掘后，才能使其具备更强决策力、更能深刻洞察 的高增长率且多样化的海量信息资产[69]。从数据的种类看，大数据是指那些传统 手段无法有效收集、存储管理和处理的信息，同时由于数据集的规模超出传统手 段的处理能力范围，通常需要更强大的手段(如云计算等)才能处理。参考 Gartner 和国际数据公司的定义，大数据具备 4V 特性，即数据容量大(Volume)、数据种 类多(Variety) 、增长变化快(Velocity)、数据价值大(Value)，高度概括了大数据 所具备的基本属性及特征。

第 26 页

西南交通大学博士研究生学位论文

2.3.2.2 大数据技术分类
对于传统数据的处理，由于数据来源相对单一，数据集规模较小，因此对存 储介质和计算处理能力的要求不高，通常采用现有的关系数据库或者数据仓库等 技术即可完成其存储、处理和利用；与此不同，由于大数据的来源广泛，数据的 类型更加多样化，需要收集、存储和处理分析的数据体量庞大，对数据的应用及 展现能力要求较高，且十分注重数据处理的时效性及可用性，传统的数据处理分 析方法无法满足大数据环境下数据分析的需求。虽然目前的大数据类型和处理方 法没有统一的标准，但其分析技术基本一致，按照大数据处理的需求和过程可分 为大数据采集、存储、处理与呈现等相关技术[70]，主要分为以下几类:
(1)大数据采集技术 大数据采集指的是通过特定的手段，获取容量巨大、类型多样化的结构化、 半结构化及非结构化的海量数据，是大数据处理过程中最基础的步骤。在数据的 实时性和可靠性的要求下，主要包括基于分布式平台的高速高可靠数据抓取的大 数据收集技术，保证数据完整性与一致性的大数据安全技术，以及实现高速数据 解析、转换与装载的大数据整合技术。 (2)大数据存储和管理技术 大数据存储与管理用于解决大数据在物理层面和逻辑层面的存储和管理问 题。在物理层面，需要构建可靠的分布式文件系统(如 Ceph)，以提供高可用的、 高容错的、弹性可配置的、高效低成本的大数据存储；在逻辑层面，需要研究大 数据建模技术，提供分布式的非关系型大数据管理与处理，以及异构数据的融合 和组织能力。 (3)大数据分析技术 大数据分析是大数据处理的核心，其目的是通过分析计算过程发掘数据中的 潜在价值，处理分析需遵循三个原则：面向全体数据而非随机数据；面向混杂性 而非精确性；面向相关关系而非因果关系。这些原则是大数据分析区别于传统数 据处理的需求、方向和技术要求[71]。在大数据环境下，单纯依靠单个服务器的计 算能力，已无法满足大数据处理时效性的要求，须通过 MapReduce 等并行处理 模型提高数据处理速度，并使系统具备可扩展性和高可用性等优势。大数据分析 模型目前分为集中式计算和分布式计算两种，集中式计算获得大数据处理能力的 方式是依靠造价昂贵的 GPU 和大型机，对于单机系统而言虽然十分强大，但数 据处理的规模瓶颈仍然存在；而分布式计算获得大数据处理能力的方式是基于廉 价的 X86 计算集群，由于集群的通用性和可扩展性，在分布式计算环境下，可 处理的数据规模可随集群的扩展而增加，不存在性能瓶颈，更适用于联运大数据 的处理。

西南交通大学博士研究生学位论文

第 27 页

(4)大数据可视化技术 大数据分析结果对用户的解释和呈现是大数据处理的最终目的，传统的数据 展示方式无法解决大数据分析结果复杂性和数据量大的问题，而大数据可视化技 术的引入可以更直观有力的展示大数据分析结果[72-76]。 大数据技术是铁水联运信息化服务水平提升的关键技术，本文基于上述关键 技术，构建了云环境下铁水联运信息平台的数据支撑体系，统一并规范了联运物 流业务的大数据收集，管理，分析和呈现过程(详见 3.4.5 节)，并针对订撮合问 题建立了基于联运大数据的智能订单撮合系统模型(详见 6.2 节和 6.3 节)。
2.3.2.3 铁水联运的行业大数据
随着我国铁水联运货物规模迅速扩大，以及物联网和传感器技术的广泛应用， 需要处理信息的数据量和种类急剧递增，核心数据不仅涉及联运业务过程中调度、 运输、转运、仓储及装卸等环节的海量实时信息，也包含货运业务办理，联运产 品和营销相关过程中产生的多样化信息，具备大数据的 4V 特性。这些数据在云 平台沉淀，并与利用大数据技术进行二次挖掘后所形成的抽象化的，可统一管理 的数据集合，共同构成铁水联运的行业大数据。

2.4 云计算相关框架

云计算框架是实现云计算技术的基础，为方便后续章节云环境下的联运信息 平台研究，下面对本文所涉及的相关技术框架进行统一概述如下。

2.4.1 云平台构建框架

(1) OpenStackOpenStack 作为一个管理虚拟机的 IaaS 平台，集成了多个核

心和扩展子项目，并且之间可以协作完成任务。任何组织均能利用 OpenStack 并

基于标准化的硬件设施创建和提供云服务，以提升系统性能和可用性，简化 IT

设施管理，提高 IT 效率，并降低部署和运维成本。OpenStack 被设计为可灵活扩

展的大规模云操作系统。作为目前最著名的开源云平台，OpenStack 的发展速度

十分迅速，已从最初的三个子项目发展到七个，如表 2-1 所示[77]：

表 2-1 Openstack 子项目说明

子项目

功能说明

界面展示(Dashboard)

在 OpenStack API 接口的前提下向使用主体等进行 WEB 服务管理 接口的供给，使用主体能够借助于 Dashboard 进行虚拟机实例的管 理和控制，同时，管理人员能够借助于 Dashboard 进行 OpenStack 系统的管理和控制工作

认证管理(keystone) OpenStack 当中全部的使用主体以及服务是一致的 镜像管理(Glance) 为虚拟机镜像前提下的保存以及查询体系，使用主体能够借助于

第 28 页

西南交通大学博士研究生学位论文

简单对象存储(Swift) 计算管理(Nova)
网络管理(Neutron) 块存储(Cinder)

RESTful AP 进行数据信息的查询以及分析 云平台当中所安排和布置的对象存储系统借助于 key/value 的手段 对于数据信息进行保存与分析，在单次写入，始终保持不变的情况 当中有着很强的适用性，就像，图片等一系列数据信息的保存 进行虚拟主机服务的供给,在这个过程当中借助于虚拟化技术,就 像，Xen 等完成计算等一系列的物理资源能够顺利的实现虚拟化进 行虚拟化资源池的发展建设,在这种情况下，使用主体获得相应的服 务 通过借助于虚拟机，使得网络管理服务顺利的实现供给，涉及子网 IP 管理、负载均衡等不同方面的基本内容 能够对于块保存实施科学合理的管理,使得虚拟机能够顺利的获得 云硬盘服务，虚拟机进行新的硬盘的识别，从现在的基本情况来看， IP-SAN 等保存网络能够得到支持

(2)Docker Docker 是 PaaS 专业提供商 dotCloud 开源的一个基于 LXC 的开源容器引擎。

虽然 OpenStack 解决了服务器硬件的管理问题，但无法解决然而中间件开发部署

相关的问题和复杂的管理环境，因为用户需要的是高效运行环境而非操作系统，

宿主机模式既浪费资源又难于管理。针对 OpenStack 虚拟机管理的弊端，Docker

提出了基于 LXC 的轻量级容器虚拟化方案，在 IaaS 之上提供了集应用构建、环 境迁移和集群管理于一体的轻量级解决方案[78]。Docker 采用容器镜像方式管理 应用系统，这种在相同主机上的容器隔离机制使不同语言开发的系统代码可以在

同一个虚拟机上进行透明部署和运行。Docker 采用 C/S 架构模式，通过客户端

连接并控制服务进程，其主要组件如下：

(a) Docker Registrys 是一个存储容器镜像的管理仓库，容器镜像是在容器

被创建时加载和初始化容器的文件系统与目录。

(b) Docker Daemon 作为服务器守护程序，主要有 Docker Server 和 Engine 两部分。Docker Server 负责接受客户端的请求，Engine 是作为容器核心管理所

有的容器。

(c) Docker Container 是 Docker 系统结构中服务交付的最终体现方式，通 过 Docker 命令即可运行容器。

(d) Libcontainer 是 Docker 的库文件，Docker 可直接调用 Libcontainer 库

文件，实现容器的 namespace 和 cgroups 等资源隔离。 与 KVM 和 Xen 等内核虚拟化机制不同，Docker 是针对应用的开发部署进

行设计，在进程级别有效的解决了不同语言、库和框架差异所造成的兼容性问题，

并提供基于 DockerHub 仓库的标准化应用共享和发布机制，有效的解决了虚拟
机的应用管理问题，它们之间的差异如表 2-2 所示：
表 2-2 Docker 容器与虚拟机的差异

西南交通大学博士研究生学位论文

第 29 页

特性 启动速度 硬盘使用 性能 系统支持量 隔离性

容器 秒级
MB 接近原生 单机支持上千个容器 安全隔离

虚拟机 分钟级
GB 弱于 几十个 安全隔离

Docker 自 2013 年开源以来收到业界前所未有的广泛关注，不管是在 Github

当中的代码活跃水平，亦或是 Redhat 在 RHEL6.5 当中归集对于 Docker 的认同,

Google 也基于 Docker 构建了服务编排引擎以实现大规模的应用集群管理，

Docker 生态系统如表 2-3 所示：

表 2-3 Docker 生态系统说明

组件集

功能说明

Docker 容器(Container) 配置和服务发现(Config)
网络通信(Network) 编排工具(Weave) 监控工具(Monitoring)

提供标准化的 LXC 容器管理模型 服务发现是整个策略中的一个组成部分，用于提高
容器部署的伸缩性和灵活性, 本文研究所涉及的服 务发现/全局分布式键值对存储组件主要包括 etcd， consul 和 zookeeper 本文采用 flannel 的覆盖网络实现虚拟局域网划分 负责容器集群的管理，本文主要采用 mesos 和 kubernetes(K8S)作为容器云的编排工具。 负责对容器状态进行监控,本文主要利用 cAdvisor 实现容器集群的资源占用情况和性能负载分析

日志收集(Logging)

负责对容器内部应用的运行状态数据进行收集和 分析,为容器云的性能优化和伸缩提供数据来源,本 文主要采用高可靠的海量日志传输，存储和检索组

件 ELK

(3) Kubernetes

Kubernetes(或 K8S)由 Google 的 Borg 开源而成，是目前业界最完善的容器

编排系统，为容器应用提供资源调度、部署运行以及伸缩管理等功能。K8S 采用 基于 POD 的容器组管理方式，共开放 POD、Service 和 ReplicationController 三 个用户接口. 其中 POD 是 K8S 的部署调度单元，在逻辑上表示应用实例, 由于

POD 的状态是动态变化的，需要 Service 解决 POD 之间服务发现的问题，使 POD 的动态变化对访问端透明[79]。ReplicationController 主要解决 POD 的扩容和缩容。 分布式应用为了保证系统的高性能和高可用性，需要根据负载情况动态伸缩。通

过 ReplicationController，可以指定一个应用需要几份复制，Kubernetes 将为每份

复制创建一个 POD，并且保证实际运行 POD 数量总数。 (4) Mesos

Mesos 是 Apache 基金的开源分布式资源管理框架，完成两级调度结构的发

展建设，能够对于不同的应用程序实施管理。而且，首级调度为 Master 的守护

第 30 页

西南交通大学博士研究生学位论文

经过，集群通过物理服务器等构件起来，应用任务得以顺利运行；相比之下，后 一级调度由框架发展建立起来，Framework 涉及执行器进程等不同方面的内容， 而且，所有节点均能够运作 Executor。由于 Framework 的类型是可扩展的，Mesos 很适合作为多类型虚拟资源的分布式系统内核[80]。
本文主要利用上述技术框架，构建云环境下铁水联运信息平台的资源支撑体 系，并实现异构联运业务应用的混合虚拟化环境和集群部署(详见 3.4.3.1 节和 4.4.3 节)。
2.4.2 大数据处理平台
随着谷歌公开发布 MapReduce 等论文，大数据处理平台逐步发展建立起来， 更为科学完善的分布式计算理论随之出现[81-83]。而且，MapReduce 为分布式计算 架构[81,84]，GFS 为分布式信息机制，BigTable 为 GFS 前提下的分布式信息库体系， 已成为大数据平台的技术基础。在接下来的时间里，众多互联网公司以及科研部 门将目光集中在 Google 分布式计算模型方面，分析自己的分布式计算体系，经 过多年的发展，已经形成了以下大数据领域最热门的三大分布式计算系统：
(1) Hadoop：是 Apache 基金的主体内容，在 2005 年的时候产生，现在有 了不同的版本，而且，因为开源属性，Hadoop 已经成为分布式计算系统的事实 行业标准，其技术生态圈也变得更加成熟，涉及大数据处理的不同领域。对于 Hadoop 平台来说，达成了 MapReduce 分布式计算基本结构；参考 GFS 模型进行 Hadoop 分布式文件系统的发展建设；同时，参考 BigTable 进行 HBase 数据存储 系统的发展建设[85]。
(2) Spark：为 Apache 基金当中的开源内容，在 Hadoop 的前提下，实现了 基本构架的改进和完善，合理应对和处理其中所存在的各种问题，借助于内存进 行数据信息的保存，所以，从理论层面来说，Spark 的运算速度能够明显超出 Hadoop，同时 Spark 与 Hadoop Yarn 进行了无缝集成，也使这两者能够很好的协 同处理在线和离线大数据[86,87] 。
(3) Storm：是一个由 Twitter 开源的分布式实时计算系统，通过 Apache 基 金发展建立起来的项目。这种信息处理平台有着自身的基本属性，不能够进行信 息的获取以及保存，但是，能够借助于网络实时的获取以及分析流式数据信息， 同时，利用互联网实时的进行计算结果的汇集[88，89]
Hadoop, Spark 和 Storm 对于处理不同类型的大数据各自所长，其基本内容 可以参考表 2-4。铁水联运行业在进行运营和发展的过程当中，所涉及的数据信 息极为繁杂，同时，在进行联运大数据处理的过程当中，能够参考各个参与主体 的基本特点，在铁水联运云平台当中进行相应用途的联运大数据应用的安排和布

西南交通大学博士研究生学位论文

第 31 页

置。

表 2-4 Hadoop, Shark 及 Storm 比较

数据分析平台

大数据处理类型

Hadoop Spark Storm

离线批处理 近线/在线 RDD 处理
在线流处理

对于铁水联运数据的处理而言，主要包括服务水平和决策能力两个方面的提

升，实时数据分析需求相对较少，根据三者数据处理的不同特点，Hadoop 和 Spark 是实现联运数据离线和在线处理较好的选择，下面围绕 Hadoop 和 Spark 对相关

数据处理框架进行综述：

(1) Hadoop 2.x Hadoop 能够通过 Linux 集群提供 PB 级数据存储和处理的分布式软件框架，

Hadoop2.X 对 1.X 的架构做出了较大调整，使集群管理更灵活高效。Hadoop 同

样是进行大数据处理的基本软件平台。在该软件的辅助作用之下，使得集群的优

势作用得以充分全面的发挥出来，顺利的实现数据信息的存储以及分析。从

Hadoop 来说，其涉及 HDFS 分布式文件系统等不同方面的基本内容，得到 Apache

基金会帮助和支持的情况下，Hadoop 在进行发展的过程当中获得巨大的推动作 用，从现在的基本情况来看，进行了不同子项目的发展建设，促进 Hadoop 平台

形成一个比较完整的大数据栈，其子项目的基本内容可以参考表 2-5。因为具备

易用性以及开源特性等基本属性，Hadoop 慢慢演变成大数据处理的基本规范。 同时，因此而逐步建立起来的技术生态圈为大数据的获取以及研究等获得了更加

理想的方法[85]。
项目名称 Hadoop
HDFS
MapReduce
Hbase Hive
Zookeeper Sqoop
YARN
Flume

表 2-5 Hadoop 项目的功能描述 功能描述 使得其他 Hadoop 组件获得帮助和支持的模块 分布式文件系统 分布式分析结构以及编程体系 能够使得结构化数据信息保存获得支持 信息仓库主要结构，进行信息查询服务的供给 分布式运用的促进服务 RDBMS 以及 Hadoop 当中信息交互的手段 资源管理器，为上层应用提供统一的资源管理和调度 分布式的海量日志信息收集工具

(2) HDFS

HDFS 是 Hadoop 的分布式文件系统，具有传统文件系统及存储结构所没有

的高吞吐量访问、无缝容量升级扩充、高容错、低成本和高可用等特性，适用于

大数据应用并提供高吞吐量的数据访问能力。

一个 HDFS 文件系统主要包含 NameNode 和 DataNode。而且，NameNode

第 32 页

西南交通大学博士研究生学位论文

为数据信息获取以及分析的主服务器，能够科学合理的进行数据信息的布置和安
排，使得数据信息于 DataNode 节点顺利的实现保存，能够对于 HDFS 文件系统 进行管理和控制。就 HDFS 文件系统而言，数据信息得到合理管理，并且在 DataNode 节点当中进行划分，使得数据信息的容错性获得显著的提升。同时在 Hadoop2.x 版本中引入 HA 和 Federation 技术，解决单点故障问题和集群容量、 性能问题。一个 HA 中至少两个 Namenode，一个 Namenode 处于 Active 状态， 其它处于 Standby 状态，所有 Namenode 数据通过 JournalNode 进行数据同步。 所有的 Namenode 会向 Zookeeper 进行注册，Zookeeper 用来管理 Namenode 的状 态，当 Active 节点状态发生变化时，Zookeeper 会自动切换 Namenode 之间的状 态，达到整个集群正常工作的状态[90]。
(3) MapReduce 从根本上来讲，MapReduce 在 Hadoop 集群当中进行运作，而且，能够实现 数据信息的归集与处理，能够通过廉价商业硬件服务器发展建立起来，容错的能
力获得显著提升。MapReduceV2 对 MapReduce 的集群管理模型进行了优化，主 要由三个核心组件构成：其中 ResourceManager 作为调度器，基于应用程序对资 源的需求进行调度；NodeManager 是执行应用程序的容器，用于监控应用程序资 源 的 使 用 情 况 并 向 ResourceManager 进 行 汇 报 ； ApplicationMaster 用 于 向 ResourceManager 索要适当的资源容器，运行任务，跟踪应用程序的状态和监控 任 务 进 程 ， 并 处 理 任 务 失 败 的 原 因 。 在 资 源 管 理 上 ， MapReduce 通 过 ResourceManager 全 局 管 理 所 有 应 用 程 序 资 源 的 分 配 ， 每 一 个 应 用 程 序 由 ApplicationMaster 负责调度和协调[91]。
(4) Sqoop 对于 Sqoop 而言，为用在 Hadoop 大数据保存以及结构化信息管理体系当中 的信息输送手段。因为 Sqoop 使得 MapReduce 运行获得支持，能够促进数据信 息处理效率的提升，因此，其为借助于 Sqoop API 便于进行大数据的归集以及 处理的基本手段[92]。
(5) Hive 通过进行 Hive 数据仓库软件的合理运用，能够使得分布式系统当中的数据 信息得到系统的管理，还能够便捷的进行数据信息的查询。Hive-SQL 为和结构 化查询语言的 Dialect 有很多相同点的数据信息处理系统，而且，实现 MapReduce 程序的转化，促进查询效率的显著提升[93]。
(6) Spark Spark 是 UC Berkeley AMP lab 所开源的类 Hadoop MapReduce 的通用并行 框架，通过将中间计算结果保存在内存中，可以更好的适应于数据挖掘与机器学

西南交通大学博士研究生学位论文

第 33 页

习等需要迭代的 MapReduce 算法。Spark 项目包含多个组件，各组件密切结合， 使得软件栈中所有的程序库和高级组件都可以从下层的改进中获益，运行整个软 件栈的代价变小，能够构建出无缝整合不同处理模型的应用。Spark 组件栈相对 比较轻巧，并且可以直接采用 Hadoop Yarn 资源管理器进行集群构建，与 Hadoop 配合同时处理在线和离线大数据是一个很好的选择[87]。
(7) MLlib MLlib 为 Spark 当中为机器学习关系式的库，根据集群运行展开合理布置和 安排。其为 Spark 对于一般的的机器学习手段的达成库，而且，还涉及数据信息 生成器等不同方面的内容。从现在的基本情况来看，MLlib 为不同机器学习问题 提供支持，包括类别界定、回归、协同过滤以及聚类[94]。 (8) Kafaka Kafka 是 Apache 基金的开源项目，为性能突出的分布式发布/订阅消息队列 体系。为 Kafka 集群中包含 Producer、Broker 等集群。同时，Kafka 借助于 Zookeeper 管理集群实施 Rebalance[95]。 (9) Flume Flume 是 Apache 基金下的一个高可用的，高可靠的，分布式的海量日志采 集、聚合和传输的开源系统，基于 Avro 序列化体系实施发展建设。而且，Flume 能够对于数据信息实施初步处理，同时，写到一系列信息接受方的能力，与 Kafka 配合很容易实现大规模的日志流数据数据的收集[96]。 (10) MyCat MyCat 是一个开源的分布式数据库集群系统，低成本的把握目前的单机数据 库等迁移至云端当中，使得其中所存在的难题能够妥善的得到应对和处理。 MyCat 实现了 MySQL 协议的服务器，前端借助于 MySQL 客户端手段等实施访 问，还能够借助于 JDBC 协议和基本上所有的常见数据库服务器实现信息沟通和 交流，具备分表分库的作用，十分适用于海量的结构化业务数据存储[97]。 (11) Redis Redis 是一个高性能的分布式 key-value 缓存，同时支持缓存数据持久化。 Redis 可以周期性的把更新数据写入磁盘或把修改操作写入追加的记录文件，与 MyCat 类似，Redis 也提供了基于 Codis 的集群解决方案，同时 Codis 可以实现 Redis 的高可用和集群节点间的数据同步[98]。 本文主要利用上述技术框架，构建数据支撑体系的联运大数据相关应用，并 实现海量数据的收集、传输、存储和分析 (详见 3.4.5 节和 6.3 节)。
2.5 本章小结

第 34 页

西南交通大学博士研究生学位论文

本章主要是对铁水联运业务特点和构建联运云平台所涉及的云计算和大数 据的核心理念及技术进行梳理。首先对概述了铁水联运的构成主体、业务特点， 信息共享需求；然后系统分析了云计算的基本内涵以及相关研究成果，研究了云 计算的主要特征、构建模式以及服务模型；最后对云计算的关键技术进行概述， 并在此基础上，分析和阐述了铁水联运云平台构建所需的相关技术框架，为铁水 联运云平台的构架设计奠定基础。

西南交通大学博士研究生学位论文

第 35 页

第 3 章 铁水联运云平台的构架设计

为提高我国铁水联运的整体水平，更好的满足客户的服务需求，联运信息化 的支撑作用得到了前所未有的重视。由于我国目前的联运信息化建设都以港口为 中心，缺乏统筹规划，港口也只是为了满足自己业务发展的需求，出现很多重复 建设，也缺乏对业务增长的有效预期和控制。随着新的联运业务不断涌现和业务 规模的快速膨胀，分散在各港口的联运信息系统熵值会迅速提高，不堪业务发展 的重负。为促进铁水联运业务的转型升级，提高我国整体铁水联运信息化水平， 对信息系统布局和构架进行优化具有很大的必要性与紧迫性。
本章通过将云计算的核心技术及理念引入铁水联运信息化，对目前的铁水联 运信息构架进行重构，设计铁水联运云平台的整体构架方案并论述其优越性，同 时分析云平台的功能体系，业务和数据需求，为后续章节的研究奠定基础。

3.1 现有铁水联运信息系统构建模式弊端分析

我国目前铁水联运信息化采用以港口为中心进行分散建设，各港口根据自己

的业务发展情况，建设适用于自己的联运信息系统，并分别与其他联运参与机构

进行信息集成，如图 3-1 所示：

货主/联运经营人

铁路部门

船公司

政府机构(海关,国检等)

第三方机构

信息交互

未建成 已建成

大型港口

中型港口

小型港口

联运电子 订舱订车 联运产品 EDI数据 其它港口 联运电子 订舱订车 联运产品 EDI数据 其它港口 联运电子 订舱订车 联运产品 EDI数据 其它港口 商务系统 管理系统 管理系统 中心 信息系统 商务系统 管理系统 管理系统 中心 信息系统 商务系统 管理系统 管理系统 中心 信息系统

服务器-1 服务器-2 服务器-3 服务器-4 服务器-n 服务器-1 服务器-2 服务器-3 服务器-4 服务器-n 服务器-1 服务器-2 服务器-3 服务器-4 服务器-n

通信设施

通信设施

通信设施

机房配套设施（供电、冷却等）

机房配套设施（供电、冷却等）

机房配套设施（供电、冷却等）

图 3-1 以港口为中心的铁水联运信息化模式
如图所示，大型港口为了自身业务发展，也已投入大量精力，规划并建设了 相对完善的联运信息化体系；而中小型港口由于人力财力方面的限制，导致信息 化体系不完备。铁水联运信息平台是一个复杂的巨系统，除了一般信息系统的特

第 36 页

西南交通大学博士研究生学位论文

点外，还必须具有集成性、动态性、实时性等特点。通过对连云港，宁波港等港

口的联运信息系统调研我们发现，目前的信息化模式主要存在以下几方面问题，

导致我国联运信息化水平低下，服务能力参差不齐：

(1) 布局不合理 目前我国以港口为中心的分散联运信息布局，主要存在以下问题[99]：

(a) 重复建设现象严重，信息化成本过高。每个港口都需要购置联运信息系

统建设所需要的独立的硬件和软件，重复建设现象十分普遍。联运信息系统建设

的成本涉及硬件、软件以及管理成本，一些特殊的信息系统(如 EDI 系统)，甚

至需要专用的小型机部署，成本高昂，并非全部的港口部门均能够承受，即使对

于大型港口来说，同样面临着巨大的压力；此外由于各港口信息系统缺乏统一标

准，接口不一致，导致铁路，海关国检等联运参与部门需要进行重复的成本投入，

与不同的港口完成信息集成。

(b) 优势技术无法共享。公报显示我国逾 90%的港口属于中小型港口，这些 港口每年的吞吐量总和也十分惊人[6]。这些港口虽然建设水平参差不齐，信息化

程度相对落后，但也具备较大的发展潜力，这些港口的信息化发展也会直接影响

我国的联运服务水平。但在目前分散的信息化布局下，港口需各自投资建设联运

信息系统，相互之间彼此独立，大型港口的优势技术相对封闭，无法快速的与小

型港口进行共享，导致我国整体联运信息化水平难以提高。

(c) 客户服务水平低下。货主和联运经营人需要与不同的港口进行业务办理，

不同港口的业务流程规范和服务接口不同，并且存在较多线下业务过程，导致客

户服务质量低下。

(2) 信息系统异构化严重，技术构架落后

目前港口和铁路等部门已拥有庞大的信息管理系统，且因开发时间不同，技

术水平存在较大差异，造成各系统之间的异构化严重，其中典型的几大系统差异

如表 3-1 所示：

表 3-1 港口铁路典型的业务信息系统

机构 系统名称

操作系统

语言环境

港口 港站管理系统

Linux/Windows C/C++/C#

堆场集装箱管理系统 Linux/Windows C/C++/Java

船舶管理系统

Linux/Windows C++/C#

港口列车管理系统 Linux/Windows C++/C#

港口吊车管理系统 Linux/Windows C++/C#

货运电子商务系统 Linux/Windows Java/C#/Python

数据交换系统

Linux/Unix/AIX C/C++/Java

铁路 运输调度管理系统 Unix/Windows C/Java

货物运输管理系统 Unix/OS-390 C/C++/Java

行包管理信息系统 Unix/Linux

C/Java

资源类别 SqlServer/DB2/Oracle SqlServer/DB2/Oracle SqlServer/DB2 SqlServer/DB2 SqlServer/DB2 Oracle/MySql DB2/Oracle Oracle DB2/SqlServer Sybase

西南交通大学博士研究生学位论文

第 37 页

集装箱运输管理系统 车号自动识别系统 货运营销决策系统

Linux/Windows Linux/OS-390 Linux/Windows

C/C++/Java C/C++ C/Delphi

Oracle DB2/SqlServer Oracle

由上表可知，这些信息系统的操作系统，语言环境和数据库均存在较大差异，

同时铁水联运相关的信息系统在各港口进行构建，均采用软硬件资源捆绑的“烟

囱式”构架，即系统软件和服务器、存储等硬件资源强耦合的捆绑建设模式，每

个系统由不同的软件提供商进行独立建设和维护，结构如图 3-2 所示：

港口部门

软硬件维护组N1 软硬件维护组2 软硬件维护组1

货运电商系统
服务软件 数据库
操作系统 服务器 存储设备 网络设备

数据交换系统
服务软件 数据库
操作系统 服务器 存储设备 网络设备

……

其他业务系统
服务软件 数据库
操作系统 服务器 存储设备 网络设备

现场部署交付
软件提供商1

现场部署交付
软件提供商2

现场部署交付
软件提供商N

图 3-2 以港口为中心的“烟囱式”系统构架
由于系统结构臃肿，体系僵化，主要存在以下问题： (a) 计算资源浪费严重。由于建设背景和需求差异，目前港口和铁路的信息 系统大都是异构系统，“烟囱式”构架的独立管理模式，无法根据负载在系统之 间动态调整资源分配，导致软件对硬件资源利用不充分、分配不均衡，闲置现象 比较普遍，大多数港口信息系统的服务器总体 CPU 使用率基本低于 5%，存储使 用率约 30%；对可靠性要求较高的系统(如 EDI 中心)一般使用价格高昂的专用计 算机，虽然采用双机冗余模式一定程度保证了系统可靠性，仅有部分服务器在提 供服务，并且每一个业务信息系统都运行于特定的物理服务器，无法进行共享， 导致能耗显著增加，存在大量的浪费现象。同时大中型港口的服务器数量根据规 模不同几乎都在几十台以上，有些甚至达到上百台，随着联运信息化建设的水平 提升，越来越多的服务器、存储和网络等 IT 资源对联运管理业务支持的投资回 报率却越来越低。 (b) 系统建设成本高，利用率低。每一个系统都必须设计独立的软硬件体系， 在这个过程当中，必须对每一个系统进行相应软硬件设施购置，以及投入一系列 人力物力进行系统开发，导致系统建设周期长，成本高。 (c) 系统敏捷性差。信息系统与业务深度耦合，新业务的引入需要从代码层 进行修改升级，导致需求响应和资源变更周期较长，效率低下；同时由于“烟囱 式”系统直接基于物理资源构建，服务器，网络，存储等设备配置繁琐，系统缺 乏灵活性。

第 38 页

西南交通大学博士研究生学位论文

(d) 系统可靠性差。由于目前的联运信息系统大多采用集中式构架，不具备 高可用特性，部分业务系统甚至存在单点故障[100]，在出现宕机时需要离线修复， 导致业务中断，无法保证 7*24 小时的联运服务。
(e) 系统可扩展性差。由于“烟囱式”构架不具备良好的可扩展性，虽然港 口投入了高昂的费用购买高性能服务器用以提高系统的吞吐量阈值，但也只能在 一定时间，一定范围内满足服务需求，无法按需进行动态的服务扩展。
(f) 系统安全性差。港口的信息系统之间软硬件设施相互隔离，安全措施不 一致，业务安全由各系统分散控制，较容易出现安全漏洞和信息泄露问题。
(g) 系统运维成本高，效率低下。由于每个联运信息系统都需要独立的运维 团队，软件资源以及硬件资源难以实现运维解耦，在这种情况下，人才的职责难 以得到明确具体的界定，难以及时全面的发现其中存在的缺陷和不足，IT 运维 人员闲置情况严重，只有出现系统故障的时候才会去被动排查，缺乏主动预防式 服务，导致系统运维成本高，效率低下。
(h) 信息交互模式落后。“烟囱式”构架下，物理服务器按软件系统进行分 配(每个系统一台或几台物理服务器)，信息以系统为单位直接与用户通过客户端 进行信息交互，没有统一的服务端口，带宽资源占用大，如图 3-3 所示：

Request Request

Servers Gateway

Response Data
页面 视图

Response

桌面 渲染
客户端
图 3-3 传统的软件信息交互模式
(3) 信息共享体系僵化 信息共享作为联运信息化的核心，直接决定了联运信息的交换水平，也是目 前联运信息化研究的热点，目前的相关研究大都基于 EDI 或 ESB 构架对联运信

西南交通大学博士研究生学位论文

第 39 页

息共享平台进行设计，主要存在以下问题： (a) 构架笨重。联运信息共享体系均基于重量级的信息集成构架，由于需要
使用专用的服务器进行部署，不但信息集成工作量大，且只能满足有限范围内的 信息集成需求；虽然可以通过共享系统级联方式解决机构间互联的问题，但由于 系统门槛较高，中小型港口无法负担其建设成本，导致不同规模港口的信息共享 水平差距巨大。
(b) 缺乏弹性，性能瓶颈无法避免。EDI 或 ESB 对硬件资源要求较高，需 要专用小型机服务器，软硬件捆绑导致其不具备弹性伸缩能力，吞吐量阈值有限， 无法承受高并发的信息处理请求。随着联运业务的快速增长，港口需要定期的投 入大量资金升级软硬件以缓解该问题，但是无法从架构上根本消除性能瓶颈。
(c) 不具备开放性。由于 EDI 和 ESB 均采用总线结构，体系封闭，信息耦 合度较高，更适用于企业内部的业务集成，无法很好适应目前开放的信息化环境。
(4) 业务数据无法有效二次利用 目前的联运信息系统建设主要还是面向业务而非数据，同时由于系统的构架 问题，丰富的联运大数据所蕴含的巨大价值无法得到有效的利用。主要体现在以 下两方面： (a) 业务数据管理混乱。港口各自采用自己的业务据规范，接口不一致，数 据分散在各港口的多个信息系统中，形成“数据孤岛”，很难形成一致的数据规 范。联运信息共享平台虽然在一定程度上打通了信息通道，但是没有提供统一的 数据管理体系，导致数据无法二次利用。 (b) 数据分析手段匮乏。分散在各港口的联运业务数据蕴含着巨大的潜在价 值，但这些多样化的数据在传统的算法模型和计算框架下无法进行有效的分析。 由于目前联运行业数据应用相关的研究甚少，导致数据价值无法被有效挖掘，也 无法为联运行业提供决策支持和增值服务，成为了阻碍联运信息服务水平提高的 障碍。 由于传统的联运信息化存在上述无法克服的问题，所以必须寻求新的建设模 式来突破。研究如何将云计算技术应用于联运信息化建设，在实现兼容现有联运 信息系统的环境下，进行联运云平台构建的关键技术研究，同时结合大数据思维， 实现联运信息化升级转型、提高整个行业的服务水平，也是联运信息化发展的必 经之路。

3.2 铁水联运云平台的提出

结合论文背景课题《铁水联运技术标准及关键技术研究》的相关技术研究, 我们认为,要彻底解决 3.1 节的技术问题，让我国的铁水联运信息化发展到一个

第 40 页

西南交通大学博士研究生学位论文

新的高度，完成产业升级转型，有必要利用云计算技术强大的分布式计算和资源 管理能力，建立云环境下统一的铁水联运信息平台，通过整合联运相关的业务信 息系统，信息共享系统和第三方既有管理信息系统，建立集业务咨询、网上办理、 实时查询、全程追踪、运输方案制定、信息自动流转、个性化服务、电子支付等 功能为一体的开放式、自动化的信息生态圈，为客户提供一站式联运信息服务。
从技术上角度看，云环境下的铁水联运信息平台一方面需要管理多个机房的 物理服务器硬件资源，另一方面也能为业务层大量的联运信息系统提供统一的运 行环境，所以铁水联运信息平台的构架设计需要考虑云平台构架和云应用模型设 计两个层面[101-104]。为方便后续论述，先作以下两个定义：
定义 3-1(铁水联运云平台).采用云计算技术构建的，用于提供铁水联运行 业集成化信息服务的云平台。
定义 3-2(联运应用).指由铁水联运云平台集中管理的，以云应用方式存在 的，所有与铁水联运业务相关的信息系统。与传统的联运信息系统“本地安装、 本地计算”的特征不同，联运应用是在云端统一完成逻辑或计算任务，并通过互 联网直接获取的“即取即用”型应用服务。
根据 2.3.1 节可知，云平台的系统构架直接决定其业务范围和服务能力，目 前主流的业务云平台和相关构架研究大都基于单一的虚拟化技术构建，只能在某 一个层次提供服务，由于没有结合铁水联运的行业特点,无法支撑我国众多港口 内大量的异构联运业务信息系统实例，也不能有效消除其存在的所有弊端。
本章在对我国现有铁水联运信息化布局进行重构的基础上，利用云服务栈对 联运业务现状和信息化发展需求进行梳理，并提出了一个基于虚拟资源分层管理 的铁水联运云平台技术构架，通过将第二章的云计算核心技术及理念引入铁水联 运信息化，并结合联运云服务栈，同时对铁水联运云平台的计算资源，业务应用 和数据整合体系进行了深入研究。针对联运信息化领域系统异质化严重的问题， 在资源支撑层提出了混合虚拟化环境，在满足现有联运信息系统向云平台无缝迁 移需求的同时，打破了联运信息系统僵化的“烟囱式”结构，实现了联运应用的 计算资源按需分配，并建立了云环境下的联运信息交付和运营模式，是后续章节 的研究基础。
由于本文提出的联运云平台在铁水联运信息化领域是一个全新的构架体系, 目前在生产环境中还未有相关应用场景。为了验证论文的创新成果,结合本章的 相关理论研究,作者在工作单位四川农业大学物联网系,负责研发并构建了学院 的物联云平台(InterThings)，并配置了相关的虚拟运行环境集群用于相关模型测 试(相关内容详见 4.5 节和 5.4 节)，在理论研究的同时也为联运云平台的落地提 供实证依据。

西南交通大学博士研究生学位论文
3.3 铁水联运云平台的构架设计思路

第 41 页

由于云平台构建所涉及的技术和环境十分复杂，本节首先针对 3.2 节联运信 息系统构建模式的主要弊端，分析铁水联运云平台的构建思路如下：

3.3.1 采用集约型的大集中管理模式

针对目前联运信息布局不合理的问题，本文认为铁水联运云平台应该由参与

业务的铁路、港口等部门共同建设，采用“大集中”的信息管理模式进行构建，

能更充分的利用虚拟化技术，发挥资源集约化优势，将分布在各港口的联运信息

系统及业务数据集中管理[105]。在大集中管理模式下，可以有效利用云平台强大

的资源管理能力，使中小型港口能够摆脱联运信息化的限制，科学合理的进行成

本管理和控制，妥善应对与处理管理复杂性等问题，在短时间内具备与大型港口

同等的联运信息化水平。与分散的信息化布局相比，“大集中”模式的主要优势

体现如表 3-2 所示[106]：

指标/模式 业务规范性 信息共享性
建设成本 应用开发和 更新难度 信息交互方 式
运维模式 推广周期
风险

表 3-2 分散式布局与大集中模式的技术优势对比

分散式布局

大集中模式

港口业务流程不统一，数据管理 所有港口业务流程规范，统一

难度大

港口之间信息共享难以实现，数 数据统一存储，港口之间信息可实时共

据分散在各个港口，数据抽取和 享，读取被权限系统限制，数据挖掘容

挖掘难度大

易

港口重复投资，维护成本高

联运管理机构一次投资，集中运维

采用“烟囱式”构架，系统更新 采用虚拟化的软件封装，系统更新周期

周期长

短

以系统为单位进行信息交互，资 信息通过云服务模式进行交互，服务资

源利用率低，交互成本高，效率 源可在租户间共享，利用率高；以服务

低，可靠性差

按需租用方式代替软件购买，成本低

廉；服务端口统一，可以随时随地接入，

服务容量大，可靠性高

垂直运维模式，运维人员冗余严 扁平化运维模式，运维人员高度共享，

重，利用率和效率低

利用率和效率高

每 个 港 口 有 自 己 的 联 运 服 务 系 采用统一的服务门户，加入港口越多，

统，靠港口自己推广，港口越多， 推广效率越高

推广速度越慢

风险分散控制，每个港口都是独 风险集中控制，通过云的高可靠性保证

立风险控制点，需要采取本地数 服务和网络通信质量，采用统一的应用

据保护和备份措施，并维护部门 安全策略确保信息安全

之间的通信网络可靠性

此外，随着联运行业发展和规模的扩大，大集中管理模式的规模经济性会逐

第 42 页

西南交通大学博士研究生学位论文

渐显现，与传统的联运信息化技术相比，不但能提高资源的利用率，将信息系统 建设和运营成本控制到一个能使业务本身从中受益的范围内，并且能促进业务数 据向云端集中沉淀，使联运大数据的二次利用成为可能。
3.3.2 采用分层的虚拟资源管理构架
云平台是一个十分复杂的体系，无法在一个层次解决所有的问题，而根据 2.2.3 节的云服务模型划分，铁水联运云平台构建的关键是根据联运信息系统的 构架和业务特点，对计算资源进行分层虚拟化管理，与传统的纵向资源管理方式 不同，横向的扁平化管理模式能有效破除僵化的“烟囱式”构架所带来的上述资 源管理问题。
首先，基于资源共享的理念，利用云计算强大的资源管理能力对服务器硬件 进行虚拟化，并建立统一的虚拟资源池；然后，在资源池上构建联运应用池，通 过对联运业务相关的信息系统和数据交换系统逐步重构和迁移后在云端，形成共 享的联运应用池，打破港口之间的技术壁垒，充分利用虚拟资源的弹性调度和按 需分配特性，提高计算资源的利用率和经济性；最后，在应用资源池上构建基于 云服务的应用交付模式，形成云端统一的信息交互和对外服务端口，提高客户服 务水平。
资源管理构架需要集中管理大量的联运应用，在设计时还需要考虑以下几方 面因素：
(1) 具备通用性和敏捷性。由于联运信息系统的异构化现象比较严重，虚拟 资源池和调度运行环境必须具备足够的通用性，才能满足联运应用的管理需求， 同时联运应用。
(2) 具备高可靠性。由于联运应用的管理是基于虚拟资源而不是物理服务器， 其管理组件应充分利用虚拟资源的调度灵活性，动态监控和控制应用集群的运行 状态，使其对外部提供高可用的信息服务。
(3) 具备可控的安全性。在目前的联运信息系统构架下，由于应用之间相互 独立，安全威胁只会影响到应用本身，而云平台需要实现所有联运应用的集中管 理，某个应用的安全则可能会威胁到整个平台的安全，所以资源管理构架的安全 组件应能够同时保证计算资源，应用服务和业务数据的安全性。
(4) 信息交互的高效性。在目前以系统为单位的信息交互模式不同，联运应 用是在云端进行逻辑计算，所以资源管理构架的设计应该充分利用虚拟资源池的 集中计算特性，结合云服务模式，实现“软件即服务”的按需信息交互。
3.3.3 采用业务应用与信息共享融合的设计方案

西南交通大学博士研究生学位论文

第 43 页

针对联运信息共享体系僵化的问题，本文认为应该利用虚拟化技术对传统的 信息共享系统进行重构，使数据交换系统在云端形成联运应用，在兼容目前业务 需求的条件下，与其他联运信息系统融为一个整体，被铁水联运云平台的资源管 理体系统一调度，减小系统管理成本，并能进一步利用云的伸缩能力建立数据交 换的伸缩机制，最大化利用虚拟资源以提高其吞吐量；同时在云环境下，这样的 设计可以使数据交换系统能以信息集成即服务的方式实现港口和联运参与部门 的按需信息共享，不但具备良好的开放性，也能大幅降低信息共享成本和技术门 槛。
3.3.4 构建可扩展的数据服务体系
针对业务数据无法有效二次利用的问题，数据服务体系的构建是联运行业大 数据融合与增值的有效途径。数据支撑体系直接面向联运业务过程中所产生的多 样化业务数据，必须具备足够的可扩展性和灵活性，本文认为通过将数据管理与 应用(即数据分析)解耦，能更灵活的对离散的业务数据进行沉淀管理与二次利用， 其构成主要包括以下两部分：
(1) 构建基于 DOA 的大数据管理体系。目前联运业务相关系统的结构化数 据都存放在关系数据库管理系统中，而半结构化和非结构化数据一般存放于文件 系统中。关系型信息库和信息仓库是原有的典型信息管理结构，仅在特定的条件 下处理结构化数据，而半结构化和非结构化数据在传统信息化环境下除了存档几 乎难以被有效利用。由于铁水联运涉及的参与方较多，牵扯到多个部门的信息系 统数据管理，数据的构成复杂，同时由于铁水联运业务量的迅速增长和物联传感 设备的参与，如何应对海量数据的长期存储和几何级数的增量数据问题，在也需 要从数据管理体系上进行优化。
面向数据构架(Data Oriented Architecture, DOA)为联运大数据的管理提出 了有效的解决思路。DOA 采用类似 SOA 的思想通过对数据文件中的元数据进行 统一管理注册，将分散在各个信息系统的碎片数据进行规范化和集中整合，从而 降低云端数据的计算，挖掘和使用复杂度，为信息的收集，整理，归类和检索提 供有效的数据组织方法[107,108]。
(2) 构建分布式大数据应用模型。分布式计算技术可以针对大数据的 4V 特 性，对多样化的联运业务数据进行分析。通过在联运大数据管理体系上，根据业 务需求建立基于分布式数据处理技术的大数据应用模型，对联运数据进行二次挖 掘，可以有效的提高业务决策效率和客户服务水平。

第 44 页

西南交通大学博士研究生学位论文

3.4 铁水联运云平台的系统构架设计 3.4.0 铁水联运云平台的构建模式
铁水联运云平台的本质，是联运信息化结合云计算和大数据技术的技术实现， 其构建应当打破孤立的“烟囱式”架构低效的信息管理体系，为云环境下的联运 应用提供统一的资源管理设施，并支持不同应用信息的有效整合与服务互用，以 及应用与业务之间的无缝集成与有效协作，最终实现以客户为中心的高质量服务 体系。
由于铁水联运行业的参与机构较多，不但专业性较强，而且行业特征也比较 明显，且具备半开放性的特征。结合 2.2.4 节云的构建模式和 3.2 节的构架设计 思路，大集中管理模式下的铁水联运云平台应采用以公有云为基础，行业云为核 心的的混合云模式进行构建，如图 3-4 所示

混合云 核心行业云

基础公有云

私有云

公共

服务

其他行业

机构

港铁共建 管理机构

运营团队

公共 服务
服公务共

第三方 物流平台

行业服务
行业 服务
行业 服务

联运经营人

中小型港口 和船公司等

私有云
铁路和 大型港口

货主

图 3-4 铁水联运云平台的构建模式
在以行业云为核心的构建模式下，铁水联运云平台的为参与者包括运营团队， 行业用户和外部用户三个角色，权限依次递减，受限于权限系统，只能获取权限 范围内的信息，同时信息具备主体以及供给主体能够为参与部门或者使用主体。 铁水联运云平台参考业务的具体需求以及状况，借助角色协调参与者所能获取的 服务。
由于目前联运信息化布局分散，无法在云端汇聚形成统一的管理体系，在进 行铁水联运云平台的构架设计之前，必须对图 3-4 的信息化布局进行重构。在充

西南交通大学博士研究生学位论文

第 45 页

分利用云平台集约化资源管理优势的基础上，实现软硬件资源的集中构建和应用

的统一迁移，形成高度集中的信息布局模式，如图 3-5 所示：

货主/联运经营人 铁路部门

船公司 政府机构(海关,国检等) 第三方机构

信息交互

数据交互

云机房1

铁水联运云平台
资源虚拟化 云机房2

资源管理 云机房N

通信设施
配套设施机房（供电、冷却等）

……

通信设施
配套设施机房（供电、冷却等）

通信设施
配套设施机房（供电、冷却等）

联运信息 系统迁移

信息共享

大型港口(自建私有云) 自有应用实例池

联运信息 系统迁移

系统租用 信息集成

中型港口

系统租用 信息集成
小型港口和货站

服务器资源池
通信设施 机房配套设施(供电、冷却等)

系统服务器 XVDI虚拟桌面 PC终端 PAD终端 手机终端

XVDI虚拟桌面 PC终端

PAD终端

手机终端

图 3-5 铁水云平台的大集中信息化模式
如图所示从信息布局看，基于云平台的管理模式打破了平台间相互独立的格 局，并采用虚拟化技术对计算资源进行重组和按需分配，将分散在各港口的联运 业务应用迁移到云端进行集约化管理并通过统一的入口进行对外服务，提供一站 式综合联运业务信息服务，同时也能利用云的应用服务模式有效针对用户与业务 需求快速定制个性化的资源或业务环境。由于我国港口数量众多，基于大集中信 息管理模式的云平台可以充分利用云的规模效应，大幅降低整个行业的信息化成 本，特别的对于众多的中小型港口，可以通过多种终端直接接入平台并使用云端 的计算资源，实现信息化建设零成本投入。
近年来，尽管铁水联运行业在信息化方面做了大量工作，大幅提高了铁水联 运信息化水平的提高发挥了很大的作用，但是这些研究大都基于传统的信息构架， 无法适应云环境下的应用构建与信息管理。同时在当前铁水联运业务不断扩展和 日趋多样化的情况下，现有的公有云体系由于未考虑行业自身的信息化特征，仍 然远不能满足业务发展的需要。因此，必须站在战略的高度，重视新型平台体系

第 46 页

西南交通大学博士研究生学位论文

的构建工作，设计灵活、可靠、安全、稳定并满足整个铁水联运行业需求的云平 台架构。
针对目前联运信息系统中存在的诸多问题，结合 3.2 节的构架设计思路，构 建面向大集中联运信息管理的云平台体系，本质上是利用云计算技术对整个平台 的服务模型，技术构架和运营模式进行构建，将云计算的资源管理模式与不同业 务、异构应用进行融合，从而有效的消除信息孤岛，并充分利用云的按需资源管 理特性提升应用交付效率。
3.4.1 铁水联运云平台的云服务栈设计
云平台的体系构架由云服务模式决定，根据 2.2.3 节可知，目前基础的云服 务模式有 IaaS，PaaS 和 SaaS 三种，目前只有设施层的 IaaS 和软件交互层的 SaaS 服务模式相对成熟，但 PaaS 无法满足联运信息优化的要求。作为一个面向行业 应用的综合信息服务体系，铁水联运云平台需要基于以上三种云服务模式进行服 务扩展，形成集软硬件设施管理、应用管理、信息集成和数据管理等服务为一体 的服务体系。结合其构架设计思路，按以下层次对云平台的服务模式进行设计：
(1) 资源层服务。在资源管理方面，IaaS 服务能通过操作系统虚拟化，实现 计算资源统一调度，包括服务器，存储和网络的资源分配，共享和管理，并提供 现有系统的迁移环境，但 IaaS 只能提供基于操作系统虚拟化的粗粒度管理，缺 乏对联运应用支持的灵活性，而传统的 PaaS 虽然提供了软件层面的高封装性， 但由于服务限制较多，缺乏可配置性和灵活性，也无法满足联运信息化发展的需 求。根据铁水联运的业务交互性和信息系统的异构特点，本文提出将轻量级的容 器及服务模式(Container as a Service, CaaS)引入到 IaaS 与 PaaS 服务层之间， 以容器作为联运应用的封装标准将应用标准化后进行调度管理，可以有效优化传 统 PaaS 的灵活性[109]。
(2) 业务层服务。通常情况下，业务应用与用户之间通过 SaaS 服务模式进 行交互，但由于联运信息服务大都属于信息集成服务，所以联运云平台在业务层 除 了 需 要 提 供 SaaS 服 务 之 外 也 需 要 提 供 软 件 集 成 即 服 务 模 式 (Software Integration as a Service, SIaaS)。
(3) 数据层服务。联运行业频繁的数据交换，会促进联运大数据沉淀和二次 利用，本文认为数据即服务(Data as a Service, DaaS)是行之有效的服务模式。 DaaS 将与数据相关的服务进行封装，如数据聚合、数据质量管理、数据清洗、 数据分析等，并以统一的接口将数据提供给不同的信息系统和用户消费，而无需 再考虑这些数据来自于哪些数据源[107,110]。
综上所述，设计铁水联运云平台的云服务栈与云服务模型关系如表 3-3 所示，

西南交通大学博士研究生学位论文

第 47 页

从 IaaS 到 DaaS 逐级推进。

表 3-3 铁水联运云平台的云服务栈

服务层次

服务模型 服务名称

资源类别

数据服务层 DaaS 业务服务层 SIaaS

Data as a Service

联运数据服务

Software Integration as a Service 联运信息集成服务

资源服务层

SaaS PaaS CaaS IaaS

Software as a Service Platform as a Service Container as a Service Infrastructure as a Service

联运信息系统租用服务 联运应用管理服务 容器编排服务 基础设施服务

3.4.2 铁水联运云平台的总体构架设计

根据 3.3 节铁水联运云平台的构架设计思路可知，与传统的纵向烟囱式联运 信息构架不同(如图 3-2)，云计算平台采用基于虚拟化的横向构架模式，对软硬 件资源进行解耦，有利于提高信息系统的计算资源利用率和调度灵活性，并降低 联运应用的运维成本。目前主流的云平台虽然实现了通用的设施虚拟化和应用管 理构架，并提供了相关的云服务模式，但是并未考虑铁水联运行业的信息化特征。 根据图 3-5，从技术构架角度看，铁水联运云平台是基于计算机、互联网、虚拟 化，以及分布式计算存储等技术所构成的一个可实现应用自动化管理、信息共享、 覆盖整个行业的新型联运信息平台，它同时面向联运管理部门，业务参与机构和 客户，提供高度集成的资源管理、应用服务交付，以及跨系统的数据融合服务， 需要满足以下三个基本特点：
(1) 按需资源分配。通过虚拟化技术对多个云机房的硬件资源进行池化，并 提供按需分配的资源调度，为多样化的异构联运应用实例提供自动化管理机制。
(2) 弹性信息共享。在虚拟化设施基础上，利用弹性资源管理和分布式计算 技术对传统的信息共享模型进行重构，实现联运业务信息的按需共享。
(3) 智能大数据处理。利用大数据管理与分析技术对碎片化联运业务数据进 行融合、分析和二次利用，提高业务决策能力和服务水平。
结合铁水联运行业的信息化特点，利用云计算技术对服务栈内的云服务进行 合并，形成横向的集成管理体系，本文提出了一个基于虚拟资源管理的分层融合 云 构 架 (Hierarchical Fusion Cloud Architecture Based-on Virtual Resource Management，HFCA)对铁水联运云平台进行构建。HFCA 在保证联运应用兼容 性和信息可集成性的同时，通过对资源进行分层解耦，独立管理，进一步提高了 信息资源的交付灵活性和可管理性，其总体构架如图 3-6 所示，自底向上分以下 三个支撑体系：
(1) 资源支撑体系(Resource Supprt System,RSS)。HFCA 将传统云平台的 IaaS 和 PaaS/CaaS 融合后形成 RSS，用于实现传统联运信息化建设模式向云平

第 48 页

西南交通大学博士研究生学位论文

台模式的转变，解决联运信息化布局分散，信息系统建设运营成本过高和结构僵 化等业务层问题。其中 IaaS 层采用虚拟化技术对基础软硬件设施进虚拟化，形 成集中的可共享的计算资源池；PaaS/CaaS 层在虚拟的池化资源之上，提供异构 化的联运信息系统一体化的应用管理体系。资源支撑体系通过基础设施虚拟化提 升 IT 资源整体利用率，并结合计算资源按需分配的机制，体现云计算“资源最 大化利用”的核心理念。
(2) 业务支撑体系(Business Supprt System,BSS)。HFCA 将传统云平台的 SaaS 层和 SIaaS 融合后形成 BSS，用于在资源支撑体系之上，构建业务应用池 和信息共享体系。其中业务应用池是根据目前的信息系统重构并迁移到资源支撑 体系以后形成，通过 SaaS 对外提供服务；信息共享体系采用与业务应用池兼容 的轻量级构架和弹性数据交换模型，面向联运参与机构，按需提供联运业务过程 中所需的信息资源共享服务。
(3) 数据支撑体系(Data Supprt System,DSS)。HFCA 采用 DSS 对结构化和 非结构化数据进行融合，解决联运业务和信息共享过程中带来的大数据管理和二 次利用问题。首先通过对数据进行分类整理和池化，进行 DOA 基础上的大数据 管理机制的构建，使数据信息能得到更加严格全面的管控，以解决联运大数据所 面临的软件体系结构问题；然后进一步利用强大的分布式计算和存储能力，在数 据管理体系之上构建多样性的联运大数据应用，发现联运大数据之间的潜在价值， 提升联运行业的决策支持和服务水平，并最终以 DaaS 服务实现联运大数据的集 约化管理，数据融合，资源挖掘和增值服务。
基于HFCA的联运云平台

数据支撑体系
(数据融合)

服务个性化

大数据应用 大数据管理 (DaaS服务) (DOA服务)

数据存储/抽取/分析

支持 决策
联运管理层

业务支撑体系
(信息融合)

货主

货运需求/ 货物跟踪
业务办理

联运经营人
业务协作

联运应用池 信息共享体系 (SaaS服务) (SIaaS服务)
系统部署/容错/伸缩

港口/铁路等 联运参与机构

一体化联运应用管理 (PaaS/CaaS服务)
动态资源分配/调度
基础设施资源池 (IaaS服务)

资源支撑体系
(资源融合)

设计/ 部署/ 个性化
云平台运维团队
操作/ 维护/ 管理
应用 提交/ 更新
应用供应商

图 3-6 基于 HFCA 的联运云平台总体构架

西南交通大学博士研究生学位论文

第 49 页

由上图可知，基于 HFCA 的构架体系之间相对依存，自下向上依次提供资 源服务，且可以独立的提供运服务，下面分别对这三个体系的构架进行详细设计。
3.4.3 资源支撑体系的构架设计

3.4.3.1 资源支撑体系的技术构架

由于目前主流的云平台大都只为用户提供单一的虚拟化介质作为应用管理

环境，其中基于虚拟机的 IaaS 服务管理效率比较低下，而对于开发部署环境被 完全封装的 PaaS 服务，只能支持有限的软件构架，无法适应异构化严重的联运 应用环境。根据铁水联运云平台的总体构架设计，资源支撑体系作为基础服务层，

对下层需要统筹管理服务器和网络设施等硬件资源，对上层需要管理异构化的联

运应用，其构架是否合理直接决定了云平台的软硬件资源和大量异构化业务应用

的管理效率。

针对单一的虚拟化方式在铁水联运信息化过程中所存在的问题，本文提出以

容器云为中心对传统的 IaaS 和 PaaS 构架进行重构，首先通过 IaaS 虚拟化技术将 分散多个数据中心的物理节点整合成一个巨型的虚拟资源池，并在其之上建立虚

拟集群环境，能够更充分合理利用各种资源，切实提升资源的使用率并降低其使

用成本；然后采用混合资源虚拟化对资源进行标准化和应用封装，并在其之上建

立统一的资源管理环境和调度机制，面向大量异构化的联运业务应用，提供跨区

域的持续集成和自动化运维，为业务层提供联运应用和数据基础设施服务。根据

上述分析，其技术构架设计如图 3-7 所示：

应用服务系统
管理控制台(Dashboard)

数据处理系统
运维管理层 (PaaS) 联运应用管理体系

遗留业务系统
镜像管理

智能弹性伸缩配置

系统持续集成配置

租户认证和配额管理

Multi-zone高可用管理

系统监控

日志分析

资源支撑体系

联运应用环境(PODs) 集群编排管理(Kubernetes)

核心层(CaaS) 联运大数据应用环境
数据任务管理(Chronos)

联运遗留系统迁移环境 (VM)

分布式统一任务调度(Mesos)

服务注册发现与引流（Consul,ZK,Etcd）

抽象运行环境(ARE)管理

Container-ARE 应用虚拟化(Docker,RunC…)

VM-ARE

其他ARE

基础设施 跨区域管理

虚拟主机节点管理(Host)

基础设施层(IaaS)

VM

VM

VM

VSwitch VSwitch 统一存

储系统 XVDI

硬件虚拟化(OpenStack)

(Ceph)

异地容灾云 (Multi-zone)

防火墙

云机房硬件设施(Hardware)

物理服务器

存储

网络设施

图 3-7 联运云平台的资源支撑体系构架

第 50 页

西南交通大学博士研究生学位论文

如图所示资源支撑体系主要分为三层，包括基础设施层、核心层和运维管理 层，下面分别对这三个层次进行详细说明。
(1) 基础设施层(Infrastructure Layer, IL):提供虚拟机服务，基于服务器虚 拟化技术对云机房硬件设施进行抽象后形成虚拟资源池，提供计算、存储、网络 和安全等按需分配的共享资源。
(2) 核心层(Core Layer, CL):为业务层提供统一的应用虚拟化服务，采用 标准镜像对联运应用和依赖进行封装，通过以容器云为核心的抽象运行环境 (Abstract Runtime Environment, ARE)对应用异构性进行屏蔽，隐藏软硬件虚拟 化的复杂性；并利用集群编排和分布式调度实现弹性的应用高可用、动态服务注 册、遗留系统无缝迁移、以及可配置的任务调度。CL 层对 IL 层进行封装后向上 提供通用的 IaaS/CaaS 服务。
(3) 运维管理层(Operation and Management Layer,OML): 提供应用管理 服务，通过统一的认证鉴权，资源配额，系统持续集成，容量伸缩和镜像管理等 服务接口，对业务层提供 IaaS 和 CaaS 相融合的 PaaS 服务。
从组件构成上看，IL 层采用成熟的 OpenStack 构建 IaaS 服务，将服务器硬 件虚拟化成虚拟机，实现基础设施的共享和按需分配；在 CL 层通过对 IaaS 计算 资源进一步抽象和标准化将计算资源划分为虚拟机(VM)和容器(Container)两种 ARE，以管理应用服务系统，数据处理系统和遗留业务系统这三类联运应用，其 中 Kubernetes 实现应用服务系统的编排管理，Chronos 实现数据处理系统的调度 管理，相关的资源分配和分布式任务调度由 Mesos 完成，对于无法容器化的遗 留业务系统，采用虚拟机封装，这三类系统均由 Consul 框架进行服务注册、发 现和消费; 在 OML 通过联运应用管理体系，持续集成，监控和鉴权组件，形成 满足联运应用需求的 PaaS 管理环境。
3.4.3.2 资源支撑体系的虚拟资源池
虚拟资源池是资源支撑体系对所管理资源的抽象，结合资源支撑体系的技术 构架设计，本文利用基础设施层和核心层分别对硬件资源和软件应用进行虚拟化， 最终形成虚拟机和容器相结合的混合资源池环境，以满足异构应用对资源的差异 化需求，如图 3-8 所示：

Container集群环境

西南交通大学博士研究生学位论文

第 51 页

容器资源池
Kubernetes Mesos 容器隔离环境
计算资源池 VM VM VM VM VM VM CPU IO RAM 虚拟化 虚拟化 虚拟化 虚拟机监视器(KVM)

基于混合虚拟化的一体化应用管理体系

存储资源池

网络资源池

镜像资源池

PV PV PV Aufs

Kube Vxlan

Mesos Vxlan

Overlay(Flanel) IPTables

Docker Docker Docker Image Image Image
LVS Docker Registry
Docker Hub

Block File Obj Block File Obj
Ceph Cinder

Vxlan Vxlan Vxlan VSwitch Neutron

VM VM VM Image Image Image
Glance

安全资源池 UACG
Docker Enhancer Kube=Auth
VFirewall IPS Cephx
KeyStone

VM集群环境

硬件

服务器

储存

网设

防火墙

图 3-8 资源支撑体系的虚拟资源池设计
如图对于虚拟资源池进行了详细的类别界定和划分，包括存储资源池、安全 资源池以及镜像资源池等六个部分，分别介绍如下：
(1) 计算资源池 计算资源池不但负责计算资源的配置共享，也为遗留的联运业务应用迁移提 供设施保障。其核心为 OpenStack 的 Nova 组件，其关键技术是以服务器虚拟化 为基础，借助于各种虚拟化技术使资源实现抽象化处理，合理配置和利用各种资 源，让 各种资源的优势作用得以充分全面发挥。通过虚拟硬件环境的建立，使 其能够和物理硬件区别开来，实现多种操作系统实例在统一硬件的兼容。 (2) 容器资源池 容器资源池基于 Docker 提供封装联运信息系统的封装标准和运行环境，并 将业务系统以标准容器镜像方式进行存储和使用，这些镜像在编排系统的调度下 形成容器云环境，提供比 VM 更适应用服务系统的轻量级云服务。 (3) 存储资源池 通过借助于存储资源池能够使得物理存储介质实现合理管控，在设备抽象化 的条件下进行数据块调度，设备所具有的逻辑属性得到保留的同时，而物理属性 不复存在，最终使存储系统能够实现统一化以及集中化的管理。 (4) 网络资源池 网络资源池是利用虚拟化技术形成的软件定义的网络交换架构，包括虚拟机 网络层和容器网络部分，能够使得网络布线等得以减少，更加严格的对于成本进 行管理和控制。虚拟网络的构建分为纵向网络切割和横向网络整合两种模式，不

第 52 页

西南交通大学博士研究生学位论文

仅需要支持内外网映射，管理层数据通信，应用系统数据交互，同时还要解决数 据抽取备份，容器迁移以及虚拟机等网络大流量数据信息的输送，还有各种租户 的带宽分配以及网络隔离难题。其中业务，数据，存储网络分离，以及租户之间 的隔离属于纵向网络切割模式；而应用系统之间的通信和配额属于横向网络整合 模式，网络资源池采用 Neutron 的 VxLAN 网络模式实现 IaaS 各功能网络分离， 采用 Mesos 和 Kuberntes 的 Overlay 网络实现租户网络隔离和应用系统之间的数 据通信。
(5) 安全资源池 安全资源池需要同时满足网络通信安全，计算资源安全和访问控制三方面需 求。在网络通信安全方面，进行虚拟防火墙的类别界定，使得物理防火墙设备实 现逻辑防火墙的转化，促进其优势作用的充分全面发挥；计算资源安全方面， Nova 采用 VMM 实现了同一物理机上虚拟机之间的资源隔离，Docker 采用 CGroup 命名空间实现了同一虚拟机上容器之间的资源隔离；而访问控制主要包 括虚拟机，编排系统和云存储等基础设施，以及应用系统的访问控制，其中云设 施的访问控制方案比较成熟，虚拟机的认证管理和访问控制通过 KeyStone 实现， 编排系统的访问控制由 Kube-Auth 负责，数据存储系统的安全由 Cephx 控制， 应用系统的访问控制采用统一的访问控制网关(Unified Access Control Gateway， UACG)模型实现，本文在 4.4.5 节对 UACG 的访问控制模型进行了详细研究。 (6) 镜像资源池 镜像池是用于存放虚拟机，组件和应用的镜像仓库。根据异构应用对环境的 需求分为虚拟机镜像池和容器镜像池两个部分，其中虚拟机镜像由 Glance 进行 管理，由 Cinder 负责存取；容器镜像分为公有镜像和私有镜像两种，公有镜像 仓库提供操作系统和公共服务组件的基础镜像，私有镜像仓库管理所有的应用镜 像。
3.4.3.3 资源支撑体系的冗余构架
随着软件系统的复杂性日益增大、分布式应用的广泛部署，使软件赖以运行 的环境越来越复杂，运行环境的可靠性必须通过资源的冗余实现。特别在云环境 下，由于需要管理大量的应用实例，冗余构架设计的合理性对提高应用服务的可 靠性至关重要，无论是由于软硬件出现故障导致应用无法访问，还是由于大量的 业务并发导致响应缓慢，都会影响到联运业务的正常进行。
目前的“烟囱式”构架大都采用基于硬件的服务器主备冗余构架，在出现故 障时通过路由切换可以在一定程度上解决系统的可用性问题。但是基于硬件的冗 余方式不但资源消耗大，也无法解决机房设施故障时的服务不可用问题，并且在

西南交通大学博士研究生学位论文

第 53 页

出现服务器性能瓶颈时，必须扩展硬件设施，无法在短时间内处理性能瓶颈，导 致服务质量下降[111,112]。即使在分布式环境下，单一机房甚至是单一区域的多机 房硬件设施冗余，也无法保证在不可抗力破坏下应用服务的可靠性。
为了保证应用的高可用性，需要建立多区域的冗余构架。 云平台所管理计算资源是软件所定义的虚拟化资源，这些虚拟资源在云端形 成一个有机整体与联运参与机构进行信息交互。与“烟囱式”系统的硬件冗余构 架不同，为了充分利用虚拟资源管理的灵活性，并进一步提高应用服务的可靠性 和容错性，本文提出将异地容灾中心引入铁水联运云平台的冗余机制，以避免不 可抗力对云机房的影响造成服务不可用。所以资源支撑体系的冗余构架需要同时 管理基于多个云机房的物理服务器集群构建的虚拟池化资源和异地容灾云的灾 备资源，设计如图 3-9 所示：

各大港口 信息中心

跨区域系统集成

数据双向异步同步 (数据冗余)
SDN容器网络

异地容灾云(备区域)
应急集群(最小化配置）
联运应用 虚拟云主机

公有云
冗余数据存储池

联运应用 虚拟云主机
虚拟机环境

(服务冗余)

高峰期 业务查询 请求分线

业务查询办理请求

铁水联运云平台(主区域)

服务高可用/负载均衡/分流

集群性能监控

联运应用池

参与机构/客户

EDI数据流

……

内部用户 主数据存储池

控制节点 物理机

SDN容器网络

数据节点 物理机

应用 镜像仓库

资源 支撑体系

NAT路由

虚拟机池

容器池

容器池

EDI数据流

主机房

备用机房

云管理

EDI数据流

……

……

管理部门

18个铁路局信息中心

海关 国检 银行

图 3-9 资源支撑体系的冗余构架
根据图所示，资源支撑体系的冗余构架分为主备两个逻辑区域，其中主区域 管理多机房互为主备模式，其中一个机房发生意外情况出现断电或者网络中断的 情况下保证服务可用性；备区域为异地冗余中心，一般为可靠性极高的商业云平 台(如阿里云)，在出现主区域故障或服务压力过大，导致服务不可用或请求响应

第 54 页

西南交通大学博士研究生学位论文

时间过长时，资源支撑体系可以在异地迅速的配置，启动或增加服务节点，同时 将主区域的请求进行分流重定向到备区域，以保证服务的高可用性。

3.4.3.4 基于资源支撑体系的信息交互模式

与目前港口以业务系统为单位的独立信息交互模式不同，由于虚拟资源池具

有资源按需分配、集中数据存储和传输的特性，资源支撑体系能更充分的利用虚

拟网络带宽，对不同类型的联运应用进行逻辑隔离，形成统一的云端信息交互模

式，并进一步降低信息的使用成本，如图 3-10 所示：

资源支撑体系

Rest Data
Response

SDN

容器集群

VM集群

桌面 渲染
XVDI

Request LBC
Gateway

Display Multiple Request Rendering

Input

个人终端 虚拟管理终端
图 3-10 资源支撑体系的信息交互模式
如图所示，云平台所管理的联运应用均部署在资源支撑体系之上，共享云所 有的虚拟机计算和存储资源。由于资源支撑体系采用软件定义的虚拟网络 (Software Defined Network-SDN)进行数据通信，在数据传输上采用服务器端虚 拟桌面渲染(XVDI)和 REST 数据协议等方式，其带宽利用率，安全性和数据传 输效率很大程度优于“烟囱式”架构下的信息交互模式[113,114]。
对于联运参与机构的管理人员，可以通过远程终端或者云管理器直接对资源 进行管理，相比客户桌面渲染方式带宽占用更少，安全性更高，维护成本更低； 对于联运客户，通过 REST 数据协议替代以页面为数据单位的交互方式，将请求 结果以多种方式在多种终端上面进行渲染，更具通用性和可扩展性，更适应随时

西南交通大学博士研究生学位论文

第 55 页

随地数据交互的需求[115]。

3.4.3.5 基于资源支撑体系的运维模式

资源支撑体系采用基于虚拟化技术的分层结构，消除了“烟囱式”系统构架

硬件基础设施与软件应用的直接耦合。传统的垂直运维模式无法适应水平分割的

虚拟资源管理模式，运维体系应转变为扁平化的维护模式[116,117]，如图 3-11 所示:

铁水联运云平台

业务应用池

软件 供应商1

软件 供应商2

……

软件 供应商N

监控

故障/预警

交付/运维 需求 交付/运维 需求

交付/运维 需求

云平台 故障

软件维护组

资源支撑体系

运维

硬件维护组

服服服服服服服服服服服服服服服

硬件

务务务务务务务务务务务务务务务

故障

器器器器器器器器器器器器器器器

存储设备 运维
网络设备

图 3-11 铁水联运云平台的扁平化运维模式
如图在扁平化运维模式下，硬件的维护由硬件维护组负责；而应用的交付， 故障预警修复，以及应用资源调整由软件维护组负责，并通过资源支撑体系集中 管理。在这样的模式下，各维护单位和人员的职责分工明确，具备集中监控、集 中资源调度、集中问题处理的能力，自动化程度高，能有效提高联运应用的运维 效率。

3.4.4 业务支撑体系的构架设计

3.4.4.1 业务支撑体系的功能资源池
根据铁水联运云平台的总体构架，业务支撑体系主要面向六大用户群：货主 /联运经营人、铁路、港口、船公司、一关两检等政府机构、以及集卡配送公司/ 保险银行三方机构提供应用信息服务[56]，这六大用户群与业务支撑体系之间的信 息需求关系，如图 3-12 所示:

第 56 页

西南交通大学博士研究生学位论文

铁路

船公司

计划实绩信息共享 客户订单处理 生产作业协同

计划实绩信息共享 客户订单处理 生产作业协同

货主/经营人

网上交易 全程货运信息服务
运输方案制定

铁水联运云平台
业务支撑体系

计划实绩信息共享 客户订单处理 生产作业协同

港口

一关两险 实时查询

网上保险、交易、 配送预定、实时查询

政府机构

集卡配送公司/保 险银行三方机构

图 3-12 业务支撑体系与用户群之间的信息需求
从功能需求上看，业务支撑体系需要在现有联运信息系统的基础上，对以下 业务进行优化：
(1) 构建以客户为中心的一站式联运服务。通过统一的联运电商平台为对于 货主和联运经营人提供服务，充分利用业务开展的时间，促进服务质量的全面提 升。进行货物托运前联运相关数据信息等的供给，开展网上支付以及相关信息查 询等相关的业务活动。
(2) 提升铁水联运信息的共享水平。铁水联运各方信息共享障碍，极大地制 约了铁水联运的发展，因此业务支撑体系的核心功能之一是实现分散信息的集中 和共享，提供全国范围所有港口的货主管理、运输规划、联运货代、联运经营人、 货品购置、运输、存储、港站业务、货车、财务资金、船舶情况等相关数据信息。 通过构建联运信息共享体系，实现铁水联运客体之间的信息共享与交互。
(3) 实现联运大数据的管理与分析。通过挖掘铁水联运大数据数据，对潜在 的价值进行二次利用，不但能提高铁水联运的业务效率和决策支持水平，也能为 联运客户提供更人性化，个性化的信息服务。
此外业务支撑体系还需要管理联运参与机构迁移到云平台的业务管理系统， 结合其业务需求，将业务支撑体系从功能上划分联运业务应用，第三方业务系统， 信息共享和大数据应用这四大资源池，如图 3-13 所示：

西南交通大学博士研究生学位论文

第 57 页

联运业务应用池

联运电子商务平台
综合信息咨询 订单合同管理 网上运输方案制定 网上订车订舱 网上支付 网上办理托运、理赔
货运流程管理系统 集装箱进口管理 集装箱出口管理 大宗散货进口管理 大宗散货出口管理
联运营销管理系统
联运产品管理 联运运价管理 客户管理 合作伙伴管理

联运业务管理系统
订单受理及审批 联运预确报信息管理 联运计划/调度管理 单证单据管理 资金结算管理 报关管理 仓储配送管理 联运物联设备管理
联运协同办公系统
工作流管理 收文/发文管理 公文监督和控制 日程安排 会议管理 政策法规

业务支撑体系功能资源池

第三方业务系统池
港口码头相关系统池
仓储管理系统 堆场集装箱管理系统 港站管理系统 船舶管理系统 港口列车管理系统 港口吊车管理系统
铁路相关信息系统池:
运输调度管理系统TDMS 货物运输管理系统FTMS 铁路行包管理信息系统 集装箱运输管理信息系统 车号自动识别系统ATIS 客运营销辅助决策系统PMDS 货运营销辅助决策系统FMDS

信息共享池
信息共享接口管理 集成单元管理(流程控制) 弹性数据交换 EDI报文规范管理

大数据应用池
联运DOA数据管理 数据分析系统管理 智能订单撮合 联运产品优化 产品营销优化 运力资源优化 运输市场分析 其他大数据应用

图 3-13 业务支撑体系的功能资源池
由上图所示，功能资源池的主要作用分别如下： (1) 联运业务应用池。主要包括联运业务相关的系统实例池，其中联运电商 平台面对客户提供信息查询，托运办理，货物跟踪等各运输作业环节的相关信息 服务；联运业务系统主要负责联运物流过程的计划，实施与管理；联运营销管理 系统主要负责联运产品和运价方面的标准制定；协同办公系统主要用于保障联运 管理部门进行正常的日常管理工作。 (2) 第三方业务系统池。主要由联运参与机构的业务系统构成，主要包括港 口和铁路部门与联运相关的业务系统。 (3) 信息共享池。主要负责异构应用集成和信息共享，面向联运参与机构的 需求，实现不同运输方式之间的业务协同与信息交互。 (4) 大数据应用池。主要负责联运业务数据的沉淀和集中管理，联运大数据 应用的构建和大数据分析。
3.4.4.2 业务支撑体系的系统构架
业务支撑体系的主要作用是目前分散的联运信息系统，在铁水联运云平台上 整合成一个有机整体，并按客户需求配置服务实例和使用权限后，以 SaaS 服务 模式交付给用户使用，其系统架构如图 3-14 所示：

第 58 页

西南交通大学博士研究生学位论文

客户群 货主

下单

货代

查询
船代
查询
理货
查询
联运经营人

安全框架 (UACG)
授权认证 服务
用户集成 管理
(LDAP)
SSL/VPN 管理
Https 服务

业务办理

订单物流信息

货物状态变更通知

联运云平台的业务支撑体系构架

统一服务门户(SaaS)

联运电子商务系统

货运流程管理系统

授权

内容门户

访问

系统

订单收集

联运产品 推荐系统

订单撮合 (经营人推荐/确认)

在线 支付系统
在线业务 办理系统
信息推送 系统

订单合同管理 订单流程管理 订单在途跟踪 订单数据更新

联运大数据应用(DaaS)

订单撮合 应用

联运运价 分析应用

联运产品 分析应用

运力优化

分析应用

……

应用管理与服务 数据管理与服务 数据资源池服务

大数据资源池服务 个性化数据服务

铁水联运业务应用池(SaaS)

办公信息管理子系统

铁水联运业务子系统

工作流管理 收文/发文管理 公文监督和控制 日程安排/会议管理/
政策法规

集装箱(车辆)管理市场需求及托运 货物信息记录/场站信息管理/货物 追踪/安全运输及运输质量管理/中 转作业管理/拼箱计划制定及计划存
储管理/确报管理

联运物联服务系统
集装箱RFID管理 集装箱安全管理 集装箱接收管/发送作业管理 在途物联数据采集

铁水联运决策子系统
联运产品优化 产品营销优化 运力资源优化 运输市场分析
合作伙伴 客户管理

信息共享池(SIaaS) 个性化信息交换服务

流程服务 集装箱进口 集装箱出口 大宗货物进口 大宗货物出口
过境运输

物流服务 保险/运输 代理/海关 检验/检疫
船箱货跟踪

交易市场 货源发布 运力发布 交易管理
信息查询

业务集成和流程服务管理(ITIU) (请车/订舱/支付/报关/报检)

信息发布子系统

联运通用服务池(SaaS)

商务业务处理子系统

货票信息整合子系统

权限管理子系统

动态数据管理子系统

办理点(代理人)管理子系统

拼箱计划的制定及计划存储管理 子系统

中转作业管理子系统

安全运输及运输质量管理子系统 ……

信息整合子系统

港口应用系统池(SaaS)

仓库管理系统

堆场装箱管理系统

岗站管理系统

船舶管理系统

港口列车管理系统

港口吊车管理系统

……

微服务管理 数据标准 代码标准
服务端点配置

EDI数据交换服务 报文标准/传输查询
报文制作/报文交换

基础设施服务 (审计/计费/日志跟踪/安全)

参与机构群 微服务数据总线

小型港口(无EDI中心)

堆场调度

码头作业管理

业务办理

其他部门

XVDI终端和移动设备

租用和管理(VPN网络)

小型港口(无EDI中心)

堆场调度

码头作业管理

业务办理

其他部门

XVDI终端和移动设备

大型港口(自有EDI中心)

港口EDI中心

码头作业管理

业务办理

堆场调度

多协议数据交换(VPN网络)

铁路部门

铁路EDI中心

运输调度 管理系统
TDMS

货物运输 管理系统
FTMS

铁路运输 管理信息系统
TMIS

联运第三方部门

海关

国检

海事 公路水路

区域物流中心
其他三方 监管部门

图 3-14 基于联运云服务的业务支撑体系构架
根据图 3-14，业务支撑体系的核心是统一服务门户，由联运电子商务系统 和货运流程管理系统构成；左侧为统一安全访问控制网关(UACG)；右边为联运 业务应用池、第三方应用池、信息共享池和相关数据应用接口。其中第三方应用 池为信息化程度不高的小型港口，以租赁方式快速提供完善的港站、码头和堆场 相关的管理信息服务，实现信息投入零成本；而信息共享池用于实现与铁路，大 型港口，政府机构等私有云上的业务应用，以及其他第三方应用之间的数据交换。
货物运输流程以订单驱动方式进行管理，一方面对客户提供一致的服务接口， 另一方面铁路和港口等参与机构的业务系统作为流程节点形成总线结构，而铁水 联运云平台仅需掌握宏观流程，而把具体的业务逻辑进行封装和租用，使物流过 程的管理变得简单、通用和高效。
3.4.4.3 业务支撑体系的应用重构策略
由于云环境下的 IT 应用构架与“烟囱式”IT 构架有很大不同，只有符合云 原生应用(Cloud Native Application，CNA)的 IT 构架才能充分利用云计算弹性 和灵活性[118,119]，其优势对比如表 3-4 所示：
表 3-4 CNA 构架在云环境下的优势对比

西南交通大学博士研究生学位论文

第 59 页

对比指标

烟囱式应用

CNA 应用

扩展方式

垂直扩展；硬件定义可靠 水平扩展；应用设计消除对基础设施的依

性

赖性

虚拟化环境

虚拟化(虚拟机)

轻量级运行环境(容器)

构架方式

三层构架，有状态，紧耦 扁平构架，无状态，API 松耦合 合

环境依赖

虚拟机操作系统依赖

抽象于虚拟机，操作系统无关

控制方式

人工控制(管理员)

系统控制(自动扩展，自动配置，自动恢复)

由表 3-4 可以看出，虽然 CNA 应用在云环境下具备更好的指标特性，但在 调研过程中我们发现，联运行业整体信息化技术相对落后，业务应用重构代价很 大，所以应用迁移过程必须对重构成本和效果进行权衡。根据业务支撑体系的功 能池构成，设计联运应用的重构迁移策略如下:
(1) 完全重构联运业务应用池和信息共享池。这两类应用目前由港口自建和 管理，属于服务型系统。其中联运业务应用池内的应用体系不完善且缺乏统一的 标准，由于面向客户和联运参与方，灵活性要求高，弹性需求大，更新迭代速度 较快，“烟囱式”构架无法很好支持；而信息共享池的应用(如 EDI,ESB 等)是联 运业务的核心，虽然有了比较成熟的商业产品，但是由于其结构笨重，无法适应 云环境。这两类应用应该在重构并形成 CNA 构架后，迁移到资源支撑体系的容 器运行环境，提供灵活可靠的高质量服务。
(2) 部分重构第三方业务应用池。这类应用属于企业管理系统，由联运参与 机构各自管理，成熟度较高但结构比较封闭，且语言环境不一致(如 C,Delphi,VC 等)，异构特征明显，同时由于成本，技术复杂性等因素，重构难度较大，周期 较长。其中港口相关的应用对弹性要求不高，无需对构架进行重新设计，应该在 最大限度保留现有应用构架的基础上发挥规模经济效益，比较适合进行业务重构， 即通过将大型港口的应用标准化并迁移到资源支撑体系的虚拟机环境，以资源最 小成本的租用方式为中小型港口提供服务；而铁路相关应用由铁路部门自己运营， 没有共享需求，只需通过应用集成方式实现联运业务过程中的信息共享；
(3) 采用 CNA 构架构建大数据应用池。大数据应用池内的应用是全新的应 用，可以直接在采用 CNA 构架在资源支撑体系上进行构建。联运大数据应用是 面向联运数据而非用户，其本质是一个 IPO 系统，比较合理的方式是将处理任 务容器化以后进行封装，并在资源支撑体系的容器环境下，按照大数据分析模型， 进行输入数据组织，任务调度以及输出数据管理。

3.4.4.4 业务支撑体系的 SaaS 服务模式设计

第 60 页

西南交通大学博士研究生学位论文

与传统的软件交付方式不同，业务支撑体系的联运应用不是按系统，而是以 SaaS 服务的方式交付给用户使用，需要根据用户自身需求和业务覆盖范围的不 同进行设计。SaaS 的服务水平由成熟度模型进行定义，目前服务成熟度从低到 高，可以分为以下四个等级[120,121]：
(1) 特定的/定制的(Level-1)。在这种水平下，软件通过软件供应主体进行 供给，各种消费者具备相应的主机应用的定制版本，借助于虚拟机进行应用实例 的运行。
(2) 可配置性(Level-2)。软件供应主体的消费者进行应用实例主机服务的 供给。对于 Level-1 基本情况来看，所有的实例均为对于使用者依次建立的，相 对的，在 Level-2 当中，全部应用实例均借助于一致的代码开展，使得消费者的 基本需求得到充分的迎合和满足。
(3) 可配置性与多用户效率(Level-3)。软件供应主体通过特定的实例使得 客户的基本需求得到满足，同时，借助于元数据使得使用主体获得相应的特性集 等。在最终用户的层面来说，并不能够意识到特定应用实例和不同用户进行共享。
(4) 可配置性、可扩展性以及多用户效率。软件的供应主体在服务集群当中 向各国客户进行相应服务的供给，然而，不同数据信息当中存在隔离，在这种情 况下，其具有的可扩展性极为理想，能够使得客户的基本需求得到充分全面的满 足，不管用户的数量怎样，均可以根据实际情况以及实际需要开展应用改进和完 善工作。
理论上在联运应用构架允许的情况下，应该优先选择成熟度高的 SaaS 服务 模式，在以上四个成熟度中，Level-1 跟目前的信息交付方式没有本质区别，服 务质量较低，若将目前的联运应用直接采用虚拟机封装方式，直接迁移到联运云 平台而不进行任何重构，则为 Level-1 服务成熟度；而 Level-3 与 Level-4 对用 户来说没有本质区别，其主要差别是 Level-3 的应用服务是单节点模式，而 Level-4 是集群模式，Level-3 无法解决服务高可用问题，所以在商业环境下也有 局限性，不适合作为 SaaS 服务。
结合业务支撑体系的功能资源池和系统构架，对其 SaaS 模型设计如下： (1) 第三方业务系统池内，无法重构的遗留应用采用 Level-1 服务模式；可 以重构的第三方遗留应用，属于多实例模式，由于可以在标准化以后进行迁移， 适合采用 Level-2 服务模式。 (2) 业务应用池和信息共享池内的应用，属于单实例共享模式的 CNA 应用， 适合采用 Level-4 服务模式。
3.4.5 数据支撑体系的构架设计

西南交通大学博士研究生学位论文

第 61 页

我国以港口为中心的铁水联运信息化建设，导致大量的联运业务数据分散在 港口形成数据孤岛，数据差异化较大，规模较小。由于整个行业的信息化建设相 对滞后，目前大多数相关信息平台还处在业务和数据整合阶段，同时受到计算资 源，分析方法和数据规模的限制，数据尚未形成体系。由于缺乏足够的方法和数 据，目前联运业务方面的数据分析基本上是侧重于港口小规模数据的固定维度统 计，数据资源和潜在知识还远未被充分的挖掘，也鲜有关于我国联运大数据方面 的相关研究文献，但是在大部制管理模式下，随着系统管理和信息的进一步整合， 联运大数据作为进一步提高联运物流效率、降低运输成本，更好满足客户服务要 求的关键，势必会成为下一个行业研究热点[122]。
根据 2.3.2.3 节，铁水联运的业务数据规模和种类在云环境下的迅速增长， 也为联运大数据分析提出了更加迫切的需求。由于联运大数据的 4V 特征，所以 传统的基于数据库和数据仓库的信息研究不管是其处理的基本手段，还是算法方 面，均难以满足联运大数据信息处理的基本需求，主要体现在以下四个方面：
(1) 大数据关注整体数据，而传统方式关注个体或随机数据； (2) 大数据处理是模糊性处理过程，而传统方式是精确性分析； (3) 大数据分析的是相关关系，而传统方式分析是因果关系； (4) 大数据分析要求在有限的时间窗口内收集，存储和分析数据并得到结果， 而传统方式只处理离线数据和统计结果。
3.4.5.1 联运大数据的应用需求分析
通过对业务支撑体系的功能资源池进行分析可知，联运大数据应用主要包括 客户个性化服务、联运业务优化和战略决策几个方面，是集体智慧(Collective Intelligence，CI)在联运信息服务中的智能化体现。CI 是指从大量人群的行为和 数据中获取结果，协助主体针对整个人群得到统计意义上的结论，这些结论在单 个个体上无法得到，它往往是某种趋势或者人群中共性的部分[123]。
联运大数据是特指在铁水联运行业内产生的大数据。与其他行业不同，由于 铁水联运行业的数据来源于多个参与机构，具备多样性和差异性特征，这些宝贵 的联运数据资源对于铁水联运业务的预测和控制、联运产品研究以及联运服务个 性化的研究都有着巨大价值，但目前对这些大数据的管理和分析还是一片空白。 大数据分析没有通用的模型和算法，必须根据应用场景进行模型和算法的构建， 其主要包括联运大数据的来源和应用需求两方面。其中铁水联运行业的大数据来 源，主要包括以下几个方面：
(1)联运电子商务平台，联运线上业务和联运客户(包括货主/联运经营人/ 货代等);
(2)铁路部门各内陆站;

第 62 页

西南交通大学博士研究生学位论文

(3)各大港口，码头，船公司等; (4)国检，海关政府相关部门; (5)保险，银行金融相关部门; (6)互联网和其他行业领域。 在应用需求方面，根据业务支撑体系的应用池构成，联运大数据分析的应用 场景主要集中在铁水联运营销管理相关的业务中，主要包含“联运电子商务”、 “铁水联运市场预测分析”、“铁水联运产品设计与开发”、“铁水联运运价管理”、 “铁水联运财务和支付管理”五个方面，下面分别进行分析[124]。 (1) 联运电商平台面对各大用户群体，通过该方面的大数据分析可以更好地 对联运客户提供更高质量的个性化商务服务，主要包括以下大数据应用： (a) 个性化业务推荐，将铁水联运业务大数据和用户大数据进行融合分析， 挖掘适用于客户和联运经营人的联运服务，这将使整个联运过程更加具有针对性， 有助于降低整个联运生态圈的业务费用和周期及提升业务效果，实现以“客户为 中心”的服务模型。 (b) 运输组织辅助优化，将客户的个人特征信息、货物相关数据和经营人数 据与运输组织模型相结合，对目前的货运路线进行进一步优化，最终确定适用于 特定客户和联运经营人的最佳运输方案。 (c) 联运数据挖掘和可视化，提升了联运数据及过程的透明度，其一,可以 促进联运业务流程的优化，降低联运成本的同时提升联运服务的质量；其二,货 主和联运经营人之间在业务行为上更为透明，可有效缓解业务矛盾并减少业务纠 纷的发生。 (d) 联运过程实时监控，通过各类物联网传感设备对客户货物进行远程监控 并记录相关数据，通过对大数据的收集及分析可以帮助联运管理者制定针对不同 客户的服务措施。 (2) 在铁水联运市场预测分析方面，有以下几个主要维度的大数据应用，这 类大数据的充分利用将更合理的分析和预测联运市场运作状况，合理的调配联运 资源： (a) 按地域类别对铁水联运的需求量进行预测分析； (b) 按地域类别对铁水联运的各个品类需求进行预测分析； (c) 按集装箱种类，各地域集装箱各种类使用数量进行预测分析； (d) 对物流服务的需求进行预测分析； (e) 按铁水联运产品别，对运输价格进行弹性分析； (f) 提供多维度铁水联运市场预测统计分析报告，以供管理层进行市场分析 决策；

西南交通大学博士研究生学位论文

第 63 页

(3) 对铁水联运运价管理来说，通过大数据分析可以更好地对铁水联运服务 进行定价指导：
(a) 对联运设备折旧、维修费用进行分析，； (b) 对不同区域和运输方式的运输成本进行动态统计分析； (c) 对联运服务成本和定价进行分析； (d) 对运输工作人员的工资待遇进行分析； (e) 按地区别，联运产品进行需求分析，以及按品类别铁水联运进行需求分 析； (f) 对主要竞争对手影响进行分析； (g) 对各铁水联运产品的价格弹性进行分析； (4) 对铁水联运产品开发与设计来说，通过大数据分析可以更好地对新型联 运产品的开发和设计进行有效的指导： (a) 对不同地域用户铁水联运需求信息进行采集和统计； (b) 按地域别，对铁水联运货运进行优势分析； (c) 按地域别，对各种铁水联运产品需求进行预测分析； (d) 通过统计分析，对比其它运输方式与铁水联运在长途路线运输上的优劣 势； (e) 铁路主要通道路通过能力及其适合的铁水联运产品析； (f) 按地域别和运输物品种类设计铁水联运产品，通过预测建模，在新业务 的研发阶段，可以通过数据建模和分析，确定最有效率的投入产出比，从而配备 最佳资源组合，确定铁水联运新产品试销的时间、地点、对象、策略，可以降低 铁水联运的研发成本并更快的得到回报。 (5) 对铁水联运财务和支付管理系统来说，通过大数据分析可以更好地对型 联运财务状况进行有效的分析： (a) 对联运管理部门的资金运作状况进行分析； (b) 预测铁水联运业务的财务收益和风险； (c) 对业务盈亏进行分析，预测业务风险，以及收入盈亏决策管理； (d) 对客户支付，违约赔偿数据和资金池进行数据健康状况分析，对沉淀资 金进行二次开发利用，也可以更好地对联运服务进行定价。
3.4.5.2 数据支撑体系的技术构架
数据支撑体系主要用于实现联运大数据的管理与二次利用，为保证数据管理 的灵活性和可扩展性，数据的管理与应用相互独立。数据支撑体系首先对所有的 联运业务数据进行沉淀和分类整理存储，使碎片化的业务数据形成数据资源池， 然后通过联运大数据应用对这些沉淀的数据进行挖掘，并将结果以数据及服务

第 64 页

西南交通大学博士研究生学位论文

(DaaS)模式交付给业务支撑体系的应用进行消费。这些大数据应用一方面可以 反作用于产生数据的联运应用，对业务本身进行优化；另一方面也可以提升用户 体验和服务质量，对联运参与机构以及其他行业的管理者提供有价值的增值数据 服务，从而提升整个平台的核心价值[90]。
根据铁水联运云平台的构建思路和总体构架设计，数据支撑体系基于 DOA 进行构建，不但能高效的检索和处理联运大数据，也能有效解耦数据的管理与应 用需求，为铁水联运的用户和管理者提供灵活的数据服务，其技术构架设计如图 3-15 所示：

通用客户端(GC)

货主

联运经营人

联运管理部门

港口

码头

国检

保险

银行

PSV

……

终端适配器(PC,MOBI,PAD,XVDI……)

协议适配器(HTTP,REST,TCP/IP……)

数据支撑体系
系统访问 系统响应

数据响应 数据访问

业务应用池
联运电子 商务系统

DOA数据管理中心

DaaS服务中心(DSC)

IOMS数据应用单元(IOMS DAU)

DFU

DSU

DVU

DCU

DPU

……

行业数据应用单元(ITDAU)

DFU

DSU

DVU

DCU

DPU

……

行业数据应用单元(ITDAU)

DFU

DSU

DVU

DCU

DPU

……

行业数据应用单元(ITDAU)

DFU

DSU

DVU

DCU

DPU

……

……

货运流程 管理系统

数据异常控制中心(DEC)

数据维护

数据 自适应

异常探测 冲突发现

冗余处理

负载均衡

数据巡检

数据同步 ……

数据访问控制中心(DAC)

数据安全

数据访问

属性定义

权限定义

用户权限 认证

数据授权

数据计费

数据加密

应用授权 ……

存储端(S-Point)

联运业务 管理系统 池

数据读取

数据服务(Xstorage,MyCat,XEDI)

数据驱动层

数据存储 数据驱动

数据适配

数据转换

数据注册中心(DRC)

数据注册

C端和S端接口管理(Etcd,Consul)

数据源层 数据定位

数据查询

数据注册

数据分类

联运营销 数据注册 数据源层

管理系统

RDS

DFS

池

NoSQL

元数据层

元数据存储

DTS

元数据 访问

元数据 检索

元数据 发布

元数据 存储

数据抽取 数据存储 数据注册

第三方业 务系统池

大数据分析中心
联运大数据应用池 联运定单撮合应用(ITDPU)

联运运价优化应用(ITDPU)

联运市场预测应用(ITDPU)

信息共享 池

联运运输优化应用(ITDPU)

日志抽取 大数据基础设施服务

Spark

Hbase

Hive

联运产品优化应用(ITDPU)

Sqoop

Flume

MangoDB

其他联运大数据应用(ITDPU)

MySql

HDFS

Chronos

资源支撑体系
图 3-15 数据支撑体系构架
如图所示，数据支撑体系由客户端和云服务端构成，客户端通过的数据和协 议适配器实现用户与数据支撑体系的数据交互；云服务端主要包括三个组成部分: (1)DOA 数据管理中心、(2)业务支撑体系的业务应用池、(3)大数据分析中心，

西南交通大学博士研究生学位论文

第 65 页

分别对应联运大数据的注册管理，产生和分析过程，作用分别如下： (1) DOA 数据管理中心。由数据存储端(S-Point)和数据注册中心(DRC)构
成，其中数据存储端采用行业云的分布式存储系统实现应用数据的统一存储管理； 数据注册中心则通过数据注册，客户端动态数据聚合等技术对客户端和服务端所 沉淀的数据进行统一管理和操作，数据根据需要在 DOA 管理中心生产元数据文 档并保存在注册中心的元数据库中，当联运大数据应用需要加载异构的海量数据 进行分析时，DOA 数据管理中心根据请求检索需要加载数据的元数据信息并返 回给大数据应用，大数据应用系统从元数据中解析数据源的位置和访问接口等相 关信息并获取相关的数据服务。大数据应用的数据分析结果也会存储到数据管理 中心并形成相应的数据即服务(DaaS)，以供用户和联运业务应用使用。
(2) 业务应用池。业务支撑体系的业务应用池不但能保障铁水联运业务的正 常开展，从数据角度看，也是多样化联运大数据的生产者，这些数据在数据支撑 体系中集中存储和管理，并按云服务模式进行隔离，按需求提供给联运大数据应 用使用。
(3) 大数据分析中心。分析中心由联运大数据应用池和大数据基础设施服务 池构成，其中大数据应用池是联运数据处理单元(ITDPU)的集合(详见 4.3 节)， 这些处理单元之间相互独立，并根据应用需求进行设计和部署。ITDPU 向 DOA 申请并抽取数据，然后将数据加载到 ITDPU 中在进行数据分析，最后将结果返 回 DOA 管理中心，以 DaaS 方式提供给业务应用和行业用户使用。
数据支撑体系的三个组成部分之间相互配合，形成联运大数据从产生，存储， 管理，到抽取，分析，反馈，服务的闭环生态系统。
3.4.6 铁水联运云平台的运营模式
除了技术构架设计，铁水联运云平台的落地应用和推广还需要制定合理的运 营模式。运营模式设计的本质是利用云服务的按需租用代替传统的系统软硬件购 买，帮助云平台管理部门和用户有效降低成本并实现快速盈利。结合 3.4.2 节和 3.4.3 节对服务模式和技术构架相关研究，设计铁水联运云平台的运营模式如图 3-16 所示；

第 66 页

西南交通大学博士研究生学位论文

货主、货代
服务 消费
服务 需求
数据服务 (DaaS)

港口 信息发布服务

铁水联运用户群

铁路

船公司

政府机构

服务消费

服务个性化

联运信息增值服务层

授权使用服务 系统集成服务

第三方机构 数据服务

数据支撑

业务支撑

联运云平台服务资源层

系统集成服务 应用系统租用 应用管理服务

(SIaaS)

（SaaS)

(PaaS）

计算资源租用 (IaaS & CaaS)

基础设施运维和服务管理
铁水联运管理部门

应用系统部署运维
铁水联运软件系统供应商

图 3-16 铁水联运云平台的运营模式
由上图可知，联运云平台的运营主要包括服务资源层和信息增值服务层两个 部分。服务资源层内的计算资源和应用系统由联运管理部门和联运软件供应商共 同运维和管理，并以云服务的方式提供给用户使用，其中云平台采用基于资源支 撑体系的扁平化运维模式(参详见 3.4.3.5 节)，而业务相关的应用系统开发、部 署和服务交付等工作由一体化联运应用管理体系完成(详见 4.4 节)；此外,在信 息增值服务层根据不同用户的服务需求、使用方式和环境差异，以服务资源层提 供的云服务为基础进行扩展并形成一系列增值服务，可以通过制定差异化的付费 标准，有效的为用户提供个性化信息服务，主要包含以下几类：
(1) 信息发布服务。用户可订阅所需的信息数据(例如货运电商平台的供需 信息)，系统通过数据接口向用户移动或固定终端发送自定义数据，或用户发送 服务请求，发布全局系统信息等。
(2) 授权使用服务。用于实现业务应用的数据安全控制，并对不同级别、不 同种类用户分配权限，使用户便捷的使用相关业务系统的租用和访问服务(详见 4.2.5 节)。
(3) 系统集成服务。根据用户需求将业务信息集成到用户自身的业务系统中， 或根据用户需求灵活的定制个性化信息共享模型(详见 5.2 节)。
(4) 数据服务。联运云平台通过合同协议、年费、会员费的方式向用户提供 有偿数据服务，同时向信息采集单位如铁路、港口、政府机构等部门，按数据流 量或数据类型支付使用费，以确保业务各方能积极参与铁水联运运营(数据交换 和计费模块设计详见 5.3 节)。

3.5 云环境下的铁水联运信息流优化

3.5.1 现有铁水联运流程存在问题

西南交通大学博士研究生学位论文

第 67 页

我国海岸线主要集中在东南部地区，沿海港口分布密集，发展迅速。铁水联 运业务相对发达，根据地理位置的不同，主要分为由西向东的出口业务，自东向 西的进口业务。这两种主要业务流程，几乎覆盖了联运的所有关键环节，已有学 者进行了深入的研究。在运输组织方面，姜小丽在论文《青岛港集装箱铁海联运 研究》中利用灰色模型对青岛港的集装箱运量进行了预测，黄浚源在论文《海铁 联运合理运距及运输组织优化研究》中采用关键线路法和整数规划对海铁联运的 进出口衔接时间和运输组织模型进行了优化，杜亮在论文《基于铁海联运的“北 粮南运”路径优化研究》中建立线性规划模型对粮食铁海联运的路径进行了优化 [125-127]。而联运信息平台的构建，则需要基于运输组织过程对业务信息进一步抽 取，韩佳睿在论文《铁水联运信息平台分析与设计》和郝楩楠在论文《基于 ESB 的铁水联运信息交换平台研究》中，也对货物的进/出口业务流程和交换信息进 行了详细的梳理[128][129] 。这些研究为云环境下的货运流程管理系统的构建奠定了 基础，但目前主要还存在以下两个问题有待解决：
(1) 服务质量差，智能化程度低。目前的联运业务研究和系统建设，主要还 是以联运参与机构而不是以客户为中心，重心在联运物流过程，而未对完整的商 务过程进行整合，导致目前的铁水联运信息平台无法实现以客户为中心的一站式 线上服务；缺乏数据决策对联运商务过程的支持，客户往往只能靠经验进行业务 办理，缺乏科学依据。
(2) 虽然对货运业务和数据信息流进行了梳理，打通了货运物流过程中的关 键环节，但共享信息相对比较分散，导致线下业务环节较多，并发程度低，没有 统一的物流信息载体，也对管理流程的设计造成阻碍。
3.5.2 货运流程优化思路
针对问题(1)，本文认为货运流程应该被联运云平台集中整合而不是分散在 各港口，根据业务支撑体系的构架设计，以联运云平台为中心为用户提供一站式 联运信息服务，联运参与机构以租用方式参与联运流程，同时结合大数据应用优 化全局业务并提升用户服务水平。
针对问题(2)，本文认为首先应该以全程联运运单为基础，对信息进行规范 化和电子化,是实现信息流程优化的有效手段。通过全程运单与电子数据交换等 技术手段相结合，可以实现内部单证信息以及船舶、班列、货流、单证、箱号等 数据共享，不但能保证不同运输方式业务层面上的无缝衔接，也能简化货运过程 中的联票据处理过程，减少数据的重复录入；其次以联运云平台为中心，建立中 介交易过程，能有效提升用户的服务质量，同时保证联运各方的利益。
根据业务支撑体系的构架设计，联运业务主要由联运电子商务系统和货运流

第 68 页

西南交通大学博士研究生学位论文

程管理系统负责。其中联运电子商务系统是由联运经营人向货主提供的，全程在 线的 C2C 货运商务服务平台。联运经营人作为商家在联运参与机构的配合下提 供联运信息服务，货主作为买家通过统一的端口实现在线货运业务申请，合同管 理，跟踪，支付等服务。货运流程管理系统(Freight Process Management System， FPMS)采用基于订单驱动(Order Driven Model, ODM)的工作流管理模式实现 联运物流业务的流程管理。
本文在现有文献联运业务流程研究的基础上，对业务信息进行重新整理，提 出了以全程运单为信息载体，以 FPMS 为业务中枢的“双流合一”的联运信息流 程。托运订单被联运电商平台进行收集后，均交由 FPMS 进行流程管理和信息集 成，从宏观上看整个业务过程分为以下四个阶段：
(1) 订单需求提交阶段：货主在通过认证和授权以后，将自己的货物托运需 求提交给联运电商平台，对订单需求进行收集整理后传递给货运流程管理系统。
(2) 订单撮合阶段：货运流程管理系统从电商平台获取订单需求批量数据后， 采用订单撮合大数据应用对需求进行自动分配，撮合系统对订单进行信息过滤， 数据标准化和特征向量提取，然后从平台业务系统或远程信息系统中提取铁水联 运代理人，铁路和港口相关信息进行分析，并与订单和客户个人特征进行匹配， 计算出最优的目标经营人并推荐给货主。货主确认联运经营人后，进入下一阶段。
(3) 物流业务管理阶段：货主确认并签订相关合同后，联运经营人按照合同 要求制定运输计划，联系车代和船代方进行订车和订舱，同时也会联系海关国检 等第三方机构在线办理相关业务，并将物品状态信息通过接口反馈给联运电商平 台，以供货主对订单状态进行实时跟踪，直到货物配送完成。
(4) 物流事务管理阶段：完成在线支付确认、服务反馈、争端仲裁以及服务 评估等业务，最后根据物流业务完成情况更新流程相关统计数据，为后续决策分 析提供数据支持。
结合 2.1.1 节对铁水联运业务分类的分析，下面分别以目前最具代表性的集 装箱进出口为例对铁水联运作业信息流程进行重构。
3.5.3 基于 FPMS 的集装箱出口信息流设计
以 FPMS 为中心的联运出口流程如 3-16 所示，整个出口信息流程的设计以 上述四个阶段和双流合一的理念为基础，包括货运商务和货物运输过程两大部分， 货运商务过程采用 FPMS 中介担保交易模式，主要分为以下四个环节：
(1) 需求提交：货主向联运电商平台提交货物运输需求，验证后生成货运订 单。电子商务平台将收集到的订单需求，以批量方式提交给 FPMS 进行处理。
(2) 订单撮合：FPMS 对订单进行自动撮合，货主根据推荐结果选择满意度

西南交通大学博士研究生学位论文

第 69 页

最高的联运经营人，FPMS 根据货主选择结果，通知相关经营人，确定承运关系。 FPMS 根据订单信息，生成对应的全程联运运单，联运经营人根据订单制定运输 计划，并通过 FPMS 通知货主和相关货代。
(3) 合同签订：货主确认运输方案后，FPMS 与联运经营人、铁路、港口、 船公司、码头、场站、理货等参与方签订电子运输合同，同时与保险公司签订电 子保险合同，并与订单进行关联。合同签订后货主向 FPMS 支付货运预付款。
(4) 支付确认：收货人确认收货以后，FPMS 将全程运输明细发送给货主， 并告知货主进行支付确认。FPMS 根据运输合同结算费用给联运经营人和参与机 构，货物出口运输结束。
货物运输流程与目前流程大致相同，主要分为以下九个环节[129]： (1)托运办理:联运经营人根据 FPMS 分配给自己的货运订单需求,集中一定 规模的集装箱数目后,统一向铁路和水运部门提出运输申请，并对货主提供集装 箱租赁服务。主要实现信息的沟通和交流:货物装箱信息以及货物托运单信息。 (2)请车订舱:运营主体接受订单的情况下，根据相关要求进行货物的发出， 在这个过程当中及时进行申请的递交。所有的部门同样因地制宜的开展相关工作， 就像进行收货信息的确定等。 (3)理货装货:职能部门对于请车申请完成批准的情况下，运营主体参考 FPMS 回执单的相关规定，积极开展装货工作。需要进行沟通和交流的信息包括 联运提货单以及铁路请车回执单。 (4)铁路运输:联运经营人将货物运输到货场，铁路部门开展计量以及査验, 工作，不存在异常情况就发车。铁路部门与到货站、水运港口进行提前沟通，好 让后者了解到货物以及运输计划的状况，同时持续监控列车以及货物的情况，若 发现异常情况，基于 FPMS 与联运经营人和水运部门进行沟通。多方需要了解的 信息如下:货票的详细信息、实时过站的详细数据、列车编组的详细信息、详细 的计量数据、查验作业的详细信息、预确报的详细信息。 (5)到港货物中转:港口充分分析到站和货物的详细信息,同时依据联运经营 人所提供的预订舱信息,做好卸车作业计划，对倒箱作业进行压缩。码头通过 FPMS 把卸车清单发送给港口站，港口站通过 FPMS 把卸车计划发送给码头，联 运经营人通过 FPMS 把发箱申请发送给港口站，港口站通过 FPMS 把发箱指令 发送给码头。多方需要了解的详细信息:到站确报的详细信息、船期计划的详细 信息、列车编组的详细信息、货物的详细信息。 (6)报关检查:货物到达港口，完成理货后亦或是同时基于 FPMS 发送报关申 请给一关两检部门，海关检疫部门使用 FPMS 向联运承办人以及港口传送必要的 数据，允许进行装船。多方需要了解的详细信息:理货证明报文数据、货代报检

第 70 页

西南交通大学博士研究生学位论文

以及报关单、检查放行的详细数据。 (7)出口准备:联运经营人参考公开的船期计划,充分考虑货物的状况，基于
FPMS 和船公司申请订舱,船公司参考自身船只装载计划做出决策。联运承办人 向港口和码头反馈订舱结果以及信息，然后港口对装船计划进行统筹安排。多方 需要了解的详细信息:出口预配清单、出口舱单、高清船图、订舱所需要的报文、 订舱所需的申请表、放箱单。
(8)装船离港:港口基于装船作业计划，将堆场中的货物转移到码头中,码头 在现有船舶和货物情况的基础之上，进行装船作业。船公司将装船，离港信息上 传至 FPMS，并转发给货主，联运经营人，铁路，港站，码头，场站和理货进行 信息确认。船员对船只载货状况进行细致的检查,船代进行国际联运提货单的开 具,遵循港口领航的信息离开港口。船公司实时上传货物位置信息至 FPMS，联 运经营人以及货主需要不间断的了解船只海上航行状况。多方需要了解的详细信 息:集疏计划的详细信息、船期计划的详细信息、工班各项计划、港口的关键信 息、货物的详细信息、港口车辆占用状况以及应用状况、离港许可信息、国际提 货单。
(9)提货:货物到达目的地后，FPMS 向收货人发送提货通知并签提货单，收 货人根据领货凭证到指定地点提货。收货人在收货完成并确认货物无误后，将提 货确认信息反馈至 FPMS。主要共享信息：国际联运提货单。
由于上述流程所涉及的信息均被铁水联运云平台整合，不但通过全程运单和 订单撮合消除了需人工处理或重复办理的业务节点，而且联运经营人也可以利用 各方信息合理安排请车、订舱、报关等环节。一方面，在内陆请车过程中，可通 过内陆港、内陆海关等机构提前办理通关检疫、检查、计量等工作，加大通关速 度；另一方面，水运部门也能利用货物信息、列车车辆情况、在途实时状态等信 息，使其能提前安排相关作业计划，实现铁路和水运的无缝连接。

西南交通大学博士研究生学位论文

第 71 页

FPMS

集

装

箱

订

出

单

口

需

流

求

程

收

定

集

义

提

交

托

运

请

货主

求

1

联运经营人

铁路 港站 船公司

码头

场站

理货

保险公司

货运商务过程

智 能 订 单 撮 合

经 营 人 确 认

填 写 全 程 运 单

制 定 运 输 计 划

选 择 代 理 人

确 定 承 运 关 系

全 程填 连写 运上 单传 信

运 输 计 划 回 复

2

息4

5

请

求

3

5

货运物流过程

签订

签订

提箱

订舱

合同

保险

订车

卸车

铁运

接

装

实时

货

箱

信息

反馈

铁

清

办理中转手续

点 货

物

报报 检关

出口准备

装 船 、 离 港

海运

通

实时

知

信息

提

反馈

货

合 签同 订信 合息 同回
复
6
6
6

路

7 7 7

提 箱 订 车 申 请

提 箱 订 车 申

提 箱 订 车 回 复

订 舱 卸 车 请 求

卸 车 委 托

8请

11

9 10

订 车 报 文
13

发

实

送 备 货 请 求

信 息 回 复

14

装 箱 完 成

时 拖 车 数 据 ， 港 站 编 组 信 息

铁 路 实 时 拖 车 数 据 ， 港 站 编

15

16 组

信

息

17

卸 车 清 单

发 箱 卸申 卸车 请 车计

发

清划 箱

单

申

请发

22 箱

指

卸令

车

发

计

箱

划

指

令

1920 23 24

报 检 申 理请 货 证 明
27
报 检 申 请

装

船

理

出

报

货 出口

告

证 口预

出

明 清 配 装口

、 单 清 船舱

报

单 报单

关

、 告、

信

息 、 国 检 放

海 关 放 行

行

出 口 清 单

出 口 船 图

出

、出 出口 口预 舱配 单清

口单

预

物

装

流

上船

信

传离

息

装港

反

船 信实

馈

、 39息 时 41

离 反物

港 馈流

信 39 信 41

息

息

39

41

发

送

39

提

配

单

6

7

12

报

清

信

检

32

单 3357

38

40 41 息

放

行

6

7

13

17

18 21

25

35 36

39

41

6

7

6

7

12 13

17

7

39

41

26

33 34

39

41

国检 2829

海关 3031

签发

全程

货物

支付

运单

交付

确认

提货

单

费 用 明 细

46

签

付

发

款

提

货

单

费

用

结

算

领 货

提 货

请 求

凭

信

证

息

回

复

银行 收货人

47 47

17

41

42

4344

45

图 3-17 FPMS 的集装箱出口信息流

3.5.4 基于 FPMS 的集装箱进口信息流设计

进口与出口作业流程差异不大,主要区别是货物进口运输以港口为起点。在

目前的联运信息系统中是由港口 EDI 中心负责对外进行信息交换；而在联运云 平台环境下，需要 FPMS 跟踪物流过程中，船只以及海运在途等方面的详细信息, 实现与港口的数据交互,方便港口以及码头提前做好计划。同样以集装箱为例，

设计 FPMS 的联运进口信息流程如图 3-18 所示:

FPMS

集 装 箱 进 口 流 程 定 义
货主
联运经营人
铁路

货运商务过程

订 智经填制

单 能营写定

需 求 收

订 单 撮

人 确

全 程 运

运 输 计

集 合认单划

提

选 确全

交

择 定 程 填运

进

代 承 连 写输

口

理 运 运 上计

货 物1

人2

关 系

单 传划 信4 回5

运

息复

输

3请

5

请

求

求

港站

船公司

码头 5
场站

理货

保险公司

签签 订订 合保 同险
合 签同 订信 合息 同回
复

6

7

6

7

6

7

6

7

6

7

6

7

7

提箱 订车

办理货物交 接手续

提 箱 订 车 申 请

提 提 箱提 箱 订箱 订 车订 车 回车 申 复回

8请 复

9 10

11

装提

箱箱

委申 托请 、、 提装 箱箱 确12委 认托 委、 托提 、箱 进确 重认

装 箱 委 托 、 提 箱 确 认 委 托

放 箱 提单 海信 运息 箱

箱委 委托

15 16

托、

进13 重

箱

委 14 托

放箱

提

海

运

箱

进

、进 放口 箱舱

口 舱 单

单单

信

息

20

18

17

19

货运物流过程

报 检

报 关

装车

国

检

海

进

关装 放车 行计 、划

装 箱 确 认

提

口查

重

舱验进

箱

单 放 口 查 委 26 27

、 行 舱验 托

报

单放 、

检

、行 进

申

报

口

请

关

舱

申

单

请

25 28

国

检

放

行

铁路 实时 信息 反馈

实 时 物 流 信 息

物 流 信 30 息 反 30 馈

30

通 知 提 货
发 送 提 单 信 息 31

29 30 30 30 30

签发 全程 运单 提货
单
签 发 提 货 单
32

国检 21 22

海关 2324

货 物 交 付
领提 货货 凭信 证息
33 34回复

电 子 支 付 确 认
费 用 明 细
35

付 款 付 款 请 求

银行 36 37

第 72 页

西南交通大学博士研究生学位论文

图 3-18 FPMS 的集装箱进口信息流
根据 2.1.3 节分析，传统的铁水联运信息流程复杂，单据不统一，信息共享 程度较低，而 FPMS 采用商流物流合一模式进行构建，并结合电子全程运单，实 现货物运输信息的无纸化和线上一站式服务，基于 FPMS 的联运信息流程主要具 有以下优点:
(1)商务灵活性。FPMS 可以根据货主订单信息，自动推荐联运人供货主选择； (2)业务安全性。货主，联运经营人，铁路，港口等签订多方保险，统一理 赔，有效降低运输风险； (3)运输便捷性。将传统的铁路，海运代理人整合为联运代理人，发货人只 需与联运代理人沟通，而联运代理人通过 FPMS 与港口、铁路进行业务协商。 (4)物流信息实时性。铁路、海运信息实时上传至 FPMS，并自动将相应信息 反馈至各参方。 (5)作业连贯性。FPMS 掌握货物运输过程的全局信息，能提前向下一个运输 参与方发送货物预到达信息，减少时延，以保证运输的连贯性。

3.5.5 基于 Petri 网的 FPMS 集装箱进出口信息流建模和模型检测

本节主要通过流程建模，对 3.5.3 节和 3.5.4 节的集装箱流程进行验证。在

现有的企业流程模型中，还没有现成的完全满足业务流程建模需要的模型工具，

通过表 3-5 对各模型工具的综合对比评价可知，Petri 网比较适合业务流程建模，

是集装箱进出口业务流程动态建模的最佳选择。从有效性角度看，Petri 网对复

杂动态行为的描述能力可以满足业务流程优化对流程模型的要求；从实用性角度

看，目前大多数建模工具局限于对流程的图示化和分析，而缺少对流程结构的分

析，而 Petri 网技术既有成熟的理论作为其系统分析的基础，又有较好的计算机

化能力[21]。因此，本节基于 Petri 网模型对上述流程进行动态建模。
表 3-5 流程建模方法比较图

属性

流程图建模 角色行为图 IDEF 方法 Petri 网 ARIS

完备性

弱

弱

一般

强

强

形式化

较好

一般

一般

较好

一般

模型表达能力 一般

一般

一般

较好

较好

跨组织流程建模 支持

不支持

一般

支持

支持

流程仿真

不支持

不支持

不支持

支持

支持

动态建模

不支持

不支持

不支持

支持

支持

建模方法论

弱

一般

较完备

较完备

较完备

3.5.5.1 Petri 网的基本理论和 OOPN 技术

Petri 网是网状结构模型，库所和变迁是 Petri 网的基本元素，在图形中分别 表示为圆形节点和方形节点。但一个完整的 Petri 网构成还有两个元素必不可少，

西南交通大学博士研究生学位论文

第 73 页

其一是表示库所和变迁之间关系的流关系，在图形中表示为库所和变迁之间的有 向弧，其二是令牌(Token，托肯)，是库所中的动态对象，可以通过变迁的触发 从而从一个库所移动到另一个库所。
面向对象 Petri 网技术(Object Oriented Petri Net,OOPN),是 Petri 网与面向对 象技术结合的产物，Petri 网适合于描述系统的动态特性以及资源的约束条件， 可以用形式化与图形化方式进行直观的描述。在 OOPN 中，把实体都定义为对 象，每个对象拥有自己的属性和方法，对象通过消息触发来完成相应的操作。
OOPN 主要为了提高对象的独立性与可重用性。在普通 Petri 网的基础上， 将系统之间的交互过程从每个对象中单独提取出来，使对象内部行为描述与外部 通信接口分离，在对动态系统进行有效描述的基础上，实现功能模块化，以提高 系统的可维护性与可重用性。
3.5.5.2 基于 OOPN 的 FPMS 集装箱进出口流建模
按照 OOPN 的模型构成，首先结合 3.5.3 节和 3.5.4 节的业务分析确定系 统组成对象及结构，并按以下几个步骤对集装箱进出口信息流进行建模：
(1) 将 FPMS 的信息流系统组成划分为四类对象： (2) 确定类对象自身行为，以及与其它对象间的关系； (3) 用简单 Petri 网构造出四类对象自身内部行为； (4) 在(3)的基础上，构建对象消息队列，并用输入/输出门表示对象的外部 接口； (5) 将各类对象的内部 Petri 网中相应变迁与消息队相连。 同时，为了简化建模过程，在模型构建之前对 FPMS 流程系统作如下假设： (1) 铁路货运站在一段时间内能够均匀提供服务； (2) 所有运输相关部门和货运相关人员一般情况下都能够紧密联系； (3) 所有参与方的相关人员一次只能办理一项业务； (4) 处理流程的资源消耗一定，不考虑人为及外部因素影响； (5) 事件处理结果均为满意结果，能够为下一步使用； (6) 每个转运节点都有足够的能力办理转运手续。 根据上述建模过程和前提假设，可以构建基于 OOPN 的 FPMS 集装箱出口 信息流系统模型如图 3-19 所示，其中相关的符号涵义表见表 3-6：

第 74 页

西南交通大学博士研究生学位论文

保险公司
e1 f1
e2 f2

货主
a1 b1 a2 b2 a3 b3 a4 b4 a5 b5 a6 b6 a7 b7 a8 b8
Q83
Q11
铁路
s1 t1 s2 t2 s3 t3 s4 t4 s5 t5 s6 t6
港站
u1 v1 u2 v2 u3 v3 u4 v4 u5 v5 u6 v6

FPMS货运管理系统

Q1

P1

T1
G1 Q2 Q3
P2
Q5
T2
Q7

G2 Q4

P3

T3

G3

P4

Q9

Q6

T4

Q84

G4

P5

Q12 Q14 G5 G6 G7 Q16

Q13

G8

Q15

Q18

G9

Q17

Q8

G10 Q20

Q19 Q26
Q21

G11

T9 P22
T23

T5 P6
T6 P7
T7 P8 T8 P9
T10 P10 T11 P11

G13

T12

联运经营人

Q40

c1

d1

c2

G20

Q42

d2

c3

Q39

Q43

d3

c4

d4
G21 Q45
c5

d5
G22
c6

d6

G23 Q49

c7

Q41

d7

c8

Q47

d8

G24

Q44 G25

Q46

G26

Q51 Q53
G27 Q50

理货 Q54 i1
j1
i2 j2

Q55 G28

i3 j3
G29

c9 d9

码头

Q48

g1

h1

g2
Q52
h2

g3

h3

Q58

g4

h4 g5

Q72

h5 g6

h6

船公司

Q57 G30 Q56

Q59

Q60

Q70 Q61 G31

k1
G11 l1
k2 l2
k3
l3
k4

Q74

l4

Q63

k5

G32

Q76

l5 k6

Q23 Q25 Q27 Q29 Q31

G12 Q24

G14

Q28

G15

Q30

G16

Q32

l6 P12
Q65 G33

T13

P13

G35 G34
G36

国检 Q62
m1

T14

Q67

n1

Q64

m2

P14

Q69

n2

Q33

G17

Q22

Q34 Q10

T15

Q71

P15
Q73
T16
P16
Q75
T17

G38

G37

海关

Q66

o1

p1

o2

Q68

p2

银行
w1

G18 Q35

x1

w2

G19

x2

Q37

Q36

Q38

P17
T18 P18 T19 P19
T20 P20
T21 P21 T22

Q77

G39

Q79 G40 Q78

收货人
q1 r1

q2

G41 Q81

r2
Q80
q3
r3
Q82

图 3-19 基于 OOPN 的 FPMS 集装箱出口信息流模型

西南交通大学博士研究生学位论文

第 75 页

符号
P1 P2 P3 P4 P5 P6 P7 P8 P9 P10 P11 P12 P13 P14 P15 P16 P17 P18 P19 P20 P21 P22
a1 a2 a3 a4 a5 a6 a7 a8 c1 c2 c3 c4 c5 c6 c7 c8 c9 e1 e2

表 3-6 FPMS 集装箱出口信息流的 OOPN 模型符号涵义表

涵义

符号

涵义

订单需求的收集

T1

订单撮合

T2

填写全程连运单请求

T3

运输方案设计

T4

订车、提箱请求

T5

订舱请求

T6

卸车请求

T7

收到托运请求 代理人选择 填写完毕 签订合同、保险 订车提箱完成 订舱完成 卸车计划执行中

装箱请求

T8

铁路运输和中转请求

T9

装箱完成 铁路运输请求

报检准备 报检中

T10

中转手续办理完毕

T11

报检请求

报关准备

T12

报检通过

报关中

T13

报关请求

出口准备请求

T14

报关通过

装船离港请求

T15

出口准备完毕

海上运输准备

T16

装船离港

通知提货准备

T17

海路运输中

签发提货单准备

T18

通知提货

货物交付通知

T19

签发提货单

支付请求准备

T20

货物交付

支付中 铁路运输处理
运输需求 等待全程联运单
等待签订协议 等待运输准备

T21

支付

T22

支付完成

T23

铁路运输中

b1

托运请求

b2

全程连运单填写完毕

b3

协议签订完毕

b4

铁路运输中

报关准备 报检准备

b5

报关通过

b6

报检通过

海路运输准备 货物交付通知

b7

海路运输中

b8

货物交付完毕

等待发货人选择 确定承运关系 运输前准备
订舱、卸车准备 报关报检准备

d1

选择完毕

d2

签订合同、保险

d3

订车、提箱完毕

d4

订车卸车计划完毕

d5

报关报检中

发箱申请

d6

发箱完毕

铁路运输准备

d7

铁路运输中

海路运输准备 货物交付通知

d8

号路运输中

d9

货物交付完成

等待签订保险

f1

签订保险协商中

f2

签订保险请求 签订保险完成

第 76 页

西南交通大学博士研究生学位论文

g1

等待签订合同

h1

签订合同完毕

g2

收到卸车申请

h2

卸车计划准备

g3

卸车安排中

h3

卸车清单统计完毕

g4

发箱请求

h4

发箱完毕

g5

出口准备

h5

出口配置清单

g6

装船准备

h6

装船、离港

i1

等待签订合同

j1

合同签订完毕

i2

理货准备

j2

清点货物完毕

i3

装船通知

j3

装船离港

k1

等待签订合同

l1

合同签订完毕

k2

订舱申请

l2

订舱完毕

k3

出口准备申请

l3

出口准备

k4

装船通知

l4

装船离港

k5

海路运输通知

l5

海路运输中

k6

通知提货

l6

货物交付

m1

等待货物报检

n1

报检申请

m2

报检中

n2

报检通过

o1

等待货物报关

p1

报关申请

o2

报关中

p2

报关通过

q1

等待提货通知

R1

提货通知

q2

等待提货单

r2

收到提货单

q3

货物交付中

r3

收货完毕

s1

等待签订合同

t1

合同签订完毕

s2

订车请求

t2

订车完毕

s3

装箱请求

t3

装箱完毕

s4

铁路运输前准备

t4

铁路运输

s5

装船通知

t5

装船离港

s6

货物交付通知

t6

货物交付完毕

u1

等待签订合同

v1

合同签订完毕

u2

卸车申请

v2

卸车完成

u3

铁路运输通知

v3

铁路运输中

u4

中转手续准备

v4

中转手续办理完毕

u5

出口准备

v5

出口准备完毕

u5

装船离港准备

v6

装船离港

w1

等待付款

x1

付款请求

w2

付款准备

x2

付款完成

同理，可以构建基于 OOPN 的 FPMS 集装箱进口信息流系统模型如图 3-20

所示，其中相关的符号涵义表见表 3-7：

西南交通大学博士研究生学位论文

第 77 页

G4

Q8

G5 Q10

G6

Q11

G7

Q13

保险公司
e1 f1

e2

Q15

f2

铁路
s1 t1 s2 t2 s3 t3 s4 t4 s5 t5

Q17
Q19 Q21 Q31

货主
a1 b1 a2 b2
a3 b3 a4 b4 a5 b5 a6 b6 a7 b7
a8
b8 a9 b9 a10 b10

Q1 G1 Q2

Q3

G2 Q4

G3

Q5

Q6

Q16 Q18

G8
Q20 G9
Q22 G10

G11

国检
m1
n1 m2 n2

G12 Q23 Q24 Q25G13Q26

海关
o1 p1 o2 p2

G14 Q27 Q28
Q29 Q30 G15

G16

Q32

港站
u1 v1 u2 v2 u3
v3 u4
v4 u5

G17 Q34 Q33
Q36 Q35
G18 Q7
Q9

Q12

FPMS流程管理系统

P1

Q39

T1
Q41

P2

T2

P3 T3

P4

G20 Q40 G21 Q42

联运经营人
c1 d1 c2
d2 c3 d3 c4
d4 c5
d5 c6 d6 c7

T4

P5

T5 P6

T6

T7

P7

P8

T8

T9

Q43 G22 Q44
Q45

理货
i1 j1 i2 j2
i3 j3
G23

G24

Q47

Q46 Q48

船公司
k1 l1 k2 l2 k3 l3 k4 l4

P9 T10 P10
T11 P11
T12
P12

Q49 G25
Q51 G26 Q52
G27 Q54 Q53
G28 Q55 Q56

码头

Q50

g1

h1 g2

h2 g3
h3 g4
h4 g5

h5 g6

h6

T13 P13 T14 P14 T15 P15 T16

Q57 G29 Q58
G30 Q60 Q59

港站
q1 r1 q2 r2
q3 r3
q4 r4 q5 r5

符号
P1 P2 P3 P4 P5 P6 P7

P16

银行

Q38

Q14

w1

G19

T17

x1

w2

x2

Q37

图 3-20 基于 OOPN 的 FPMS 集装箱进口信息流模型

表 3-7 FPMS 集装箱出口信息流的 OOPN 模型符号涵义表

涵义

符号

涵义

订单需求的收集

T1

收到托运请求

订单撮合 填写全程连运单请求

T2

代理人选择

T3

填写完毕

运输方案设计 订车、提箱请求

T4

签订合同、保险

T5

订车提箱完成

办理货物交接手续和报关报检申请

T6

报检中

T7

申请报检 货物交接手续完毕

第 78 页
P8 P9 P10 P11 P12 P13 P14 P15 P16
a1 a2 a3 a4 a5 a6 a7 a8 a9 a10 c1 c2 c3 c4 c5 c6 c7 e1 e2 g1 g2 h3 g4 g5 g6 i1 i2 i3 k1 k2 k3 k4 m1 m2

西南交通大学博士研究生学位论文

放箱申请 申请报关准备
报关中 装车申请 铁路运输前准备 通知提货通知 签发单证通知 货物交付通知 付款通知
进口货物运输需求 等待全程联运单 等待签订协议
等待货物交接准备 报关报检准备 铁路运输准备 等待提货通知 等待签发提货单 等待货物交付 等待付款 等待发货人选择 确定承运关系 运输前准备
等待办理交接手续 等待报关报检 等待铁路运输 等待通知收货 等待签订保险 签订保险协商中
等待货物运输计划申请 等待签订
等待办理交接手续 等待放箱申请 等待装车 等待货物交接 等待签订协议 等待放箱申请 货物交付
等待进口舱单申请 等待放箱
等待货物铁路运输 等待货物交付 等待货物报检 报检中

T8

报检通过

T9

放箱完毕

T10

报关申请

T11

报关通过

T12

装车完毕

T13

铁路运输中

T14

通知提货

T15

签发提货单

T16

货物交付

T17

付款

b1

托运请求

b2

全程连运单填写完毕

b3

协议签订完毕

b4

货物交接中

b5

报关报检通过

b6

铁路运输

b7

通知提货

b8

签发提货单

b9

货物交付

b10

付款

d1

选择完毕

d2

签订合同、保险

d3

订车、提箱完毕

d4

办理交接手续

d5

报关报检

d6

铁路运输

d7

货物交付

f1

签订保险请求

f2

签订保险完成

h1

运输计划安排

h2

签订协议

h3

办理交接手续

h4

放箱完毕

h5

装车

h6

货物交付

j1

签订协议

j2

放箱

j3

货物交付

l1

进口舱单回传

l2

放箱

l3

铁路运输

l4

货物交付

n1

报检申请

n2

报检通过

西南交通大学博士研究生学位论文

第 79 页

o1

等待货物报关

p1

o2

报关中

p2

q1

等待签订协议

r1

q2

等待办理货物交接申请

r2

q3

等待放箱申请

r3

q4

等待装车申请

r4

q5

等待货物交付通知

r5

s1

等待签订协议

t1

s2

等待提箱订车申请

t2

s3

装车准备

t3

s4

运输前准备

t4

s5

等待货物交付

t5

u1

等待签订协议

v1

u2

等待提箱申请

v2

u3

等待放箱申请

v3

u4

等待货物运输

v4

u5

等待货物交付

v5

w1

等待付款

x1

w2

付款准备

x2

3.5.5.3 FPMS 集装箱进出口信息流模型检测

报关申请 报关通过 签订协议 办理交接手续
放箱 装车 货物交付 签订协议 提箱订车 装车 铁路运输 货物交付 签订协议完毕 提箱完毕 放箱完毕 铁路运输 货物交付 付款请求 付款完成

(1) 模型可靠性分析
模型可靠性表示系统在规定的条件和时间内完成规定功能的能力，是表征系 统性能的关键指标，本节将通过 OOPN 模型对系统的可靠性进行检测。目前 OOPN 模型最常用的可靠性检测方式为系统死锁检测。所谓死锁：是指两个或两 个以上的进程在执行过程中，由于竞争资源或者由于彼此通信而造成的一种阻塞 的现象，若无外力作用，它们都将无法继续推进，此时称系统处于死锁状态或系 统产生了死锁，这些永远在互相等待的进程被称为死锁进程[130]。这里的死锁为 动态死锁，它反映了 Petri 网的动态特性，可以通过对 Petri 网可达集中死锁标识 的检测来检验是否存在死锁，如果在可达集中检测到死锁标识则存在死锁，否则 不存在[19,20]。
可达树是一种有效的检验 Petri 网死锁标识的工具，它能覆盖 Petri 网的所有 可达集，同时也能覆盖所有的死锁。面向对象 Petri 网可达树死锁检测过程可分 为以下几个步骤：
(a) 根据各对象内部结构，提取出其输入/输出门及发生顺序，构造接口等 价网(Interface Equivalent Net，简称 IE 网)；
(b) 组合(a)中不同对象 IE 网，从而构成系统 IE 网； (c) 通过对所建立 IE 网进行可达树分析，检测其中是否存在死锁，如存在

第 80 页

西南交通大学博士研究生学位论文

则需要对所建立的模型进行改进以消除死锁；否则，系统是可靠的。 以 3.5.5.2 节的 FPMS 货运流程管理系统为例，对象内部的可达树及 IE 网如
图 3-21、图 3-22 所示：

（1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0） T1
（0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0） T2
（0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0）
T3 （0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0）
T4 （0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0）
T5 （0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0）
T6 （0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0）
T7 （0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0）
T8 （0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0）
T9
T10 （0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0）

（0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0）

T11

T23

（0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0） T12

（0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0） T13

（0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0）

T14

（0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0）

T15

G10

（0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0） T16

G2

（0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0）

G14

T17

（0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0）

G25

T18

（0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0）

T19

（0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0）

T20

（0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0） T21

（0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1） T22
（1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0）

图 3-21 FPMS 系统出口作业可达树及 IE 网

G1 G20 G2 G3 G21 G24 G5 G7 G13 G27
G28 G22 G23 G30 G11 G26
G9
G29 G15 G31
G32 G34 G37
G33 G16 G38 G35 G12 G17 G6
G36 G39 G40 G41 G18 G19

西南交通大学博士研究生学位论文

第 81 页

（1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0） T1
（0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0） T2
（0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0） T3
（0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0） T4
（0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0） T5
（0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0）

T6 T7

（0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0）

T8

（0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0）（0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0）

T10

（0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0）

T9

T11

（0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0）
T12 （0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0）

T13

（0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0）

T14 （0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0）
T15 （0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0）
T16 （0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1）
T17

（1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0）

G12 G13 G14 G15 G11 G16 G4

G1 G20 G2 G25 G3 G21 G22 G8 G9 G17 G25 G29
G10
G18
G27 G30 G24 G28

G5 G6
G7 G19
图 3-22 FPMS 系统进口作业可达树及 IE 网
通过对可达树和 IE 网的分析可以明显看出，FPMS 货运流程管理系统内部 不存在死锁；同理可得，铁路、港站、货主、联运经营人等其余对象也不存在死 锁，因此，3.5.5.2 节所建立的整个 OOPN 模型都不存在死锁。

(2) 有界性分析

在 Petri 系统在运行过程中会对资源产生需求，但无限的需求量会导致系统 崩溃。有界性是衡量系统运行中对资源需求量是否有限的指标，其代表了库所在 系统运行过程中能够获得的最大令牌数[18]。在 Petri 网运行过程中，若存在一个 整数 K 使得初始标识的任意可达标识中库所的令牌数均不超过 K，则称该 Petri 网是 K 有界的[21]。
对于 Petri 网模型的有界性分析可以通过对可达树的分析得到，分析可达树 中库所的有界性，从而可以达到对整个 Petri 网有界性的分析。由图 5-1、图 5-2 可以明显看出，FPMS 系统模型对象是有界的，具有有界性；同理可证，其余对

第 82 页

西南交通大学博士研究生学位论文

象也具有有界性，可得 3.5.5.2 节所建立的整个 OOPN 模型都是有界的，具有 活性和可用性。
3.5.6 基于 FPMS 的联运数据交换
从货运物流过程的参与主体来看，主要分为联运客户(货主/联运经营人)， 铁路，水路和政府相关机构(一关两检/银行/保险等)。这些主体大多有自己相对 完善的管理信息系统，虽然各自能很好的完成自身环境的调度运输等任务,但无 法很好的满足联运业务需求。为了实现各参与机构的无缝连接作业,需要以 FPMS 作为桥梁进行数据交互，全程无纸化，以便联运管理部门对客户需求进行 全方位的了解,同时也可以对物流服务质量进行有效把握,做好沟通工作，提高客 户满意度。下面针对这些主体需要交换的信息进行数据梳理。
3.5.5.1 货主/联运经营人提交和获取的数据
货主/经营人与联运参与机构交换的数据如下。一是货主以及经营人方面所 供给的信息,比如请车订单的情况等；二是相关机构给货主以及经营人所提供的 各种信息，主要分为以下四类:
(1) 货物订单信息。该类信息由货主通过货运电商平台提交后,由 FPMS 交 互给货主选择的联运经营人，主要有以下几部分：
(a)货物的详细信息：涵盖了货物全称、包装的类型、全部数量（件）、质量、 体积、声明标价
(b)货主的详细信息：涵盖了全称、证件号码、详细地点、邮编、联系方式、 传真号码、email
(c)收货人的详细信息：涵盖了全称、证件号码、详细地点、邮编、联系方 式、传真号码、email
(d)货物托运单的详细信息：涵盖了货物抵达站点、途经、对应票号、全部 支出、发货地、收货地
(2) 联运各环节申请单。该类信息是联运经营人通过 FPMS 与各机构之间进 行业务办理所使用的单据，主要有以下几部分：
(a)请车申请表的详细信息：涵盖了请车时间点、车辆类型、车辆规模、车 次、货物的状况
(b)堆存报文的详细信息：提供现阶段堆场中进口集装箱的全部数据,主要供 船公司下属箱管部门所进行的盘存,检查集装箱应用的状况
(c)海关货物报告报文的详细信息：到货后，联运经营人进行海关进港验单 的有效报告

西南交通大学博士研究生学位论文

第 83 页

(d)海关放行报文的详细信息：海关通知进、出口货物所对应的放行信息(涵 盖了船只全称,具体的航次,详细的提单号以及海关部门的申报单号等)
(e)正式订舱报文的详细信息：联运经营人将正式的订舱申请提交给港口， 一般情况在初始订舱预订之后就可以发送正式订舱报文
(f)请车订舱批复信息：对联运经营人请车订舱请求的受理通知，或者受理 未通过的原因
(3) 货物在途状态信息。该类信息是联运经营人通过 FPMS 了解货物运输状 态所需要的信息，主要有以下几部分：
(a)货物仓储的详细信息：涵盖了货物的现实货位以及仓储情况；货物存放 的货场；货物转移到货场时间方面的要求；铁路部门以及水运货运部门所出具的 验货结果
(b)货物运输的详细信息：涵盖了货物计划中对应的列车车次；途经各站点 时刻表；货物计划中的中转地点；计划的中转时间；正晚点数据以及相关缘由； 运输恢复的对策；货物抵达的日期
(c)货物到站及卸车的详细信息：涵盖了货物到站、到港的卸车状况；领货 的地方以及详细时间
3.5.5.2 铁路与水路部门交换的数据
铁路部门的运营管理数据由铁路核心系统 TMIS 提供，涵盖了多个子系统， 比如货运站管理等。在联运业务流程中，其能够实现铁路多数需求信息的采集， 同时能够追踪管理物流各个环节的集装箱等货物，了解到其地点和所处情况。不 过 TMIS 所拥有的联运信息交换接口并不对外开放，造成联运管理部门对铁路实 时状态的了解有滞后，使得联运业务发展受限，效率一般。按照联运业务需求， 铁路部门除了为货主/经营人提供信息以外，更重要的是与水路部门提供信息支 持，按前面业务流程分析，对铁路部门向水运部门提供的数据分析：
(1) 预确报的详细信息：铁路将本方的预确报信息提供出来，这样港口可以 对列车实时状态进行查询，预确报信息具体如下：车皮的详细信息、编组的详细 信息、编组完成后所对应的确报信息、列车发车站以及终点站、具体线路计划等， 将实时变动的信息更新到 FPM，比如车皮所处的状态等，随时可以查询亦或是 更新水路方。
(2) 货票的详细信息：铁路货票十分关键，作为全程联运订单的组成部分， 对调度指挥作业价值巨大。铁路方基于 FPMS 将货票信息提供给各方，各方基于 货票信息做好提前准备。
(3) 车皮的详细计划：港口向铁路相关部门提交对车卡的申请，后者进行审 批以及安排。然后使用 FPMS 公开或反馈审批状况，这样港口提前做好装卸车卡

第 84 页

西南交通大学博士研究生学位论文

作业的准备，实现港内资源的合理利用。 (4) 列车编组的详细信息：铁路部门基于 FPMS 向港口相关部门发送列车编
组信息，方便港口做好装卸作业安排。现阶段港口获得列车编组信息，需要再进 一步处理以及录入等，耗时耗力。因此港口可以依托 FPMS 对列车编组信息实现 有效的整合。
(5) 发运发运的详细计划：涵盖了发运车次所对应车卡信息(比如车卡号、 具体的类型、车辆的整体载重)、能够使用与否等。
(6) 班列的详细信息：水路部门需要对铁路班列开行或延迟时间等进行实施 了解，不断进行优化，从而实现与船公司船期计划的有效融合。
(7) 铁路货运的详细信息：铁路基于 FPMS 向水路部门提供货物的详细运输 状况，方便后者做好各种计划。
(8) 详细的计量数据：分析铁水联运可以了解到，其中多数作业以及计量统 一进行，这样基于 FPMS 可以获取计量数据，使得数据交换流程得到简化。
(9) 检验作业的详细信息：涵盖了对作业流程以及信息的检验，将货检等各 种信息实现面向各方系统的共享。
3.5.5.3 水路与铁路部门交换的数据
现阶段，中国临海大中型港口多使用集团化管理模式，拥有独立的港务分公 司和管理的下属公司，在信息系统的支持下，集中集团的港口生产业务，同时有 效统一了分布管理。其中主要包括生产计划管理(主要包括大船作业，驳船作业， 铁路公司管理，船务公司管理等)，商务管理(主要涵盖了客户服务管理, 合同全 线管理，业务单据办理管理等)，生产业务数据统计管理和财务管理等模块。
水运部门国际化程度要比铁路部门更深，基本达到国家标准，国际大型的船 公司和贸易港口与港口部门的信息沟通主要基于网络途径来实现，提前制定计划 以及统筹，保证作业有着较高的效率。不过与内陆运输部门对接存在一定的局限， 信息流通不畅，很多情况下车辆和船只时间不对等。更严重的是由于缺乏统筹规 划和标准，每个港口必须自己去打通与铁路的信息通道，不但工作效率低，重复 量大，而且也对铁路部门造成了巨大的工作负担，而在铁水联运云平台上，所有 港口部门都可以通过 FPMS 提供信息，即可实现与铁路的数据交互，并有效的降 低港、铁信息共享成本。基于水运部门现有信息系统的结构和功能，按照联运业 务流程，水运部门作为信息提供者，需要向铁路部门提供的数据分析整理如下：
(1) 港口主要的信息：涵盖了港口制定的生产经营计划、堆场所具备的设施 能力、铁路运输的整体需求、港口作业线所配备的装卸机械以及装卸效率等。
(2) 集疏运计划方面的详细信息：港口集疏运计划与港口的日生产计划有着

西南交通大学博士研究生学位论文

第 85 页

紧密的关联性，体现出港口工人、机械设备的运能以及机能状况，所以铁路部门 需要基于 FPMS 及时了解这些信息，从而协助各方安排好装卸工作。
(3) 船期计划方面的详细信息：涵盖了货运船舶相关计划，比如船只拥有的 运载能力、目标港口、预估抵达时间，货物类型、目标地、要求空车车辆类型、 辆数等。铁路部门基于 FPMS 取得相关信息，制定运输计划。
(4) 港口当前的铁路、车辆使用和关键情况：涵盖了港口的内部货场中车卡 现存数量，到发场股道的使用状态，港口内所拥有车卡分布、车辆使用情况等， 铁路部门综合上述情况，制定相应工班计划等，持续不断的监控港口装卸作业情 况，让工作拥有比较高的效率。
(5) 货物主要的信息：港口与铁路部门基于 FPMS 进行沟通，包括了货物类 型、目的地、需要使用的车种、车型、运输量等；若货场主要围绕到达进行，铁 路需要深入了解货物库存状况。
3.5.5.4 其他部门对 FPMS 的业务数据需求
除了货主/联运经营人，铁路部门和水路部门之间的数据交换需求，铁水联 运所涉及的海事局、海关、电子口岸，以及其他中小企业等单位对联运信息都存 在共享需求，例如海事局需了解船舶到港情况和离港时间等信息，而海关需要使 用货物信息，通关信息等。此外，上述各部门也需要将自身相关信息提供给 FPMS， 以实现与铁总、经贸委、统计局等国家机关之间的信息交换；各基层铁路局、地 方政府、水路、海关等之间的运输统计信息交换；以及大型客户之间的货运信息 交换等[122]。
此外一些中小企业以及货主/联运经营人，对 FPMS 所提供的信息也有一定 的需求，如货物实时定位信息查询、班列信息查询、运价信息查询等服务。同时 还需要通过联运电商平台提供一系列的增值服务，如用户积分、门到门服务、语 音咨询服务和个性化服务等。
3.5.5.5 联运公共基础数据
此种数据指的是铁路以及水路运输中涉及到联运规定、标准、工作流程和相 关参数等方面的信息。在铁水联运云平台中，这些信息由联运电商平台发布，不 但能方便货主对铁水联运运输模式、内容等进行了解，也能使联运经营人更合理 的安排请车、订船、报关等环节，提高业务的并发率和业务决策的合理性，主要 内容整理如下:
(1) 法规类： (a)铁路相关法规：包括中华人民共和国铁路法、铁路安全保护条例、危险 化学品安全管理条例等。

第 86 页

西南交通大学博士研究生学位论文

(b)水路相关法规：涵盖了中华人民共和国海关法、中华人民共和国进出口 关税条例、国内水路运输管理条例、国际航行船舶进出中华人民共和国口岸检查 办法等。
(c)其他相关法规：涵盖了公共中华人民共和国合同法、中韩日电子签名法、 对外贸易管理法规、中华人民共和国动物防疫法、进出境物品监管法规等。
(2) 操作流程标准类： (a)铁路相关流程标准：涵盖了铁路行包运输保价办法、铁路货运大客户运 输服务管理办法、铁路交通事故应急救援和调查处理条例、铁路货物运输规程、 铁路危险货物承运人资质许可办法等。 (b)水路相关流程标准：涵盖了船舶名称代码规则、船图表示协议、船期、 集装箱尺寸种类代码规则、港口电子数据交换协议等。 (3) 公共参数信息： (a)铁路相关公开参数信息：涵盖了铁路货物装载加固定型的详细方案等、 品名品类明细表、危险货物运输需要具备的条件数、铁路超限超重运输需要满足 的条件、多种车辆以及集装箱参。 (b)水路相关公开参数信息：涵盖了国际船公司编号、船名航次对照表、集 装箱堆场库容的详细信息、国际航线编号和代码等。

3.6 本章小结

目前铁水联运信息系统分散建设，以港口为中心进行规划建设，水平层次不 齐，加上 IT 架构上的弊端，港口在为我国联运信息化做出贡献的同时也反为信 息化所累，也给我国联运业务的整体发展带来阻碍。本章在分析当前铁水联运信 息化建设存在的问题和遭遇瓶颈的基础上，提出了铁水联运云平台的构建思路， 然后结合铁水联运信息化的业务发展需求和云计算核心技术与理念，设计了铁水 联运云平台的技术构架，并对云环境下的货运进出口业务流程进行了优化，为构 建面向联运大数据处理的铁水联运云平台奠定了构架基础。

西南交通大学博士研究生学位论文

第 87 页

第 4 章 云环境下的联运应用管理体系关键技术
结合铁水联运云平台的技术构架，研究云环境下联运应用的自动化构建，部 署和集群管理的关键技术，构建基于虚拟化和弹性计算的联运应用管理体系，不 但能大幅降低云平台对大量异构的联运业务应用的管理成本，也能为联运信息共 享和大数据应用的构建提供通用的虚拟资源管理服务。
4.1 问题提出
在传统的“烟囱式”构架下，不同的联运信息系统由不同的软件供应商提供 和管理，各系统独立建设，相互之间的软硬件架构差异较大，均由各自的服务器 资源、存储资源、网络资源等构成，其管理过程都采用人工手动完成，主要存在 以下问题：
(1) 系统部署成本高、周期长。由于各业务系统部署于独立的硬件环境，硬 件设备无法共享，每一个系统的部署都必须重复的经历采购、开发、安装、调测 等完整的建设周期，导致业务的部署时间较长；
(2) 系统交付模式不一致，缺乏通用性。由于应用的部署，配置和交付过程 以系统软件作为独立载体进行发布，自动化程度较低；同时系统之间的构架、配 置、版本等存在差异，只能以项目为单位进行独立管理，不具备通用性，软硬件 的维护往往需要数天/周的变更管理周期和数小时的维护窗口，导致系统的交付 效率低下，运维成本较高。
(3) 系统资源浪费严重，服务可靠性差。由于“烟囱式”构架的集中部署模 式可靠性较差，资源无法共享，新的业务系统对计算资源的增量需求与现有闲置 资源无法在多个系统之间共享的矛盾突出，导致目前铁水联运信息平台的整体服 务能力和可靠性无法有效提高。
由于上述问题，港口每上线一个新的业务系统就会背上一个包袱，而云平台 基于虚拟资源的管理构架，不仅能有效避免资源浪费，也为联运应用的管理过程 优化提供了契机。在云环境下，大量异构的联运应用集中运行在铁水联运云平台 的资源支撑体系上，且应用种类和实例数量也会随着用户数量、业务需求或请求 负载不同而动态变化。目前主流的 IaaS 云平台利用虚拟机避免了软硬件采购和 服务器安装工作，为用户提供了低成本的的计算服务，但若直接用于联运应用的

