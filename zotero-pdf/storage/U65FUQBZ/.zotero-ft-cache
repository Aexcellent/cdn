DOI:10.13546/j.cnki.tjyjc.2022.12.036

管理决策

基于多维长短时记忆网络的货运量预测
张冠东 1，杨 琛 2
（1.上海第二工业大学 应用统计教研室，上海 201209；2.武汉大学 经济与管理学院，武汉 430072）

摘 要：数据会因属性不同而被分别记录，但是这些数据具有时空上的相关性，因此他们可以被归为同一

种类进行分析，文章在长短时记忆网络(LSTM)的基础上，提出多维 LSTM 预测模型对同一类型不同属性的数据

进行同步预测。和传统的一维数据预测方法相比，多维 LSTM 预测模型的优势在于其在预测的同时能够反映不

同种类数据之间的关联性。货运量数据（铁路、公路和民航）实验的结果表明，多维 LSTM 的预测结果优于向量

自回归模型。

关键词：LSTM；向量自回归；货运量；预测

中图分类号：F222

文献标识码：A

文章编号：1002-6487（2022）12-0180-04

0 引言
在关于跨区域经济活动的研究中，货运量是最能够直 接反映经济系统整体活跃程度的指标之一。货运量的提 升表明系统内各区域的经济发展状况得到了显著的改 善[1]。因此货运量在宏观经济分析以及经济发展战略制定 等方面具有指导性的作用。当前阶段，主流研究聚焦货运 量与经济增长之间的相互关系[2]，从而为 GDP 和产业结构 的优化提供量化依据[3]。早期对货运量指标的预测主要依 赖于回归模型[4]。近年来出现不少以灰色预测模型为主的 方法来对货运量进行预测，例如严雪晴（2020）[5]利用灰色 预测模型对 2018—2022 年的广东省各类型货运量包括铁 路、民航和水路等进行预测分析。马睿和孟献刚（2020）[6] 通过建立灰色 GM（1，1）模型对陕西省铁路货运量进行预 测。赵龙和王晓峰（2020）[7]提出一种无偏灰色马尔可夫链 方法来预测民航货运量，该方法能够有效地消除灰度偏 差，并通过提高灰色预测模型的抗干扰性能，从而达到改 善预测稳健度的效果。然而此类方法的模型预测精度不 够，且其结果容易被外部因素影响。因此本文采用长短期 记忆（Long Short-Term Memory, 简称 LSTM）神经网络方法 对三种货运量指标（铁路、公路和民航）同时进行预测，并 将该方法与常用的时间序列分析方法（例如向量自回归模 型）进行比较研究。

与当前时点的模型分析从而达到保留历史信息的作用。 然而，在循环的过程中，RNN 容易产生梯度消失（Gradient Vanishing，即梯度变为零）或梯度爆炸（Gradient Exploding，即梯度趋于无穷或者溢出计算机最大限值）等计算方 面的问题。因此在实践中特定的预测任务一般会采用基 于 RNN 的各种衍生方法针对。
作为 RNN 的一种改进方法，LSTM 同样具备 RNN 能够 在隐藏层保留信息并以此对下一个时点进行预测的特 征。然而 RNN 在针对时间序列数据进行分析时只能够保 留非常有限的历史信息（类似于马尔科夫链或者一阶自回 归模型），因此在数据预测方面具有一定的局限性。作为 RNN 的一种改进方法，LSTM 能够在一定程度上解决梯度 退化的问题（但仍不能够解决梯度溢出的问题），并且还能 够通过增设遗忘门（Forget Gate）来控制用于预测下一时点 结果的信息，从而达到对于历史信息的灵活控制以改进预 测结果的目的。这种设计在实践中获得了良好的预测效 果[8,9]，LSTM 也因此在天气预报、环境污染监控以及股票价 格预测等领域得到了广泛的应用[10]。
作 为 一 种 非 线 性 预 测 模 型 ，LSTM 最 早 由 Sepp 和 Jürgen（1996）[11]提出，其最重要的工作原理是通过在 RNN 中引入开关门的机制从而对时间序列数据实现长短记忆 的存储。该方法流程如图 1 所示。

Ht - 1

Ht

Ht + 1

1 LSTM 神经网络模型

A

A

循环神经网络（Recurrent Neural Network，RNN）是一

种包含了循环结构的人工神经网络模型，适用于处理各种

Xt - 1

类型的序列数据。RNN 通过将前一时点的信息保留并参

Xt

Xt + 1

图 1 LSTM 深度学习网络模型

基金项目：上海第二工业大学应用数学学科项目（XXKPY1604） 作者简介：张冠东（1980—），男，浙江绍兴人，博士，讲师，研究方向：数据分析、机器学习。
杨 琛（1986—），男，四川成都人，博士，助理教授，研究方向：统计优化与保险精算。

180 统计与决策 2022 年第 12 期·总第 600 期

管理决策

在图 1 中，{X0,X1,…,Xt - 1,Xt,Xt + 1,…} 为目标时间序 列 。 其 观 测 值 可 作 为 LSTM 模 型 在 各 时 点 的 输 入 项 。

{H0,H1,…,Ht - 1,Ht,Ht + 1,…} 可以被认为是 LSTM 模型在

各时点的预测值（即输出项）。由输入产生输出的结构称

为（神经元）细胞（Cell），一般由输入门（Input Gate）、输出

门（Output Gate）以及遗忘门三个组件构成。然而这些组

件在 LSTM 的各类变体中并不是必需的，例如在门控循环

单元法（Gated Recurrent Units，GRUs）中就没有输出门。

总之，对于标准的 LSTM 而言，其细胞结构中的三个组件

可以具体表示为：

（1）遗忘门。该组件决定了需要遗忘（或者记忆）的信

息所占比例，其具体表达式为：

( ) ft

=σ

W

X f

Xt

+Vf

Ht - 1 + b f

（1）

其中，激活函数 σ(·) 为 Sigmoid 函数。因此遗忘门 ft

的取值范围是(0,1)，ft ≈ 0 表示应该删除之前输入的全部

信息，ft ≈ 1 表示应该保留之前输入的全部信息；Xt ∈ Rd

表示

t

时点的输入向量；W

X f

∈

Rd × d

表示输入权重矩阵；

V f ∈ Rd × d 表示遗忘门的权重矩阵；Ht - 1∈ Rd 表示前一时

点的输出向量；b f ∈ Rd 表示偏置权重。

（2）输入门。该组件代表了 t 时点的输入信息，其具

体表达式为：

( ) it = σ WiX Xt + Vi Ht - 1 + bi

（2）

Ct = tanh(WCX Xt + VC Ht - 1 + bC)

（3）

其中，Ct 为关于细胞状态更新的候选变量，其取值范

围为（-1，1）；而输入门 it ∈ (0,1) 则决定了该候选变量能

够进入细胞的信息占比。

（3）输出门。最后决定 t 时点输出项的组件，其具体

表达式为：

( ) ot = σ WoX Xt + Vo Ht - 1 + bo

（4）

Htot = tanh ⊙(Ct)

（5）

其 中 ，⊙ 为 哈 达 玛 积（Hadamard Product），Ct = ft⊙ Ct - 1 + it⊙Ct 表示细胞在 t 时点的状态。在更新后的细胞 状态 Ct 下，输出门 ot 决定了细胞状态中参与最终输出的 部分占比。这样根据时间序列的观测值就可以通过不断更

( ) 新 参 数 W fX,V f,b f,WiX,Vi,bi,WCX,VC,bC,WoX,Vo,bo 的

估计值来提升输出预测值 Ht 的精度。

2 实验数据及结果比较

2.1 数据来源及处理 对于预测模型的训练而言，数据量在原则上应该越大
越好。然而年代过于久远的历史数据由于与近期数据的 相关性较弱，未能充分反映近期内外部环境的信息，因此 在训练预测模型的时候反而会对训练结果造成无法评估 的影响。据此，本文采用国家统计局发布的 2005—2020 年的月度铁路、公路和民航货运量当期值数据作为原始的

三维时间序列观测值（共计 168 组观测值）。这些数据的

描述性统计如表 1 所示。

表1

铁路、公路和民航货运量当期值描述性统计

货运类型 最大值 最小值 中位数 平均值

铁路

39344

19800

30367

29728

公路 民航

392555 71

82736 17

236346 46

231041 44.75

(单位：万吨) 标准差 4326.857 85245.33 12.71368

2.2 实证结果分析

2.2.1 模型效果评价指标

通常针对模型预测效果进行评价的指标主要包括以

下 4 种：均方根误差（RMSE），平均绝对误差（MAE）、平均

误 差 百 分 比（MAPE）和 对 称 平 均 误 差 百 分 比（SMAPE）。

本文将使用这些指标来对传统计量方法（向量自回归法）

和 LSTM 的预测进行比较分析。假设将时间序列观测值 的最后 M 项 y1,…,yM 截取作为测试数据集，且将相应的 模型预测值记为 y1,…,yM ，那么这 4 种评价指标的具体 表达方式为：

（1）均方根误差：

γrmse =

Σ( ) M yi - yi 2
i=1
M

（6）

（2）平均绝对误差：

M
Σ| yi - yi |
γmae = i = 1 M

（7）

（3）平均百分比误差：

Σ γmape =

1 M

M| × ||
i = 1|

yi - yi yi

| ||| × 100%

（8）

（4）对称平均百分比误差：

Σ | | | | | | γsmape =

1 M

M
×
i=1

yi - yi yi + yi

× 100%

2

（9）

对于上述各评价指标而言，值越小表明预测精度越

高。

2.2.2 向量自回归模型

向量自回归模型（VAR）是一种基于数据统计性质所

发展出的模型，其利用所有变量种类中的当前值对滞后值

进行回归，从而将传统的单变量回归模型发展成为多变量

的回归模型，而这些多变量的组合就称为向量。

对于 t 时刻的 n 个变量，VAR（p）的数学模型可表示

为： p Σ Yt = v + Bi yt - i + εt,t = 1,…,T i=1

（10）

其中，Yt = ( y1t,y2t,…,ynt)' 为时间序列向量，v 为 n × 1

常向量；Bi 为 n × n 矩阵，i = 1,2,…,n ；εt 为 n × 1 误差向

量。

向量自回归模型在时间序列数据的分析方面有较为

广泛的应用，特别是在多个相关经济指标的分析与预测方

面。本文首先将原始的 2005—2020 年的月度铁路、公路

和民航货运量当期值数据中前 80%的观测值留下作为训

统计与决策 2022 年第 12 期·总第 600 期 181

管理决策

练数据集，而将余下的 20%数据留作检测数据集。考虑到

利用 VAR 建模的先决条件是模型序列必须近似平稳序

列，否则会导致伪回归现象的发生。因此，本文对所训练

数据集中采用逐项 ADF 单位根检验方法进行平稳性检

验。若 ADF 的检验的 P 值不低于临界值 1%，则训练数据

集需要进行进一步差分以在保留时间序列性质的前提下

提升其平稳性。具体的 ADF 检验结果如表 2 所示。

表2

ADF 检验结果（P 值）

测试序列 原始序列 一阶差分

铁路 0.67 <0.01

公路 0.07 <0.01

民航 0.31 <0.01

上述 ADF 检验的结果表明训练数据集经过一阶差分

之后，铁路、公路和民航三种货运量观测值均达到近似于平

稳序列的要求，故可以利用 VAR 进行建模。接下来本文需

要确定 VAR 模型的滞后项（Lag）参数。根据常用的施瓦

茨准则（Schwarz Criterion，简称 SC）系数作为滞后项参数，

选择最小 SC 值（见表 3）对应的滞后长度作为 VAR 的滞后

参数，本文训练数据的一阶差分适用于 VAR（2）模型。

表3

滞后长度检验结果

1

SC

37.91

2 37.85

3 38.11

4 37.85

5 38.10

最终拟合得到的模型为：

( ) ( ) yt - yt - 1 = A1 yt - 1 - yt - 2 + A2 yt - 2 - yt - 3 + μ

（11）

其中，A1

=

■-0.53 ■||-40.95

0.01 0.05
0

---76205..36.3936■■||, A2

=

■0.45 ■||1.034

0 -0.26
0

-74.51■ --7600.4.516■||,

μ

=

■ 98.49 ■ ■||2-7705.5.858■||

。

2.2.3 实验结果

将训练数据集、测试数据集和分别由 LSTM 和 VAR 得

到的各预测值分别作图，见图 2 至图 4。

图 2 至图 4 表明 LSTM 的预测曲线形状相较于 VAR 更

加接近于真实数据观测值，因此可以初步认为 LSTM 的预

测效果要优于 VAR 模型。为了量化 LSTM 和 VAR 这两种

方法的预测效果，分别计算实验中所使用到的各种评价指

标，结果见表 4。

表4

三种货运量预测检验结果

货运 类型 铁路
公路
民航

评价 指标
γrmse γmae γmape γ smape γrmse γmae γmape γ smape γrmse γmae γmape γ smape

LSTM
2576.101 2063.469 0.06003865 0.06078056 65658.23 42802.08 0.1990477 0.1742165 9.947996 6.887053 0.1360394 0.1288089

VAR（2）
3159.94 2778.22 0.07718907 0.0806265 76714.56 49715.09 0.2640345 0.1726971 13.195 9.133 0.190347 0.1523336

|LSTM-VAR（2）|/ VAR（2）×100%
18.48 25.73 22.22 24.61 14.41 13.91 24.61 0.88 24.61 24.59 28.53 15.44

注：LSTM 和 VAR（2）预测的 γrmse 和 γmae 单位均为万吨。下同。

铁路客运量

40000 38000 36000 34000 32000 30000 28000 26000 24000 22000
400000 350000 300000 250000 200000 150000 100000 50000
70

120 130 140 150 160 样本点
图 2 铁路货运量预测结果
120 130 140 150 160 样本点
图 3 公路运量预测结果

原始数据 向量自回归 LSTM
170 原始数据 向量自回归 LSTM
170 原始数据 向量自回归 LSTM

公路客运量

60

民航货运量

50

40

30

120 130 140 150 160 170 样本点
图 4 民航货运量预测结果
从表 4 的比较结果可以看出，在铁路货运量、公路货

运量和民航货运量的预测分析中，虽然 LSTM 的 γsmape 在

预测公路货运量时比相应的向量自回归指标略高，但是其

γrmse 、γmae 和 γmape 这三种评价指标值均低于 VAR（2）。并

且当使用|LSTM-VAR（2）|/VAR（2）×100%衡量 LSTM 相对

于 VAR（2）方法的预测效果提升率时，LSTM 预测的 γsmape

仅仅比 VAR（2）高出 0.88%。因此，从上述评价指标的对

比中可以进一步验证 LSTM 方法对于各种类型货运量的

预测效果普遍优于 VAR（2）模型。最后，本文还对这两种

方法在总体上的预测结果指标进行比较，结果见表 5。

表5

货运量总体检验结果

评价指标 γrmse γmae γmape γ smape

LSTM 37936.96 14957.48 0.1317086 0.1212686

VAR（2） 44328.73 17500.81 0.1771902 0.135219

|LSTM-VAR（2）|/VAR（2）×100% 14.42 14.53 25.67 10.32

从表 5 的分析结果也可以看出，LSTM 的总体预测效果

从各个评价指标的角度看均优于 VAR（2）模型，这进一步验

证了 LSTM 方法在总体上对于传统 VAR（2）模型的改进。

182 统计与决策 2022 年第 12 期·总第 600 期

管理决策

3 结论与建议
本文预测了铁路货运量、公路货运量和民航货运量。 通过和向量自回归模型的比较，本文证实了 LSTM 的预测 效果优于向量自回归模型。此外，由于数据运算速度也取 决于所需硬件设备的性能，因此在选择 LSTM 的隐藏层数 时，除了考虑精度以外也要考虑运算速度，以便在实际应 用中得到合理的效果。或者可以对传递函数进行优化从 而使得预测结果更加高效和精确。结合实验结果本文给 出建议如下：
（1）提升货运行业的风险管理水平。由于铁路、公路 和民航货运这几种货运方式各有优劣，如果能够了解他们 之间的相互关系，就可以通过监控货运方式中出现的异常 现象，对其他的货运方式做出相应的调整或预警，从而控 制货运行业的损失。因此，随着人工智能和大数据分析技 术的不断进步，这些技术可以被应用于货运的联动监控 中。
（2）提升预测结果的准度。由于货运量数据是一种时 间序列数据，因此在未来可以利用动态时间规整（Dynamic Time Warping）和货运量相结合的方式来进行研究。多 种指标的联合预测会使得预测结果更加接近真实值，从而 减少错判。
（3）推动货运和其他相关领域（例如货运保险、投资 等）研究的融合。货运行业是传统的行业，应该紧密地搭 上高科技发展的“顺风车”，促进信息技术所需的各种软硬

件的开发和应用。利用“互联网+”的优势，对不同用户制 定个性化服务。充分使用大数据技术为货运传统行业的 创新提供必要的支撑。
参考文献： [1]田珺,冉忠明.货物运输对城市经济发展的空间计量研究——基于
四大区域差异化的视角[J].经济问题探索,2019,(11). [2]徐涵.铁路货运量与国民经济发展的内在关系研究[J].铁道经济研
究,2020,(4). [3]李文杰,袁肖峰,杨胜发,等.基于投入产出模型的省际间货运量模
拟研究[J].铁道科学与工程学报,2020,17(5). [4]刘笑佟,任爽.基于不确定理论的铁路货运需求预测[J].运筹与管
理,2020,29(3). [5]严雪晴.基于灰色预测模型的广东省货运总量预测研究[J].数学的
实践与认识,2020,50(14). [6]马睿,孟献刚.基于灰色模型的铁路货运量预测——以陕西省铁路
货运为例[J].物联网技术,2020,10(4). [7]赵龙,王晓峰.基于无偏灰色-模糊-马尔可夫链法的民航货运量预
测[J].科学技术创新,2020,(32). [8]杨英,唐平.VAE_LSTM 算法在时间序列预测模型中的研究[J].湖南
科技大学学报(自然科学版),2020,35(3). [9]张旭东,杜家浩,黄宇方,等.基于多尺度层级 LSTM 网络的时间序列
预测分析[J].计算机科学,2019,46(S2). [10]葛娜,孙连英,石晓达,等.Prophet-LSTM 组合模型的销售量预测研
究 [J].计算机科学,2019,46(S2). [11]Sepp H, Jürgen S. LSTM can Solve Hard Long Time Lag Prob⁃
lems [J].Advances in Neural Information Processing Systems,1996, (9).
（责任编辑/刘柳青）

统计与决策 2022 年第 12 期·总第 600 期 183

