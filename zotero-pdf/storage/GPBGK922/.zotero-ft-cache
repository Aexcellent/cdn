分类号______________________________ ＵＤＣ______________________________

密级______________________________ 编号______________________________

全日制专业学位硕士论文
基于特征选择和算法融合的铁路货运需求预 测研究
学 位 申 请 人 ： 徐唯祎 学 科 领 域 ： 物流工程 校 内 导 师 ： 周湘峰 副教授 校外导师：

答辩日期：

独创性声明
本人郑重声明：所呈交的学位论文是我个人在导师指导下进行的研究 工作及取得的研究成果。尽我所知，除了文中特别加以标注和致谢的地方 外，论文中不包含其他人已经发表和撰写的研究成果，也不包含为获得华 东交通大学或其他教育机构的学位或证书所使用过的材料。与我一同工作 的同志对本研究所做的任何贡献均已在论文中作了明确的说明并表示了谢 意。
本人签名_______________日期____________

关于论文使用授权的说明
本人完全了解华东交通大学有关保留、使用学位论文的规定，即：学 校有权保留送交论文的复印件，允许论文被查阅和借阅。学校可以公布论 文的全部或部分内容，可以采用影印、缩印或其他复制手段保存论文。
保密的论文在解密后遵守此规定，本论文无保密内容。

学生本人签名 校内导师签名 校外导师签名

日期 日期 日期

摘要
基于特征选择和算法融合的铁路货运需求预测研究
摘要
需求预测是铁路货运组织和规划的基础。准确预测铁路货运需求，探索不同因素对 铁路货运需求的影响程度，是科学制定铁路运输计划的前提，同时对于国家未来的铁路 建设投资方向有重要的参考价值。铁路货物运输需求的实现需要一定的运输能力作为保 证，它是市场需求与自身供给的制衡结果。铁路货物周转量是能综合反映宏观环境对货 物运输的需要以及运输部门提供的货运工作总量的重要统计指标。因此，本文采用货物 周转量作为反映铁路货运需求的替代性指标进行研究。
本文首先通过文献梳理及资料分析，分别从宏观经济、物流环境、政策影响和铁路 供给等四个角度入手，深入分析了不同影响因素对铁路货运周转量的作用机理，并结合 模糊决策理论和机器学习方法，构建了一种多阶段混合式的特征选择方法。其次，采用 随机森林回归算法建立铁路货运周转量预测模型。考虑到标准随机森林回归算法中通常 采用经验参数，但这难以确保模型的预测性能最佳，因此本文提出采用灰狼算法对随机 森林的参数组合（ntree , mtry）进行优化，确定了基于灰狼算法优化的随机森林预测模型。 然后，以南昌铁路局 2008-2017 年这 10 年间的影响因素数据集为基础进行实证分析， 利用本文构建的特征选择算法筛选得到货车平均通过总重、公路货运量、货物日均卸车 数、第二产业增加量、机车平均全周转时间、货仓总使用面积、货车旅行速度、装卸机 械化比重、居民消费水平、货车周转时间、装卸全员劳动生产率、货物日均装车数、货 场总建筑面积、机车平均牵引总重等 14 项铁路货运周转量的关键影响因素作为最优特 征子集，并将其输入不同参数寻优下的随机森林模型对铁路货运周转量进行预测。通过 对比分析实验结果，发现灰狼算法优化下的随机森林具有最佳的预测精度及计算效率， 验证了该模型的可行性与有效性，可运用于铁路货运需求预测工作。
本文的创新点主要有两点：第一，针对现有特征选择方法的不足，结合模糊决策理 论和机器学习思想提出一种新的多阶段混合式特征选择方法，并得到铁路货运需求的关 键影响因素，从而为调控铁路货运需求提供政策建议；第二，在得到关键影响因素的基 础上，建立基于灰狼算法优化的随机森林预测模型，准确预测铁路货运需求，从而为铁 路部门制定运输计划提供依据。
关键词：铁路货运，需求预测，特征选择，随机森林，灰狼算法
I

Abstract
Research on Railway Freight Demand Forecasting Based on Feature Selection and Algorithm Fusion
ABSTRACT
Demand forecasting is the foundation of railway freight organization and planning. It is the prerequisites for scientifically formulating railway transportation plans to predict the demand for railway freight accurately. Meanwhile, exploring the different impact levels of tnose factors on railway freight demand can make great reference value for the future investment direction of railway construction of the country. The realization of the demand for railway freight transportation requires a certain transportation capacity as a guarantee, which is the result of a balance between market demand and its own supply. Railway freight turnover is an important statistical index that can comprehensively reflect the demand of the macroscopic environment for freight transportation and the total amount of freight work provided by the transportation department. Therefore, this paper adopts the freight turnover as an alternative index to reflect the demand of railway freight.
This paper first analyzes the effects of different influencing factors on railway freight turnover by combining the literature review and data analysis from four perspectives: macroeconomics, logistics environment, policy impact, and railway supply, a multistage hybrid feature selection method was built combined with the fuzzy decision theory and machine learning methods. Secondly, a stochastic forest regression algorithm is used to build a railway freight turnover forecast model. Considering that empirical parameters are usually used in standard random forest regression algorithms, which is difficult to ensure the best predictive performance of the model. Therefore, an optimized RF model by gray wolf algorithm was proposed in this paper. Then, conductd an empirical analysis based on the Nanchang Railway Bureau's 2008-2017 influencing factors data set, Using the feature selection algorithm constructed in this paper, 14 key factors affecting railway freight turnover were screened out. The optimal feature subset was input into a random forest model with different parameters to predict the railway freight turnover. By comparing and analyzing the experimental results, it is found that the GWO-RF model has the best prediction accuracy and calculation efficiency, which verifies the feasibility and effectiveness of the model and can be used for the forecasting of railway freight demand.
There are two main points of innovation in this paper: firstly, aiming at the shortcomings of the existing feature selection methods, a new multi-stage hybrid feature selection method is proposed by combining fuzzy decision theory and machine learning, and the key influencing factors of railway freight demand are obtained, so as to provide policy Suggestions for the regulation of railway freight demand. Secondly, based on the key influencing factors, a random forest prediction model optimized by grey wolf algorithm is established to accurately
II

Abstract
predict the demand of railway freight, so as to provide a basis for railway departments to make transport plans. Key Words: Railway freight, demand forecast, feature selection, random forest, gray wolf
algorithm
III

目录
目录
第一章 绪论 ............................................................................................................................ 1 1.1 研究背景和意义 ........................................................................................................ 1 1.1.1 研究背景............................................................................................................ 1 1.1.2 研究意义............................................................................................................ 2 1.2 国内外发展现状及研究综述 .................................................................................... 3 1.2.1 铁路货运需求影响因素的机理研究................................................................ 4 1.2.2 货运需求影响因素的选取................................................................................ 5 1.2.3 机器学习理论在货运需求预测中的应用........................................................ 7 1.3 本文主要工作 ............................................................................................................ 7 1.3.1 研究目标............................................................................................................ 7 1.3.2 研究内容及研究方法........................................................................................ 8 1.3.3 技术路线............................................................................................................. 9
第二章 铁路货运需求影响因素机理分析 .......................................................................... 10 2.1 宏观经济因素.......................................................................................................... 10 2.2 政策因素.................................................................................................................. 13 2.3 行业竞争因素.......................................................................................................... 15 2.4 自身供给因素.......................................................................................................... 17 2.5 本章小结.................................................................................................................. 18
第三章 货运需求预测模型的特征提取与特征选择 ............................................................ 19 3.1 特征选择算法的基础理论...................................................................................... 19 3.1.1 过滤法（Filter） ............................................................................................. 19 3.1.2 封装法（Wrapper） ........................................................................................ 21 3.1.3 嵌入法（Embedded）..................................................................................... 22 3.2 货运需求预测模型的特征选择.............................................................................. 25 3.2.1 相关算法说明.................................................................................................. 25 3.2.2 融合机器学习和模糊决策的特征选择算法.................................................. 27 3.3 本章小结.................................................................................................................. 28
第四章 基于随机森林的货运需求预测模型 ...................................................................... 29 4.1 相关算法说明.......................................................................................................... 29 4.1.1 随机森林简介.................................................................................................. 29 4.1.2 灰狼优化算法简介.......................................................................................... 31 4.2 预测模型的构建...................................................................................................... 33
IV

目录
4.3 模型评估和模型选择.............................................................................................. 35 4.3.1 评估指标.......................................................................................................... 35 4.3.2 交叉验证.......................................................................................................... 36
4.4 本章小结.................................................................................................................. 37 第五章 实例研究 .................................................................................................................. 38
5.1 南铁集团概况.......................................................................................................... 38 5.2 数据预处理.............................................................................................................. 40 5.3 货运需求影响因素的特征提取.............................................................................. 41
5.3.1 影响因素的二元比较排序.............................................................................. 41 5.3.2 影响因素的重要性排序.................................................................................. 42 5.3.3 关键影响因素的选取...................................................................................... 43 5.4 南铁货运需求预测.................................................................................................. 46 5.4.1 建立预测模型.................................................................................................. 46 5.4.2 预测效果对比及分析...................................................................................... 48 5.5 本章小结.................................................................................................................. 50 第六章 总结和展望 .............................................................................................................. 51 6.1 全文总结.................................................................................................................. 51 6.2 研究展望.................................................................................................................. 52 6.3 政策建议.................................................................................................................. 52 参考文献 .................................................................................................................................. 54 个人简历 在读期间发表的学术论文 .................................................................................. 58 致谢 .......................................................................................................................................... 59
V

第一章 绪论
第一章 绪论
1.1 研究背景和意义
1.1.1 研究背景 铁路是我国重要的交通基础设施、国民经济大动脉和大众化的交通工具，因其具有
绿色、经济、便民、安全等特点，在我国综合交通体系中占有举足轻重的地位[1]。由于 中国铁路运输系统具有运输能力强以及运输距离远的特征，在大宗货物运输及长途运输 当面有着巨大的优势，对促进我国经济发展至关重要，已成为我国经济发展不可或缺的 组成部分。
目前，我国进入了经济转型的新阶段，然而，在经济仍旧保持中高速增长的情况下， 铁路货运量似乎已进入一个绝对数量连续下降的通道。据统计，2011—2015 年，我国 GDP 的年均增长率从 10％左右降至低于 7％，与此同时，铁路货运量从 2014 年起连续 出现 3.90％和 10.53％的负增长，于 2016 年上半年同比下降 7.41％，呈加速下滑的趋势 [2]。另一方面，根据 2013 年 1 月到 4 月的全国货运量统计数据显示：路运、水运和民航 运量都分别同比增长了 10.5%、9.3%、4.8%，快递量迅速增长了 64.3%，而只有铁路运 量同比下降了 2.4%，铁路货运量占全社会货运比重呈现出下降趋势。在全社会物流需 求持续高涨的情况下，铁路企业正逐渐失去在市场中的竞争力，我国铁路货运亟待转型 以谋求更好的发展[3]。
铁路运输向现代化物流企业转型是铁路货运改革的第一步。近年来，随着铁路信息 化步伐的加快，铁路行业在数据分析方面已经开展了大量的前期工作，并在货运需求分 析技术、设备故障分析技术、建立站段运输信息集成平台等方面取得了一定成效[4]。其 中，对铁路运输需求的预测正是重点发展的技术之一。例如，由于铁路线网资源不足， 加之机车车辆由于资金不足且投入不够，使得铁路总体运输资源稀缺，基本处于供不应 求的状态，同时，铁路既有线路客货混用，管理难度较大，最终导致客货运输服务水平 难以提升[5]。图 1-1 展示了铁路持有货运机车总量的供需情况。
但是，随着全国高速铁路网和城际铁路网逐步建成，预计到 2021 年，“高铁战略” 初步达成时，将累计使得超过 13 亿吨的运输能力得到释放。截止 2018 年底，高铁已累 计释放 6.7 亿吨运能，货运增长空间看好。由此可见，在铁路货运改革的背景下，货运 供给的质变也必将引起货运需求的量变。因此，探究不同因素对铁路货运需求的影响， 从而准确预测货运需求的变化趋势，对于把握铁路的货改方向，提高铁路市场竞争力有 重要作用，是当前铁路运输领域的研究热点[6]。
铁铁路货运系统具有较高的复杂性和动态特性，随着其所处的环境变化而变化。为 了达到预测的科学性与合理性，需要全面分析并筛选影响铁路货运需求的内外部因素。
1

第一章 绪论
铁路货运需求的影响因素错综复杂，相关文献研究表明，铁路货运需求的影响因素有国 内 GDP、其他运输形式的货运量、相关政策、主要工业和农业产品的产量及铁路货运公 司的技术和管理水平[7]。
数据来源：国家铁路局 http://www.nra.gov.cn/xwzx/zlzx/hytj/201804/t20180412_55248.shtml。 图 1-1 2011-2018 年铁路持有货运机车供需量关系
Fig.1-1 Supply and demand of railway freight locomotives in 2011-2018
然而，当前对这些影响因素与铁路货运需求的之间的因果关系尚不明确，也缺乏可 靠的量化分析数据证实其相关程度。因此，对这些因素的影响机理进行分析与选取，并 建立精确有效的预测模型，是当前货运需求预测领域的研究重点与研究难点。 1.1.2 研究意义
铁路运输方式与其他的运输方式相比，铁路货物运输具有较为明显的优势，在我国 运输体系中占有不可忽视的重要地位。通过对铁路货运需求的预测研究，能够把握影响 货运需求的关键因素，从而为铁路货运系统发展提供政策建议。
（1）理论意义 分析关键影响因素对铁路货运需求的影响程度。利用定性分析不同影响因素对铁路 货运需求的作用机理，进而结合模糊决策理论和机器学习方法，定量分析影响因素对铁 路货运需求的影响程度，从而选取关键影响因素。目前，常见的铁路货运预测方法如时 间序列预测法只利用历史数据对结果进行预测，不考虑货运需求对其预测结果产生的影 响，使得预测结果存在偏差。然而，影响铁路货运需求的因素常常具有较大不确定性和 较强的时效性，随着时间的推移不断发生变化，且可能会出现新的影响因素[8]。因此， 在对铁路货运量预测时需充分考虑多种因素的影响，对于预测结果的准确性优于传统的
2

第一章 绪论
基于历史数据的预测方法。本文通过定性分析和定量筛选的有效结合，提高了货运需求 预测模型的完整性和精确性，并且获得铁路货运需求与关键影响因素之间的因果关系。
对未来的铁路货运需求进行预测。铁路货物周转量作为市场经济体系中的重要统计 指标，准确对其进行预测对铁路相关建设项目经济性评价和国家及社会资源的配置至关 重要[9]。随着科技进步和经济发展，传统方法对铁路货运需求的预测能力存在局限，需 要加以补充。科学合理地预测铁路货运需求不仅能丰富预测理论，而且有助于探索货运 需求预测的新思想、新方法。
（2）实际意义 精准的需求预测在铁路货运组织中发挥基础性作用，同时也成为铁路网规划的先决 条件，可有效指导铁路项目建设和相关产品的开发。铁路货运改革对铁路货运发展模式 提出新的要求，从以往的运力满足型向需求拉动的市场导向型生产营销模式转变。因此， 如何精准的预测铁路货运需求对提高铁路运输系统的运营水平和铁路运输行业的健康 发展至关重要。 当前，我国铁路货运信息化也经历了不断进步与完善，铁路货运电子商务平台为信 息化的提升提供了海量的数据。但是，铁路管理部门未对其进行进一步分析和处理，处 理方式较为单一，且未对其和外部数据进行关联分析[10]。因此，常常无法找出数据与数 据之间的相关性，无法有效利用数据的潜在价值供决策者进行利用，更无法指导铁路相 关管理部门提前安排运力，从而也在一定程度上阻碍了营销部门制定有针对性的货运营 销决策。货运需求是衡量铁路货运发展竞争力的关键核心因素，有效利用铁路信息系统 中存储的海量数据，对精准预测和把握未来货运需求的发展趋势具有重要作用，越来越 成为铁路部门制定铁路网规划方案的重要依据。因此，研究如何精准预测铁路货运需求 量对铁路货运的发展具有重要意义。 另一方面，铁路货运需求常常和经济发展状况、公转铁、运输管理水平等相关，某 些影响货运需求的因素不容易定量表示，导致铁路货运需求预测存在模糊性。本研究结 合定性分析与定量分析，系统地研究了外部需求因素和内部供给因素对铁路货运需求的 影响，有助于相关铁路部门利用调整影响因素来调控铁路货运需求。通过分析各因素对 货运需求的影响程度并进行筛选，可为铁路运输企业制定市场营销计划提供参考，为铁 路相关政策的制定以及国家未来的铁路建设投资方向提供依据。
1.2 国内外发展现状及研究综述
因为铁路运输系统的复杂性和特殊性，使得铁路货运需求体现的不单是市场需求， 而是市场需求和内部供给的制衡结果[11]。迄今为止，国内外学者已开展大量研究对铁路 货运需求进行预测，并不断探索着预测方法的创新。在铁路货运需求预测的研究领域中， 相较于国外，国内的研究成果更为丰富。这是由于我国的铁路行业是计划经济产物，是 属于自然垄断的市场垄断，其管理机制兼具企业行为特点和政府行为特点，且处在经济
3

第一章 绪论
转型的改革阶段；而在国外，尤其是俄罗斯、美国、日本等发达国家，已建立以市场需 求为导向的成熟的铁路货运管理体系[12]。因此，国内研究人员对中国特色铁路运输的研 究更加全面，也更具有针对性。目前，研究重点主要聚焦在三个方面：一是对铁路货运 需求影响因素的机理研究；二是对货运需求影响因素的选取研究；三是对货运需求预测 模型的研究。
1.2.1 铁路货运需求影响因素的机理研究 铁路货运系统是多因素、多层次的复杂系统，与许多因素密切相关。在货运需求的
预测过程中，有些预测方法并不需要考虑货运需求的影响因素，只需要输入相关历史数 据，对数据进行操作和训练，如时间序列预测方法；有些方法则必须考虑影响因素，如 回归分析预测和系统动力学预测等[13]。因此，本文在对货运需求进行预测时充分考虑影 响因素对预测结果准确性的影响，相比于仅依靠历史数据进行预测可有效提高预测的准 确性。
迄今为止，对影响货运需求的因素的机理分析愈加完善。综合现有研究成果，可将 影响货运需求的因素划分为两类：一是铁路货运需求侧的影响因素；二是铁路货运供给 侧的影响因素。
铁路货运需求是市场引致需求，具有明显派生属性。最终形成的铁路货运需求量， 与社会生产发展及人民生活水平密切相关，故而分析铁路货运需求影响因素应该从需求 侧入手。通过梳理关于铁路货运需求的文献，可以发现需求侧因素以宏观经济指标和大 宗货物产量指标为主。宏观经济指标如国民生产总值、第二产业生产总值、第三产业生 产总值、居民消费水平是被关注最多的几个指标[14]。国民生产总值度量了一定时期内经 济活动市场价值的总和，是一个国家或地区市场需求总量的最佳度量指标。其次，铁路 货运需求包括生产过程中对原材料消耗所产生的空间位移需求[15]。近年来，我国经济结 构发生重大变化，传统的高耗能、高污染的第二产业占比逐渐降低，低耗能、效益较高 的第三产业占比日益上升，而工业产业中的主要能源如原油、煤炭、铁矿石等大宗货物 在铁路运输货物品类中占据相当比重的份额，因此，第二产业生产总值和第三产业生产 总值被很多研究人员纳入影响因素的范畴。另外，由于居民消费水平及结构能在一定程 度上反映经济发展水平甚至技术水平，与产业结构等因素对铁路货运变化具有交叉性影 响，很多研究中也将其作为需求侧影响因素之一。上述因素都是中长期需求侧因素，短 期需求侧因素也不容忽视。经济周期反应了市场需求总量的短期变化规律，也是重要的 需求侧因素之一[16]。
市场需求只是形成最终货运需求的条件之一，铁路系统内部的自身限制性因素决定 了另一个条件，及铁路货运供给能力。铁路货物运输需求的实现需要一定的运输能力作 为保证，它是需求侧因素和供给侧因素制衡下的最终结果。供给侧因素包括三点：铁路 货运技术、综合运输体系和国家运输政策。就铁路货运技术而言，发达国家的货运供给 能力早已进入相对成熟的阶段，对铁路货运需求的影响不大。但在我国，国家对铁路路
4

第一章 绪论
网建设投入的重视，以及不断上升的铁路运输装备水平，给中国铁路运输系统在市场份 额的竞争中提供了有力条件[17]。基于此，营运里程、货车拥有量、复线里程比重、电气 化率等指标均当视为铁路供给侧影响因素。铁路运输只是综合运输体系中一种运输方式， 与公路、水路、航空、管道这四种运输方式之间既存在替代关系，也存在互补关系。从 替代关系来看，在物流环境变化的情况下，其余四种运输方式会与铁路运输构成此消彼 长的竞争关系；从互补关系来看，当货物的空间位移需要多种运输方式协作完成时，即 采取多式联运的方式，也会对铁路货运需求造成影响。另外，国家运输政策可以改变货 运市场的结构，因此国家运输政策在供给侧因素也很重要。例如，2016 年起前面推行的 “营改增”计税模式，会对铁路运输企业的运输成本结构造成影响，从而势必会引起铁 路货运需求的变化[18]；而 2018 年“公转铁”政策的落地，是国家给予铁路部门的政策 机遇，必将推动铁路货运量的上升[19]。
1.2.2 货运需求影响因素的选取 早期研究中，有些研究学者运用定性分析的方法分析铁路货运需求的影响因素。但
是这种仅依靠定性分析确定模型输入变量的方法不仅缺乏理论依据，而且可靠性不高[20]。 在定性分析的基础上，国内外研究学者通过定量分析各因素对货运需求的影响程度
的方法来对初始指标进行筛选。主要方法包括回归分析方法、VAR 模型方法、灰色关联 分析方法和基于机器学习的特征选择方法。
崔淑华[21]等人利用主成分回归分析法探究了公路货运量与常用指标因素间的隐性 关系，但该方法在降维过程中可能损失有效信息，影响因子的权值系数不够准确；Yang[22] 等人分别利用四种多元线性回归方法证明了人均 GDP、第一产业总值、第二产业总值、 第三产业总值以及社会消费品零售总额是影响铁路货运量的关键因素；De[23]等人基于最 小二乘回归方法，研究了人口密度、商业密度、土地利用率等建筑环境变量对城市货运 量的影响，并以此为城市货运站点的选址决策提供依据。
向量自回归（Vector Autoregression Model , VAR）模型，是将模型中的当期变量对 所有变量的若干滞后变量进行回归的一种计量经济学模型。VAR 模型可用来分析多个相 互关联的内生变量之间的动态关系，并且可量化分析某因子每单位变化对整个系统的贡 献量，因此在多个领域得到广泛应用。文书生[24]等人通过建立 VAR 模型，发现短期内 国民经济是铁路货运量变化的关键影响因素，长期来看，货运量对国民经济的增长响应 度较差，受铁路网运营情况影响显著，铁路货运量随铁路运营里程的增加而增加； Nuzzolo[25]等人则利用 VAR 模型，深入挖掘了在城市物流政策下，不同物流服务主体对 运输方式、货运周期、车辆类型和周转距离等运输决策之间存在的关系；Gelhausen[26] 等人则根据 VAR 模型，预测在 2016-2018 年，当 GDP 需求弹性为 1.31 时，德国机场客 运量将增加 3.28%。
尽管多元线性回归与 VAR 能分析不同因素的影响程度，但这两种方法的局限性在 于，模型应用均隐含了一定的假设前提，另外，运用这些数理统计方法进行分析和预测
5

第一章 绪论
时，对数据样本规模的要求较高。 灰色关联度分析法是目前的主流特征选择方法之一，并在铁路货运影响因素的相关
研究中得到了广泛应用。该方法通过计算不同影响因素与货运量之间的关联度，并对各 关联度的大小次序进行描述，从而得出各个影响因素对货运量的影响程度。张戎[27]等人 通过灰色关联分析法，分别研究了 2004—2011 年和 2012—2017 年两个阶段中，铁路货 运量与内外部影响因素的关联程度；叶艺勇[28]等人通过计算影响因素与物流货运量之间 的关联度，确定影响货运量预测精准度的因素；梁宁[29]等人采用灰色关联分析确定了各 影响因素的权重，并将被赋予权重的影响因素作为输入，构建了一种基于混合核函数的 支持向量机对铁路货运量进行预测；游艳雯[30]等人运用灰色关联法，定量分析了铁路货 车周转时间与各影响因素间的关联度，并得到货车中转距离、一次货物作业时间、货车 中转停留时间是关键影响因素的结论; Wan[31]等人结合灰色关联分析和小波神经网络算 法构建了铁路货运量预测模型，并利用实例验证了该模型具有较快的收敛速度和较高的 预测精度。大量研究表明，灰色关联度分析对于一个系统发展变化态势能提供量化的度 量，因此非常适合铁路货运的动态历程分析。
以上研究均以相关系数或关联度衡量各因素对货运量的影响程度，然而，关联度或 相关系数只能代表 2 组数据变化趋势的相似性[32]。铁路货运的影响因素繁多，且相互之 间存在复杂的非线性关系，若忽略不同影响因素之间的相互作用，势必会影响预测模型 的预测精度和鲁棒性。在此背景下，机器学习算法的兴起为特征选择提供了新的思路， 多位学者对其展开了深入研究。颜保凡[33]等人利用 BP 神经网络构建了影响因素与货运 量的映射关系，在此基础上利用权积法求解货运量对各因素的敏感度系数，并得到营业 里程、货车保有量、货运密度和机车平均牵引总重为关键影响因素的结论；武华华[34] 等人基于随机森林算法对航运干散货运价（BDI）指数的影响因素进行了重要性排序， 为科学制定航运市场调节方案提供了理论基础；李丽辉[35]等人采用随机森林的 OOB 残 差均方对客流影响因素的重要性进行评估，研究发现出发日期及运行时间是影响短期客 流的关键因素；Lim S[36]等人结合随机森林模型和阶段性回归模型对海运运费进行预测， 从 16 项初始指标中筛选得到 10 项关键影响因子，并得到精度较高的预测结果。
综合现有研究可知，关于铁路货运需求影响因素的变量选择大多聚焦在经典的几种 方法，然而在特征工程领域，有更多元且高效的特征选择策略可供挖掘。Speiser[37]等人 利用线上的开源数据，评估了不同类型的数据集适用的随机森林特征选择方法，从而为 不同系统和应用环境下的特征选择策略提供依据；Kamel [38]等人提出了一种灰狼算法 (GWO)与支持向量机(SVM)相结合的特征选择方法，实验结果证明，该算法使得诊断乳 腺癌的准确率较以往提高了 27.68%；Sebastián[39]等人通过比例因子技术惩罚特征集的基 数，并与两个用于处理类不平衡问题的支持向量机(SVM)公式结合使用，提出了一种新 的特征选择方法来处理机器学习中数据具有高维性和类不平衡性的难点。
6

第一章 绪论
1.2.3 机器学习理论在货运需求预测中的应用 迄今为止，传统的货运需求预测方法主要有时间序列法、灰色预测法、自回归差分
移动平均(autoregressive integrating moving average，ARIMA)、组合预测法等[40-43]。然而， 无论是传统的回归预测模型或是时间序列预测模型，通常以数学理论和若干假设前提作 为基础，通过演绎推理进而建立数学模型[44]。组合预测方法虽能在一定程度上综合不同 模型的优点，但组合赋权的问题难以解决。因此，这些方法对于从本质上解释动态数据 的内在关联和复杂特性的能力有限。随着人工智能技术的推广，基于机器学习的预测方 法在货运需求预测领域开始兴起，取得了丰硕的研究成果。
林昊[45]在分析影响物流需求的四个经济指标的基础上，建立了三层 BP 神经网络模 型来预测福州市的物流需求；倪继娜[46]等人结合影响因素分析，构建了预测大秦铁路煤 炭运输需求的人工神经网络模型，并预测了 2020-2025 年间大秦铁路的煤炭运输年需求 量；耿立艳[47]等人提出一种基于果蝇算法优化的混合核最小二乘支持向量机的预测方法， 经试验验证，该模型在保证泛化能力和预测精度的同时，计算速度更快，寻优能力更强， 能适用于铁路货运量的短期预测；周程[48]等人为预测货运量的非线性成分，构建了一种 基于时空调整策略改进的 PSO 算法优化的 BP 神经网络，通过模型对比和分析，改进 PSO-BP 模型具有收敛更快和预测精度更高的优点；Plakandaras[49]等人分别利用机器学 习方法、VAR 方法、多元回归方法建立了模型，并对航空、公路和铁路运输需求进行了 预测，实证结果表明，相比传统的数理统计模型或是计量经济学模型，基于机器学习理 论的预测模型能得到更准确的预测结果；Moscosolopez[50]等人分别建立了基于人工神经 网络和支持向量机的两种模型，对未来一周内港口的货物日吞吐量进行预测，通过对比 分析，发现两种模型拟合效果都很好，且支持向量机模型的预测精度略高于人工神经网 络模型。
然而，目前用于预测铁路货运需求的机器学习模型大多聚焦在支持向量机和神经网 络，对其他机器学习考虑较少。另外，我国铁路因为自身运营系统的特殊性，相关数据 呈现为较典型的高维小样本特征，因此相比 SVM 和 ANN，随机森林模型更适用于此类 样本的预测工作[51]。Barbour[52]等人使用三种经典机器学习算法以预测铁路货物列车到 达时间，实验结果显示，随机森林模型的预测性能最好，与统计基线预测值相比，平均 误差减少高达 42%；Lei C[53]等人采用粒子群优化算法(PSO)对随机森林和支持向量机进 行超参数优化，结果表明，无论是否对输入特征进行降维处理，PSO-RF 模型都比 PSO -SVM 模型具有更强的鲁棒性。
1.3 本文主要工作
1.3.1 研究目标 在经济新常态的宏观背景下，铁路货运在运输体系中的地位面临着严峻挑战。本文
7

第一章 绪论
旨在建立一套科学准确的分析方法和预测模型，为准确评估铁路货运需求提供理论支撑， 并通过对关键影响因素的分析，为铁路部门的货运组织计划提供决策依据，为国家把握 货运改革方向提供参考性的政策建议。 1.3.2 研究内容及研究方法
本文构建了基于特征提取的货运需求预测模型，并以南昌铁路局为例，验证了其有 效性。本文主要研究内容分为以下六个部分进行阐述。
第一章为绪论。本章节主要介绍铁路货运需求预测的研究背景、研究意义、国内外 研究现状，以及本文的研究目标、研究内容和技术路线。
第二章分析了各影响因素对货运需求的影响机理。本章节通过梳理文献，分别从四 个方面整合了现有研究中被广泛认可的货运需求影响因素，并就它们对铁路货运需求的 影响机理进行了深入分析和总结。
第三章首先阐述了特征选择的思想及其对于机器学习算法的重要性，然后通过归纳 现有研究中的特征提取方法体系，在前人研究的基础上，构建了一种融合模糊决策理论 和机器学习方法的多阶段混合式特征选择方法，为后文中货运需求关键影响因素的选取 做好工作准备。
第四章构建了基于算法融合的货运需求预测模型。首先对研究所涉及到的灰狼优化 算法和随机森林算法进行了相关理论说明，然后提出了利用灰狼算法对随机森林算法进 行改进，即寻找最优参数组合，从而构建了基于参数优化的随机森林预测模型。
第五章进行铁路货运需求的实证研究。基于第三章和第四章的理论基础上，将第二 章中初步选取的影响因素进行排序，从而选取关键影响因素。然后将这些关键影响因素 作为输入，基于构建的模型得到预测的货物周转量，并通过评估和对比验证了模型的有 效性和鲁棒性。
第六章对本文的研究内容进行总结得出结论。其次，结合当前铁路货运情况及本文 研究提出研究的创新点与不足之处；然后，通过对货运需求影响因素的量化分析及预测 结果，从市场需求和铁路自身供给两方面对铁路运输今后的改革方向提出政策建议。
8

1.3.3 技术路线

第一章 绪论

图 1-2 技术路线图 Fig.1-2 Technology roadmap
9

第三章 货运需求预测模型的特征提取与特征选择
第二章 铁路货运需求影响因素机理分析
在进行铁路货运需求预测的研究工作中，对影响铁路运输能力的因素进行筛选和提 取是至关重要的一步。然而，铁路运输系统是一个受多种因素共同作用的复杂动态系统， 具有不确定性、随机性和模糊性[54]，过多的冗余数据不仅会增加预测模型的复杂度，且 对提高预测精度无益。因此，对影响铁路需求预测的各因素的影响机理进行分析是首要 的工作。
货物周转量是运输企业所运货物吨数与其运送距离的乘积，以复合指标吨公里或吨 海里为单位表示，是综合反映一定时期内国民经济各部门对货物运输的需要以及运输部 门为社会提供的货物运输工作总量的重要统计指标[55]。相比货物发送量，该指标能更全 面地反映运输部门对社会货运需求量的承受能力，有助于科学分析货运需求的影响因素 并进行预测。
以目前形势来看，铁路货运需求的影响因素主要可分为两大类，即社会需求因素和 铁路自身供给。结合铁路运输的特点，其社会需求因素可归纳为宏观经济、政策调整、 物流环境变化 3 个方面，各方面对货运周转量的影响如图 2-1 所示。同时，通过查询国 家统计局网站 http://data.stats.gov.cn/，本文结合各影响因素历年的数据变化，对其作出 相应的影响机理分析。
图 2-1 铁路货运需求影响因素 Fig.2-1 Factors of railway freight demand
2.1 宏观经济因素
一个国家或地区的经济状况是运输供给发展的基本条件与决定性因素。经济发展产 生运输需求的同时，产生了供给。另一方面，经济水平的高低影响着运输需求的数量和 结构，从而对运输供给的规模和结构产生影响。通过对文献的梳理及定性分析，本文初 步选择国内生产总值、第二产业生产总值、社会消费品零售总额和居民消费水平作为影 响货运量的宏观经济指标。
10

第三章 货运需求预测模型的特征提取与特征选择

（1）国内生产总值 国内生产总值（Gross Domestic Product, GDP）是指一个国家或地区在一定时期内生 产的全部最终产品和服务价值的总和，它与国民生产总值（GNP）均是衡量国家经济发 展总水平的重要指标，但是 GNP 所反映的是 GDP 与来自国外或地区外的净要素收入之 和，而本文所探讨的单指中国铁路总公司在国内运营并发生的铁路货运量，由于中外合 作或其他原因在国外产生的铁路货运业务不在计算范围内，因此这里选用 GDP 作为货 运量的影响因素之一会比选用 GNP 更合理。如图 2-2 所示，近些年来，我国经济发展 态势良好，正处于经济结构转型的过渡性阶段，GDP 一直稳步上升，直接反映了国民生 活水平的不断上升，使得市场上货运流通愈发频繁，货运需求不断增加。

国内生产总值（亿元）

1000000 800000 600000 400000 200000 0

国内生产总值
国内生产总值（亿元）

年份（年）
图 2-2 2008-2017 我国 GDP 变化 Fig.2-2 Changes of GDP in 2008-2017
（2）第二产业增加值 在产业划分中，第二产业主要指加工制造产业，利用自然界和第一产业提供的基本 材料进行加工处理，包括制造业、采掘业、建筑业、水电油气和医药制造等产业。第二 产业的生产水平与或结构变动必然会影响物流市场上的货物运输情况，尤其是第二产业 中的煤炭、钢铁、石油等产品在铁路运输的货物品类中所占份额极高。与第二产业总产 值不同，第二产业增加值是指在报告期内第二产业的单位产值增加值，是指工业企业在 报告期内，全部生产活动的总成果扣除了在生产过程中消耗或转移的物质产品和劳务价 值后的余额。因此，相比第二产业总值，第二产业增加值更能直观的反映工业生产活动 的最终成果，应当作为影响铁路货运需求的指标之一。图 2-3 展示了我国 2008-2017 年 间第二产业增加值的变化情况。

11

第三章 货运需求预测模型的特征提取与特征选择

第二产业增加值（亿元） 2008 2009 2010 2011 2012 2013 2014 2015 2016 2017

400000 300000 200000 100000
0

第二产业增加值
第二产业增加值（亿元）

年份（年）

图 2-3 2008-2017 我国第二产业增加值变化 Fig.2-3 Added value of the secondary industry in 2008-2017
（3）社会消费品零售总额 在各类与消费有关的统计数据中，社会消费品零售总额是表现国内消费需求最直接 的数据。它是研究国内零售市场变动情况、反映经济景气程度的重要指标。2017 年，我 国全年社会消费品零售总额 3.6 万亿元，同比增长 10.2%。当前，我国消费市场总体运 行平稳，且仍处于上升期，市场潜力大、发展韧性强，加上国家出台的一系列促销费政 策措施的推进，是提高铁路货运需求水平的有力保障。图 2-4 展示了我国 2008-2017 年 间第二产业增加值的变化情况。

400000 300000 200000 100000
0

社会消费品零售总额
社会消费品零售总额（亿 元）

社会消费品零售总额（亿元）

年份（年）
图 2-4 2008-2017 我国社会消费品零售总额变化 Fig.2-4 Total retail sales of consumer goods in 2008-2017
（4）居民消费水平 居民消费水平是指居民在物质产品和劳务的消费过程中，对满足人们生存、发展和
享受需要方面所达到的程度。随着经济的快速增长，我国居民的物质生活水平整体有了

12

第三章 货运需求预测模型的特征提取与特征选择

极大改善，巨大的消费需求推动了商贸流通业的发展，市场上的货物流通量越来越大， 运输服务业在国民的消费结构中占据着愈加重要的地位，自然也带动了铁路货运需求的 增加。图 2-5 展示了我国在 2008-2017 年间居民消费水平的变化情况。

居民消费水平（元）

25000 20000 15000 10000
5000 0

居民消费水平
居民消费水平（元）

年份（年）
图 2-5 2008-2017 我国居民消费水平变化 Fig.2-5 Household consumption level in 2008-2017
作为“克强指数”的重要指标之一，铁路货运需求对社会经济发展具有强烈的正反 馈效应。基于以上分析，本文初步选取国内生产总值、第二产业生产总值、社会消费品 零售总额和居民消费水平 4 个具有代表性的宏观经济指标作为铁路货运需求的影响因素。
2.2 政策因素 运输政策对铁路运输供给具有十分重要的影响，并会体现在对铁路运输的投资规模
和宏观调控等方面中。投资规模决定了铁路运输基础设施和硬件设备的建设发展，宏观 调控会影响市场对铁路运输的需求。近些年来，随着新兴服务业的崛起，铁路运输业受 到了一定的冲击，在国家一系列的政策指导下，正经历着货运改革的关键阶段。因此， 探讨运输政策对铁路货运需求的作用情况是必要的。
（1）铁路固定资产投资 我国铁路运输正处于市场化发展的关键时期，扩大固定资产的投资规模是强化铁路 科技创新，巩固扩大中国高铁技术领先优势的必要条件。同时，硬件设施的配套完善可 以直接提升运输效率，节约运输成本，从而对铁路运输业发展形成强有力的拉动作用。 当前，全国铁路建设投资保持强劲势头，近三年保持 8000 亿元以上投资规模，于 2019 年上半年全国铁路固定资产投资 3220.10 亿元，同比增长 2.97%。据国家铁路局公布， “十三五”期间铁路固定资产投资规模将达 3.5 至 3.8 万亿元，较之“十二五”期间铁 路固定资产投资完成额 3.58 万亿，稳中有升，居于全球首位。图 2-6 展示了我国在 2008-2017 年间铁路固定资产投资的变化情况。

13

第三章 货运需求预测模型的特征提取与特征选择

固定资产投资（亿元）

9,000 8,000 7,000 6,000 5,000 4,000 3,000 2,000 1,000
0

固定资产投资
固定资产投资（亿元）

年份（年）

图 2-6 2008-2017 我国铁路固定资产投资变化 Fig.2-6 Investment level of railway fixed assets in 2008-2017
（2）营业里程电气化率 营业里程是指在一定时期内办理客货运输业务的铁路正线总长度，其中，电气化铁 路指用电力机车作为牵引动力的铁路，因其具有牵引功率大、节能环保、能大幅度提高 运输能力和速度等优点，是各国铁路优先发展的铁路牵引动力方式。“十二五”期间，我 国铁路建设速度再次加快，营业里程和路网密度大幅提升。在全国大力提倡绿色运输的 背景下，提高电气化铁路的比重能提高运输效率，并达到节能减排的目的，所以营业里 程电气化率的提升对于刺激运输需求增加是有益的。图 2-7 展示了 2008-2017 年间我国 铁路营业里程电气化率的变化情况。

营业里程电气化率

80

60

40

20

营业里程电气化率（%）

0

营业里程电气化率（%）

年份（年）
图 2-7 2008-2017 我国铁路营业里程电气化率 Fig.2-7 Electrification rate of railway operating mileage in 2008-2017
由于国家政策的调整变动本身难以量化，且缺乏确定的代表性指标。因此，本文通 过查阅资料，对近年的政策实施对铁路运输行业带来的供给侧运输能力的改变进行分析， 总结归纳出固定资产投资、营业里程电气化率两个指标来综合反映政策调整对铁路货运 量的作用情况。
14

第三章 货运需求预测模型的特征提取与特征选择

2.3 行业竞争因素 物流环境变化的影响因素主要包括公路运输、水路因素和航空运输方面，它们与铁
路运输共同形成了现代物流运输的主流服务体系。现阶段，我国进入“新常态”的经济 转型时期，经济环境对产能结构的改变使得煤炭、矿石等“黑货”的需求量下降，而这 些大宗货物在铁路货运中占有相当大的比重，从而导致铁路货运需求的下降。与此同时， 电子消费品、日用消费品以及快速消费品等零散高附加值“白货”的物流需求却增长迅 速[56]，货物运输方式开始呈现多样化和分散化，铁路货运由于自身货运组织模式的特点， 难以保证白货对运到时限的要求，市场竞争力下降，这是铁路货运需求下降的另一原因。
（1）公路货运量 随着电子商务的飞速发展，网络购物兴起，与铁路、水路运输相比，由于公路运输 机动性和适应性强，在中、短途运输中可实现“门到门”运输，运送速度快等运输优点， 受到很多商家认可。近年来，公路货运量在全社会货运中占比越来越高，2008-2017 年， 公路货运量占比由 74.1%上升到 78%。这十年内，铁路货运量增量 11%，而公路货运量 增量达到 91%。图 2-8 展示了 2008-2017 年间我国公路货运量的变化情况。

民航货运量（万吨）

民航货运量

800

600

400

200

民航货运量（万吨）

0

年份（年）
图 2-8 2008-2017 我国公路货运量的变化情况 Fig.2-8 Changes of road freight volume in 2008-2017
（2）水路货运量 与其他运输方式相比，水路运输具有运能大，成本低，耗能少的特点，我国进出口 货物总运量的 90%是通过水运完成的。2003 年以后，我国对外贸易的逐年扩大，水路运 输的货物周转量出现大幅度的上扬。在长距离的大宗货物运输选择上，水运凭借低成本 低的竞争优势抢占了部分的市场份额。图 2-9 展示了 2008-2017 年间我国水路货运量的 变化情况。

15

第三章 货运需求预测模型的特征提取与特征选择

水路货运量（万吨）

800000 600000 400000 200000
0

水路货运量
水路货运量（万吨）

年份（年）
图 2-9 2008-2017 水运货运量的变化情况 Fig.2-9 Changes of water freight volume in 2008-2017
（3）民航货运量 随着近年来全球航空货运市场的转暖趋好，作为世界第二大航空货运市场，中国也 迎来了航空货运业务的强劲增长。在电子商务尤其是跨境电商的发展趋势下，航空快递 将日益成为国内货运市场发展的主要驱动力，航空货运业将加快融入综合物流体系。阿 里巴巴预测，2020 年跨境电商将占中国外贸的 38%，国际航空货运将迎来规模化、速 递化、井喷化发展。图 2-10 展示了 2008-2017 年间我国民航货运量的变化情况。
民航货运量
800 600 400 200
民航货运量（万吨） 0

民航货运量（万吨）

年份（年）
图 2-10 2008-2017 民航货运量的变化情况 Fig.2-10 Changes of air cargo volume in 2008-2017
从前文分析中可以看出，在一定份额的货运市场中，各运输方式存在一定的竞争关 系。基于替代品效应，其他运输方式的发展必然会给铁路运输业带来一定的冲击。在社 会物流行业繁荣的背景下，公路运输、水路运输和航空运输的崛起，以及铁路货运组织 的发展滞后使得铁路货运量在全国总货运量中所占比重反而下降，尤其是公路运输在国 家政策的扶持下形成了完备高效的公路运输网，一度抢占了铁路的大量货源。水路运输 和航空运输也在保持它们的运输优势的同时，将自己的运输范围延伸至中长途运输。由

16

第三章 货运需求预测模型的特征提取与特征选择
于这些运输方式适应了市场资源配置的要求，其在计划经济体制之下被压制的潜在能量 得到了充分的释放，从而在运输范围和领域上对铁路运输形成了极强的替代性[57]。所以 在分析过程中，必须将其他运输方式对铁路货运需求变化的影响纳入考量，本文选取了 公路货运量、水路货运量和民航货运量作为铁路货运需求的影响因素。
2.4 自身供给因素 尽管外部环境因素一定程度上影响了社会需求，但铁路自身供给能力也是影响货运
量水平的重要方面。铁路供给水平的影响因素可大致分为路网基础设施、机车规模与结 构以及运营计划 3 个层面。路网基础设施水平与货运中机车的使用情况规模上限制了运 输供给的数量，同时也在一定程度上决定了运输服务质量；运营计划的制定和运输生产 是对铁路运输供给的运用，这两个因素水平的高低直接影响到运输服务的输出水平。
（1）路网基础设施 路网基础设施水平指的是铁路路网及其相关设备的整体水平。路网基础设施是铁路 运输的基础，其发展水平是影响我国铁路运输供给水平的重要因素。 路网的运输密度、营业里程、线路的技术标准（如设计速度、牵引重量）、复线率 等都会对铁路运输供给的能力造成影响。本文选取装卸机械化比重、货车通过总重、货 场总建筑面积、货仓总使用面积、货物装卸线数、营业里程、复线里程和运输密度作为 路网基础设施的影响指标。其中，运输密度指在一定时期内平均每公里铁路线路所担负 的货物周转量, 是考核铁路运输能力利用程度和运输工作强度的指标；营业里程，指在 一定时期内铁路办理客货运输业务的铁路正线总长度；复线铁路，是指有两条平行正线 轨道组成的铁路系统，由于减少了列车停站次数，可节省能量消耗，加速机车车辆周转 和客货送达时间等诸多优点，复线铁路的运输能力远大于单线铁路，因此，铁路复线里 程也是评价铁路运输服务能力的重要指标之一。 （2）机车规模与结构 机车车辆是铁路运输的移动设备，它与路网固定基础设施一起，从规模上限制了铁 路运输供给的硬件能力，主要包括机车、客车和货车，本文只讨论机车和货车。 铁路车辆本身没有动力装置，需由机车牵引运行，机车是铁路运输的基本动力；货 车则是用于载货的车厢，铁路货车对铁路运输能力的影响，除了其自身的性能参数起到 重要作用之外，货车的种类能否适应现代物流的需要，也是衡量铁路运输供给水平的内 因，从而影响货运需求的变化。 （3）运营计划 铁路运营计划主要包括运行图、开行方案和编组计划等，它是铁路生产者对铁路设 备的运用计划。这些运营计划从计划的层次确定了铁路所提供的运输产品、供给能力和 服务水平，对于铁路运输供给的影响主要体现在以下几点：（1）运营计划确定了设备利 用率。设备利用率体现了生产者对硬件设施的利用程度与利用效率，如机车和货车的运 行、周转和停留等过程，它们的使用情况是体现运输服务能力的重要方面；（2）运营计
17

第三章 货运需求预测模型的特征提取与特征选择

划确定了人力资源的工作效率，运输人员的工作情况影响运输服务质量的重要因素；（3） 运营计划确定了货物从发出至送达的作业流程，并以量化指标反映出运输供给能力。例 如，人力资源的规模水平是行业发展的重要影响因素之一。运输计划制定后，需要由各 运输部门共同执行并完成，因此，一定程度上，就业人员数决定了运营计划对货主所承 诺的供给水平的实现程度。铁路运输业就业人员数量的上升可以改善运输供给服务水平， 从而刺激新的运输需求。图 2-11 展示了 2008-2017 年间我国铁路运输业就业人员数量的 变化情况。

2000000 1900000 1800000 1700000 1600000

铁路运输业就业人员数
铁路运输业就业人员数 （人）

铁路运输业就业人数（人）

年份（年）

图 2-11 2008-2017 铁路运输业就业人员数量的变化情况 Fig.2-11 Number of employed persons in the railway transportation industry in 2008-2017

2.5 本章小结 铁路运输系统是一个受多种因素共同作用的复杂动态系统，具有不确定性、随机性
和模糊性。通过对铁路货运组织的社会需求和自身供给两方面进行综合分析，本章从宏 观经济环境、政策调整、物流环境变化和铁路自身供给这四个方面梳理了与铁路货运需 求变化相关的影响因素以及它们的影响机理，初步筛选出 38 项运输作业指标作为货运 需求的影响因素，如表 2-1 所示。

表 2-1 铁路货运需求影响因素

宏观经济因素 政策因素
行业竞争因素
自身供给因素

国内生产总值、第二产业生产总值、社会消费品零售总额、居民消费水平
固定资产投资、营业里程电气化率
公路货运量、水路货运量、民航货运量
铁路运输业就业人员数、运行速度、货车周转时间、装卸机械化比重、日 均装车数、机车平均牵引总重、日均卸车数、货车静载重、货车周转时间、 一次货物作业停留时间、货车中转停留时间、列车运行准点率、货车平均 通过总重、货场总建筑面积、货仓总使用面积、货物装卸线数量、日均支 配机车数、机车检修率、管内装卸率、机车日车公里、货车全周转距离、 货车日均运输量、空车走行率、装卸全员劳动生产率、营业里程、复线里 程、运输密度、装卸总作业量、运输总支出

18

第三章 货运需求预测模型的特征提取与特征选择
第三章 货运需求预测模型的特征提取与特征选择
随着科学研究的不断进步，数据挖掘领域需处理的对象越来越复杂，特征选择已成 为数据分类问题中的关键性步骤。机器学习可分为获取数据、数据预处理、构建并训练 模型、模型验证与评估 4 个过程，而特征选择就属于机器学习中数据预处理的一部分， 特征选择过程的基本思路框架如图 2-1 所示。
图 3-1 特征选择的基本框架 Fig.3-1 Feature selection framework
特征选择是指对原始训练数据进行约简、重组、运算，从而选择获得相应模型和算 法最好性能的特征集的过程。通常我们构建机器学习算法时，可以收集很多维度的数据 信息，当数据维度不多时，构建算法的过程中可以将这些维度都放入到构建算法中，但 是，当特征维度达到一定量级后，将全部特征放入到算法中会陷入“维度灾难”，算法 在有限的计算能力和时间内很难达到收敛，甚至可能会计算溢出[58]。在这种情况下，有 必要通过合适的特征选择方法对训练数据进行降维处理，过滤弱相关或是有效信息少的 信息，使用特定的评价标准从特征全集中选择恰当的特征子集，从而避免计算资源浪费， 达到提高模型的预测精度和计算速度的目的。目前，主流的特征选择方法有过滤法、封 装法和嵌入法 3 种，本章将介绍并简述这几类方法的特征选择原理，并在现有研究的基 础上提出创新，构建一种多阶段混合式的特征选择方法。
3.1 特征选择算法的基础理论
3.1.1 过滤法（Filter） 过滤式方法先对数据集进行特征选择，然后再训练学习器。特征选择过程与后续学
习器无关，这相当于先对初始特征进行“过滤”，再用过滤后的特征训练模型。而这个 “过滤”方式是是按照发散性或者相关性对各个特征进行评分，设定阈值或者选择阈值 的个数，从而完成特征选择[59]。经典的过滤式选择方法有方差选择法、相关系数法和互 信息法几种。Filter 方法的基本原理如图 3-2 所示。
19

第三章 货运需求预测模型的特征提取与特征选择

图 3-2 Filter 方法的基本思路 Fig.3-2 Basic idea of the Filter method

（1）方差选择法 方差法是设定一个基础阈值，计算每个特征的的均值和方差，当该维度的特征方差

小于基础阈值时，则筛除掉该特征。这种方法简单高效的过滤了一些低方差的特征，但 是存在一个问题就是阈值的设定是一个先验条件，当设置过低时，保留了过多低效的特

征，设置过高则丢弃了过多有用的特征。

（2）相关系数法 基于相关性标准的评分函数中比较有名的是计算皮尔逊系数（Pearson Correlation）， 两个变量之间的皮尔逊相关系数定义为两个变量之间的协方差和标准差的商。该方法衡

量的是变量之间的线性相关性，结果的取值区间为[-1,1]，-1 表示完全的负相关(这个变 量下降，那个就会上升)，+1 表示完全的正相关，0 表示没有线性相关。皮尔逊相关系 数如下：

 X ,Y

 corr( X ,Y )



cov( X ,Y )  XY



E ( X

 X )(Y  XY

 Y )

(3-1)

（3）互信息法

互信息是用来评价一个事件的出现对于另一个事件的出现所贡献的信息量。在基于

信息论的特征选择方法中，互信息指的是两个随机变量之间的关联程度，即给定一个随

机变量后，另一个随机变量不确定性的削弱程度，且不确定性的量度表示为为变量的熵。

变量分布得越离散，信息熵的值越高。信息熵的计算公式如下：

H   H

( (

X ) Y )


X


P( X ) P( Y )

l o gP( X( 为连)X)续, 变量 l o gP( X( 为离)X)散, 变量



x

其中，H(X)表示变量 X 的信息。互信息的计算公式如下：

(3-2)

20

第三章 货运需求预测模型的特征提取与特征选择

 

I

(

X

,Y

)



X

Y

P(

X

,Y

)



log

P(X ,Y ) P(X )P(Y

, )

X

和Y

均为连续变量

  
I(X,Y) 

P( X ,Y )  log P( X ,Y ) , X 和Y均为离散变量



x y

P( X )P(Y )

由*式可以看出，如果 X，Y 相互独立，则有 P(X ,Y )  P(X )P(Y ) ，得出

l o g P(X Y, )  0 P(X )P Y( )
继而 I (X ,Y )  0 ，即 X，Y 不相关。

(3-3) (3-4)

虽然 Filter 方法的计算复杂度低、运行速度快，但是由于该方法在特征选择的过程 中不涉及分类器，特征选择的规则的制定是在特征搜索算法中完成，学习算法无法像特 征搜索算法一样传递对特征的需求。另外，过滤法是用单一的评价准则对单个特征逐个 评价，没有考虑特征间的相互作用，因此采用过滤法选择出的特征组合对分类器的分类 贡献是不确定的，需要另外进行分类验证。

3.1.2 封装法（Wrapper） Wrapper 方法是一种与分类模型结合的特征选择方法，将子集的选择看作是一个搜
索寻优问题，生成不同的组合，根据分类器的性能对该特征组合进行评价，这样就将子 集的选择看作是一个优化问题。采取某些优化的搜索策略对组合进行调整，最终获得近 似的最优特征组合[60]。根据相关文献，Wrapper 方法可大致分为顺序搜索与启发式搜索 两类，其主要思路脉络如图 3-3 所示。

图 3-3 Wrapper 方法的基本思路 Fig.3-3 Basic idea of the Wrapper method
（1）顺序搜索算法 部分学者采用了序列前向选择(SFS，Sequential Forward Selection)的搜索策略，该方 法是特征子集 X 从空集开始，每次选择一个特征 x 加入特征子集 X，使得特征函数 J( X) 最优；有的学者采用的是序列后向选择( SBS , Sequential Backward Selection )的特征选择
21

第三章 货运需求预测模型的特征提取与特征选择
方法，即从特征全集 O 开始，每次从特征集 O 中剔除一个特征 x，使得剔除特征 x 后评 价函数值达到最优；近年来，有研究提出一种新的“增 L 去 R”的特征选择算法 ( LRS , Plus-L Minus-R Selection )，该算法结合了 SFS 和 SBS 的策略思想，有两种形式：算法 从空集开始，每轮先加入 L 个特征，然后从中去除 R 个与类标签相关性最弱的特征；或 是算法从全集开始，每轮先去除 R 个特征，然后加入 L 个特征，即 L < R 的情况下，使 得评价函数值最优[61]。
（2）启发式搜索算法 该方法是在特征全集中随机采样生成初始子集，基于启发式算法各自的搜索规则， 在算法运行中对每个特征赋予一定的权重，然后根据用户所定义的或自适应的阈值来对 特征重要性进行评价。当特征所对应的权重超出了这个阈值，它便被选中作为重要的特 征来训练分类器。 相对于 Filter 方法，Wrapper 方法能够考虑到学习算法所属的任意学习偏差，因此 找到的特征子集分类性能通常更好。然而，Wrapper 方法选出的特征通用性不强，当改 变学习算法时，需要针对该学习算法重新进行特征选择；除此之外，由于每次对子集的 评价都要进行分类器的训练和测试，所以算法计算复杂度很高，尤其对于大规模数据集 来说，算法的执行时间过长。 3.1.3 嵌入法（Embedded） 嵌入式特征选择法是根据机器学习的算法或模型来分析特征的重要性，从而选择最 重要 N 个特征。与包裹式特征选择法最大的不同是，嵌入式方法是将特征选择过程与模 型的训练过程结合为一体，不用将训练数据集分成训练集和测试集两部分，避免了为评 估每一个特征子集对学习机进行从头开始的训练。Embedded 方法可以快速地得到最佳 特征子集，是目前被广泛认可高效的特征选择方法[62]。常用的嵌入式特征选择方法有基 于惩罚项的特征选择法和基于树模型的特征选择法。嵌入式方法的分类如图 3-4 所示。
图 3-4 嵌入式特征选择方法的分类 Fig.3-4 Classification of embedded feature selection methods
22

第三章 货运需求预测模型的特征提取与特征选择

（Ⅰ）基于惩罚项的特征选择法

给定数据集 A  (x1, y1), (x2, y2 ) (xn , yn ) ，其中 x  Rd , y  R 。以线性回归模型为例，将
均方误差作为损失函数，则优化目标为

n
 m i wn y(i wT xi2 )
i 1

(3-5)

当样本特征很多，而样本数相对较少时，上式很容易陷入过拟合。为了缓解过拟合

问题，可对式（3-6）引入正则化项。 ①若使用 L2 范数正则化，则有

n

 m i wn

y(i wT

xi2

)

+

2w
2

i 1

(3-6)

其中正则化参数   0 。式（2.）称为“岭回归”（ridge regression）[63]，通过引入

L2 范数正则化，能显著降低过拟合的风险。

②若使用 L1 范数正则化，则有

n

 min w

( yi  wT xi )2 +

w
1

i 1

(3-7)

其中正则化参数   0 。式（2.）称为 LASSO（Least Absolute Shrinkage and Selection

Operator）[64]。 ridge regression 和 LASSO 方法并没有改变目标函数本身，只是在优化函数（均方
误差）的基础上添加参数的范数，参数 ,  的大小反映了正则项与均方误差的相对重要

性，参数值越大，正则项的权重就越大，优化参数的结果就会偏好更小的参数值。 L1 范数和 L2 范数正则化都是通过降低权重系数的办法来降低过拟合风险，但 L1 范数比 L2 范数更易于获得“稀疏”解，即它求得的 w 会有更少的非零向量，在特征选择上效果更

好。因此，LASSO 在嵌入法中是最常见的方法。

（Ⅱ）基于树模型的特征选择法

该方法是利用一个特征进行分类，并根据特征的不同取值构建子节点，直到特征没

有分类能力或者很小，就停止生成节点。生成决策树的过程就是挑选特征的过程，树节

点 的 划 分 特 征 所 组 成 的 集 合 就 是 选 择 出 的 特 征 子 集 。 其 中 ， 梯 度 提 升 树 （ Gradient Boosting Descision Tree, GBDT）和随机森林（Random Forest, RF）是最典型的两种嵌入 法。

（1）GBDT Boosting 是一种可将弱学习器提升为强学习器的算法，属于集成学习（ensemble

learning）的范畴。GBDT 属于 boosting 算法的一种，通过多轮迭代，每轮迭代产生一个

弱分类器，每个分类器在上一轮分类器的残差基础上进行训练，最终的总分类器是将每

轮训练得到的弱分类器加权求和得到的[65]。在梯度提升决策树中，其基学习器是分类回

归树 CART，通常以基尼指数（Gini index） 作为特征选择标准。

23

第三章 货运需求预测模型的特征提取与特征选择

① 假设有 e 个特征 X1, X2, , Xe ，单棵树上节点 m 的 Gini 指数的计算公式为：

K

 G Im  1 

2pm k

k 1

(3-8)

其中，K 表示有 K 个类别， pmk 表示节点 m 中类别 k 所占的比例。直观地说，就是

随机从节点 m 中随机抽取两个样本，其类别标记不一致的概率。

②

定义特征

X

j

的

Gini

指数评分为

VI

Gini j

，那么

X

j

在节点

m

的重要性可以表示为加

权不纯度的减少，计算公式为：

V

IGj

i m

ni

Nm G Im

Nl GlI

Nr Gr I

(3-9)

其中， Nm 、 Nl 、 Nr 分别表示节点 m、节点 l 和节点 r 的样本数。 GIl 和 GIr 分别表 示分枝后两个新节点的 Gini 指数。
如果特征 X j 在决策树 i 中出现的节点在集合 M 中，那么 X j 在第 i 颗树的重要性为：

 VIi(Gj i n)i

VI

( G i) n i jm

mM

(3-10)

假设共有 n 棵树，则 X j 的重要性评分，即 X j 在所有决策树中节点分裂不纯度的平

均改变量为：

（2）随机森林

n

 VI

(Gini ) j



VIi(jGini)

i 1

(3-11)

随机森林是一个由一组决策树分类器{ h( X, θm), m=1,2,…, M}组成的集成分类器， 其中{θm }是服从独立同分布的随机向量，M 表示随机森林中决策树的个数，在给定自变 量 X 下，每个决策树分类器通过投票来决定最优的分类结果。基于随机森林分类器的特 征选择方法主要有 Gini 指数和袋外（out-of-bag, OOB）误差两种，利用 Gini 指数的特 征重要性评价过程与 GBDT 相同，而 OOB 误差法则是利用随机森林算法自身的分类准 确率作为特征重要性排序的依据。

在构建每棵决策树时，对原始训练集使用 bootstrap 方法随机且有放回地抽取新的数 据集，例如对于第 i 棵树，大约有 1/3 的数据没有参与决策树的建立，这部分数据被称 为第 i 棵树的 oob 样本，这部分数据可以用于对决策树的性能进行评估，计算模型的预 测错误率，称为袋外数据误差。袋外数据误差是随机森林泛化误差的一个无偏估计，它

的结果近似于需要大量计算的 k 折交叉验证。基于 oob 错误率的特征重要性度量定义为 袋外数据自变量值发生扰动（或加入噪声）后的分类错误率与扰动前分类错误率的平均

增加量[66]。计算过程如下：

①假设有 bootstrap 样本 a  1, 2, , A ，A 表示训练样本个数，设置 a=1，在训练样本

上创建决策树 Ta ，并将袋外数据标记为 Loao1b ；

24

第三章 货运需求预测模型的特征提取与特征选择

②在袋外数据上使用 Ta 对 Loao1b 数据进行分类，并统计分类错误率，记为 Rao1ob ；

③对于特征 X i （i=1,2,…, N），随机对 Loao1b 中所有样本的特征 X i 的值进行扰动，扰动 后的数据集记为 Loao2b ，使用 Ta 对 Loao2b 数据进行分类，将分类错误率记为 Rao2ob ；
④对于 a  2,3, , A ，重复步骤①~③；

⑤定义VIi 为特征 X i 的基于分类错误率的特征重要性度量，其计算公式为：

 VIi =

1 A

A
( Rao2ob
i 1

Rao1ob )

(3-12)

进行扰动后，袋外数据的分类准确率下降的幅度越大，即 Rao1ob 与 Rao2ob 差值越大，则

说明该特征对预测结果影响越大，进而说明该特征的重要程度越高。

在量化特征重要性的基础上，特征选择的步骤如下：

步骤 1：计算每个特征的重要性，并按降序排序； 步骤 2：确定要剔除的比例，依据特征重要性剔除相应比例的特征，得到一个新的 特征集；

步骤 3：用新的特征集重复上述过程，直到剩下 m 个特征（m 为提前设定的值）。 步骤 4：根据上述过程中得到的各个特征集和特征集对应的 oob 错误率，选择 oob 错误率最低的特征集。

嵌入式特征选择法的主要思想是在模型既定的情况下，学习出对提高模型准确性最

好的特征，也就是在确定模型的过程中，挑选对模型的训练有重要意义的特征。在嵌入

型特征选择中，特征选择算法是作为学习算法的部分嵌入其中的，特征选择和训练过程

同时进行[67]。因此该方法能够考虑学习算法所属的任意学习偏差，不需要对中间结果进

行验证，是目前被广泛认为最佳的利用 Embedded 方法训练模型的次数小于 Wrapper 方 法，但缺点是运行速度较慢。

3.2 货运需求预测模型的特征选择
3.2.1 相关算法说明 （1）模糊二元对比决策 模糊决策方法是采用模糊数学对目标模糊的对象系统做出定量决策的一种方法，其
中，基于二元对比的模糊优先对比是常用的决策方法之一[68]。该方法的思路如下：首先 将各对象进行两两比较，得到优先比较级；然后在这些二元比较级的基础上，构造模糊 优先关系矩阵；最后，基于优先关系矩阵，即可对论域中的对象进行排序。
设论域 U={x1,x2,…,xn}是 n 个元素的集合，A 是 U 的一个模糊子集。模糊二元对比 决策的实现步骤如下：
首先，建立二元比较级。对于给定的一对元素(xi,xj), 当 xi、xj 作对比时，用 rij 表示 xi 对于 A 比 xj 对于 A 的优先程度，这时称 rij 为 xi 与 xj 对 A 的二元相对比较级，简称优
25

第三章 货运需求预测模型的特征提取与特征选择

先比较级。且要求 rij 满足：①rii=1；② 0  rij  1；③当 i  j 时， rij +rji  1 。

然后，利用模糊相对比较函数，建立模糊相及矩阵。若论域 U={x1,x2,…,xn},xi 与 xj 的二元比较级为(fj(xi),fi(xj))，称

def
f (xi | xj) 

fj ( xi )

fj(xi)  fi(xj)

(3-13)

为模糊相对比较函数。记 rij=f(xi | xj),则称以 rij 为元素的矩阵 R=(rij)n×n 为模糊相及矩阵， 于是有

1

R



 

f

( x2

|

x1 )



  f (xn | x1 )

f (x1 | x 2) 1
f (xn | xn1 )

f (x |1xn )  



f

( xn1

|

xn

) 

1

(3-14)

最后，利用 λ-截矩阵来对所有对象进行排序。取定阈值 λ∈[0,1]得 λ-截矩阵

R  (rij() ) , 矩阵中大于等于 λ 的数取 1，否则取 0。

当 λ 由 1 逐渐下降时，若首次出现的 Rλ，它的第 i1 行元素全等于 1，则认定𝑥𝑖1是第 一优越对象；再在 R 中划去𝑥𝑖1所在的行与列，得到一个新的 n−1 阶模糊矩阵，用同样 的方法获取最优对象作为第二优越对象；如此递推下去，可将全体对象排出一定的优劣

次序。

（2）BP 神经网络 BP 神经网络模型是由输入层、输出层和若干隐含层组成的前向连接模型，同层各
神经元间互不连接，相邻层的神经元通过权重连接且为全互连结构[69]。BP 神经网络的 算法原理如图 3-5 所示。

图 3-5 BP 神经网络的算法原理 Fig.3-5 Algorithm principle of BP neural network
（3）支持向量机 设训练样本集(xj ,yj)，j=1,2,…,n; xj∈RU 为输入变量；yj∈R 为输出变量，SVM 通过
非线性函数 ϕ(∙)将输入空间映射到高维特征空间，并在这个空间构造线性回归函数[70]。
26

第三章 货运需求预测模型的特征提取与特征选择

n



n



  max yi(ii)   yi(i  i)



 , i1

i 1

   1 n

n



( i  i)( j   j) yiyj (xi, xj)

2 i1 j1

(3-15)

n 



s.t. ( i  i)  0, 0   i; i  C

j 1

式中：αi 和 αj 为拉格朗日乘子, (xi, xj) 为满足 Mercer 条件的核函数。

（4）随机森林

随机森林回归算法是由一组回归决策子树{h(x, θt), t=1, 2, …, T}构成的组合模型[71]。 其中 θt 是服从独立同分布的随机变量，x 表示自变量，T 表示决策树的个数。利用集成 学习的思想取各决策子树{h(x, θt)}的均值作为回归预测结果：

 h ( x) 1 T
T t1

{h (xt,

)}

式中，h(x, θt)为基于 x 和 θ 的输出。

其对应的算法步骤如下：

(3-16)

步骤 1：在训练集 D 中有放回地随机抽取 n 个样本，作为一棵决策树的训练样本。

步骤 2：在 d 个属性特征中随机选取 k 个属性作为子集指定给树的每个节点，构建

单棵回归决策子树。

步骤 3：重复步骤 1-2，构建 T 棵回归决策子树，每棵树自由生长，不进行剪枝。

步骤 4：T 棵决策子树的预测值取平均，作为最终结果。

3.2.2 融合机器学习和模糊决策的特征选择算法
鉴于主流特征选择算法存在的一些不足，本文对 Embedded 方法进行改进，结合机 器学习和模糊决策提出一种多阶段混合式的特征选择方法。该方法首先利用模糊二元对 比决策来为影响货运需求的各因素进行重要性排序，进而利用 Embedded 特征选择算 法 以及 Wrapper 特征选择算法进行二次变量选择，筛选得到相关性高的关键影响因素的最 优集。具体来说，该方法的实现原理及实现步骤分为以下三步。
步骤 1：首先，利用平均准确率降低（mean decrease accuracy, MDA）可实现两个特 征之间的二元对比，从而建立二元比较级矩阵。MDA 是基于样本的袋外（Out-of-Bag， OOB）数据误差率来评价特征重要性的度量方法，即原始训练集中未被选中的样本，可 用于检测决策树的分类性能。模型的预测错误率，称为袋外数据误差。
然后，建立以特征之间的二元比较级为依据的模糊优先矩阵，进而确定 λ-截矩阵以 对所有影响因素进行重要性排序。
最后，将所有影响因素按重要性从高到低重新整理，利用前向序列选择（sequential forward selection，SFS）策略逐次添加重要性最高的影响因素训练模型，并得到模型性 能在特征子集数量变化下的拟合曲线。当平均绝对误差（δMAE）最小，平方相关系数（R2）

27

第三章 货运需求预测模型的特征提取与特征选择
最大时，所对应的输入变量个数 k 就是最优特征子集的维度，从而可确定重要度最大的 前 k 个变量作为模型的最优输入特征集。该方法的研究思路与步骤如图 3-6 所示。
图 3-6 特征选择的思路框架图 Fig.3-6 Feature selection flowchart
3.3 本章小结
本章节首先介绍了现有的特征选择方法体系，阐述了不同研究阶段中方法的逐步成 熟的过程，并对比了各方法的优势与不足。然后，在目前受认可度相对较高的 Embedded 方法的基础上进一步优化，提出结合模糊决策和机器学习的一种多阶段混合式特征选择 方法。该方法的创新点与优势在于，利用改进的模糊决策方法，对初始原始特征集合按 照重要程度进行排序，将排序后的特征集合用于训练机器学习模型，根据预测值与真实 值比较的 R2 大小，得到能使拟合效果最好的特征子集，从而确定关键影响因素。相比 普通的 Embedded 方法，该方法不仅结合了 Embedded 与 Wrapper 方法的优势，且在此 基础上利用模糊决策理论进一步优化，极大提高了计算效率，节约了计算成本。
28

第四章 基于随机森林的货运需求预测模型
第四章 基于随机森林的货运需求预测模型
利用第三章中分析得到的货运量的关键影响因素指标，本章将基于随机森林构建货 运需求预测模型。考虑到传统参数取值难以达到效果最优，本文运用灰狼优化算法对随 机森林的参数进行寻优，从而提高对货运需求的预测准确率。
4.1 相关算法说明
4.1.1 随机森林简介 集成学习（ensemble learning）把 k 个学习得到的模型（或基学习器）M1,M2,…,Mk
组合在一起，旨在创建一个改进的复合模型 M*。使用给定的数据集 D 创建 k 个训练集 D1,D2,…,Dk，其中 Di 用于创建基学习器 Mi。给定一个待预测的数据元组，每个基学习 器返回各自的预测结果,集成学习器基于预测结果的均值返回最终预测值。其思想是为了 解决单个模型或者某一组参数的模型所固有的缺陷，从而整合起更多的模型，取长补短， 避免局限性[72]。随机森林（Random Forest, RF）是以决策树为基学习器的一种集成学习 算法。RF 通过自助法（bootstrap）重采样技术，从原始训练样本集 D 中有放回地重复 随机抽取 k 个样本生成新的训练样本集合，然后根据自助样本集生成 k 个分类树组成随 机森林，新样本的分类结果按分类树最终投票多少形成的分数而定。
在构建每一个决策树的时候，有两个随机采样过程，即 RF 要对输入的数据要进行 行、列的采样。对于行采样，随机在原始训练样本中有放回的选取等量的数据作为训练 样本，每棵树的样本是由原始训练样本随机构成，可能重复包含，也可能不包含某些样 本；对于列采样，是在建立决策树时，随机的从特征中选取一部分特征建立决策树。即 采样过程可描述为：设有 N 个样本，每个样本有 M 个特征，决策树都是随机地接受 n 个样本（行采样）的 m 个特征（列采样），每颗决策树的 m 个特征相同。每颗决策树其 实都是对特定的数据进行学习归纳出分类方法，而随机取样可以保证有重复样本被不同 决策树分类，这样就可以对不同决策树的分类能力做出评价。
随机森林可用于解决分类问题和回归问题。本文将其用于解决回归问题，即随机森 林回归（Random Forest Regression, RFR）算法。随机森林回归中的每个学习器都是一颗 决策回归树，可通过结合袋装（Bagging）法与随机属性选择的方法来构建。给定 d 个 元组的训练集 D，为组合分类器产生 k 棵决策树的一般过程如下：对于每次迭代 i(i=1,2,…,k)，使用有放回抽样，由 D 产生 d 个元组的训练集 Di。也就是说，每个 Di 都 是 D 的一个自助样本，使得某些元组可能在 Di 出现多次，而另一些可能不出现，未被 采样的训练样本则用来估计分类器的泛化能力。设 F 是用来在每个结点决定划分的属性 数，其中 F 远小于可用属性。为了构造决策树分类器 Mi，在每个结点随机选择 F 个属
29

第四章 基于随机森林的货运需求预测模型

性作为该结点划分的候选属性。使用 CART 算法的方法来增长树，树增长到最大规模， 并且不剪枝，结构如图 4-1 所示。其中，最小二乘回归树生成算法的建模过程和机理如 下：
输入：训练数据集 D； 输出：回归树 f(x)。 在训练数据集所在的输入空间中，递归地将每个区域划分为两个子区域 c1、c2，并 决定每个子区域上的输出值，构建二叉决策树：

（1）选择最优切分变量 j 与切分点 s，求解

  min[min j,s c1

xiR1 (

( yi
j,s)

 c1)2



min
c2

xiR2 (

( yi
j,s)



c2 )2 ]

(4-1)

遍历变量 j，对固定的切分量 j 扫描切分点 s，利用式(4-1)达到最小的 (j,s)。

（2）用选定的（j,s）划分区域并决定相应的输出值：

    R1( j, s)= x | x( j ) s , R2 ( j, s)= x | x j( ) s

(4-2)

 cˆm



1 Nm

xiRm ( j s,

yi , x  Rm
)

,m 

1, 2

（3）继续对两个子区域调用步骤（1），（2），直至满足停止条件。

（4）将输入空间划分为 M 个区域𝑅1，𝑅2， ⋯ ，𝑅𝑀，生成决策树：

M
f ( x)  ˆmc I(x R)m
m1

(4-3) (4-4)

图 4-1 随机森林算法结构示意图 Fig.4-1 Structural sketch of stochastic forest algorithm
随机森林简单、容易实现、计算开销小，在很多现实任务中展现出强大的性能。随 机森林中基学器的多样性不仅来自样本扰动，还来自属性扰动，这就使得最终集成的泛
30

第四章 基于随机森林的货运需求预测模型
化性能可通过个体学习器之间差异度得增加而进一步提升，另外，随着森林中树的个数 增加，随机森林通常会收敛到一个更低的泛化误差，能有效降低过拟合的风险。
4.1.2 灰狼优化算法简介 灰狼优化算法（Grey Wolf Optimizer，GWO）是于 2014 年被提出的一种群智能优
化算法[73]，该算法是受到灰狼的种族机制和捕食行为的启发而开发的一种优化搜索方法。 由于灰狼优化算法寻优精度高、收敛速度较快、鲁棒性强，能在迭代过程中不断调整收 敛因子，实现种群的局部寻优和全局寻优，近年来受到了学者的广泛关注，并己被成功 地应用到了车间调度、参数优化、图像分类等领域中[74]。
灰狼隶属于群居生活的犬科动物，且处于食物链的顶层。灰狼群体严格遵守着一个 社会支配等级关系,如图 4-2 所示。
图 4-2 灰狼种群的社会等级结构图 Fig.4-2 Social hierarchy structure of gray wolf group
社会等级第一层：狼群中的头狼记为  ，  狼主要负责对捕食、栖息、作息时间 等活动作出决策。由于其它的狼需要服从  狼的命令，所以  狼也被称为支配狼。另 外，  狼不一定是狼群中最强的狼，但就管理能力方面来说，  狼一定是最好的。
社会等级第二层：  狼，它服从于  狼，并协助  狼作出决策或组织狼群的其他 活动。  负责执行  狼的命令，并向  狼提供反馈。在  狼去世或衰老后，  狼将成 为  狼的最候选者。虽然  狼服从  狼，但  狼可支配其它低层级上的狼。
社会等级第三层： 狼，它服从  狼、  狼，同时支配剩余层级的狼。 狼一般由
幼狼、哨兵狼、狩猎狼、老年狼及护理狼组成。 社会等级第四层： 狼，它通常需要服从其它社会层次上的狼。虽然看起来  狼在
狼群中的作用不大，但是  狼有助于满足整个族群的需求，维持优势结构。如果没有  狼的存在，狼群会出现内部争斗问题。
GWO 优化过程包含了灰狼的社会等级分层、跟踪、包围和攻击猎物等步骤，其步 骤具体情况如下所示。
（1）社会等级分层（Social Hierarchy）
31

第四章 基于随机森林的货运需求预测模型

当设计 GWO 时，首先需构建灰狼社会等级层次模型。计算种群每个个体的适应度，
将狼群中适应度最好的三匹灰狼依次标记为  、 、 ，而剩下的灰狼标记为  。也就 是说，灰狼群体中的社会等级从高往低排列依次为  、  、  及  。GWO 的优化过程 主要由每代种群中的最好三个解（即  、  、  ）来指导完成。
（2）包围猎物（Encircling Prey） 灰狼捜索猎物时会逐渐地接近猎物并包围它，该行为的数学模型如下：

D  C  Xp ( )t  X( )t

(4-5)

X (t+1)=X p (t)  A D (4-6) 式中：t 为当前迭代次数： A 和 C 是步长系数向量； X p 表示猎物的位置向量； X (t) 表 示当前灰狼的位置向量。

A  2a  r1  a

(4-7)

C  2r2

(4-8)

在整个迭代过程中， a 从 2 线性下降至 0， r2 是[0，1]中的随机向量。

（3）狩猎（Hunting）

灰狼具有识别潜在猎物（最优解）位置的能力，搜索过程主要靠  、  、  灰狼的

指引来完成。但是很多问题的解空间特征是未知的，灰狼是无法确定猎物（最优解）的

精确位置。为了模拟灰狼（候选解）的搜索行为，假设  、  、 具有较强识别潜在猎

物位置的能力。因此，在每次迭代过程中，保留当前种群中的最优的三只灰狼（  、 、

 ），然后根据它们的位置信息来更新其它狼当前的搜索位置。该行为的数学模型可表 示如下：

D  C1  X  X , D  C 2 X  X , D  C 3 X  X

(4-9)

X1  X  A1(D ), X2  X   A2 (D ), X3  X  A3(D )

(4-10)

X (t 1)  X1  X 2  X3 3

(4-11)

式中： X 、 X 、 X 分别表示当前种群中  、  、  的位置向量； X 表示灰狼的位置

向量； D 、 D 、 D 分别表示当前候选灰狼与最优三条狼之间的距离；当 A  1 时，

灰狼之间尽量分散在各区域并搜寻猎物。当 A  1时，灰狼将集中捜索某个或某些区域

的猎物。图 4-3 展示了在二维搜索空间中最优解的搜索过程。

32

第四章 基于随机森林的货运需求预测模型
图 4-3 最优解的搜索过程示意图 Fig.4-3 Schematic diagram of the search process for the optimal solution
从图 4-3 可看出，候选解的位置最终落在被  、 、 定义的随机圆位置内。总的 来说， 需要  、  、  首先预测出猎物（潜在最优解）的大致位置，而其它候选狼在
当前最优兰只狼的指引下在猎物附近随机更新它们的位置。 （4）攻击猎物（Attacking Prey） 构建攻击猎物模型的过程中，根据式（4-7），a 值的减少会引起 A 的值也随之波动。
换句话说，A 是一个在区间[a, a] 上的随机向量，其中 a 在迭代过程中呈线性下降。当 A 在 [1,1] 区间上时，则下一刻的搜索个体的位置可以在当前灰狼与猎物之间的任何位置 上。
（4）寻找猎物（Search for Prey）
灰狼主要依赖  、 、 提供的信息来寻找猎物。首先它们分散地去搜索猎物位置
信息，然后集中起来攻击猎物。对于分散模型的建立，通过 A  1 使所有搜索个体远离 猎物，这种搜索方式使 GWO 能进行全局搜索。GWO 算法中的另一个搜索系数是 C 。 由式（4-5）可知， C 向量是在区间范围 [0, 2] 上的随机值构成的向量，此系数为猎物提 供了随机权重，以便増加（ C  1 ）或减少（ C  1 ）。这有助于 GWO 在优化过程中 展示出随机搜索行为，以避免算法陷入局部最优。值得注意的是，C 并不是线性下降的， 它在迭代过程中是随机值，该系数有利于算法跳出局部。
4.2 预测模型的构建
与人工神经网络等其他机器学习算法相比，随机森林对训练样本需求少，更适用于
33

第四章 基于随机森林的货运需求预测模型
高维小样本数据，且具有计算开销小、鲁棒性强等优点，故本文构建基于随机森林的货 运需求预测模型。
目前，随机森林已广泛应用于各种分类和回归问题，在应用过程中影响随机森林回 归预测性能的主要参数有决策树的个数 ntree 和树节点预选的属性特征个数 mtry。ntree 越 大，树分类器越多，保证了分类器的多样性，有利于提高性能，但是时间空间成本较高， 可能导致可解释性减弱，到达一定值以后性能趋于稳定；若 ntree 过小，则会导致性能变 差、分类误差大。mtry 表示随机森林算法节点分裂时随机无放回地选择总属性的子集大 小。通常远小于总属性的数量，且建树过程中保持不变。这样做的目的是为了防止模型 的过拟合，增加分类树之间的多样性，降低树之间的相关性。当数据中相似的特征全部 用来进行树节点的分裂，此时为 Bagging 算法，造成树与树之间的相似度越高，反而会 影响树模型的效果。若 mtry 越小，随机性越强，分类准确度会降低。
针对参数 ntree 和 mtry 的合理取值问题，目前多采用经验尝试法来解决，但这难以确 保随机森林性能最佳，因此有必要利用智能优化算法对其参数进行优化，以提高模型的 预测精度。由于 GWO 元启发式算法在复杂搜索空间的全局搜索中具有传统智能方法无 法比拟的优势，本文提出采用 GWO 对随机森林的参数组合（ntree , mtry）进行优化，灰 狼根据位置更新策略进行寻优，以在训练集样本上的分类准确率为目标函数，搜索到的 全局最优解即为随机森林模型的最优参数组合（ntree,mtry）。其寻优步骤如下：
Step 1 将原始数据样本分为两部分，即按照 7：3 的比例划分为训练集和测试集。 Step 2 在搜索空间中随机生成一个灰狼种群 Xi (i  1, 2, , K) ，其中每一个灰狼位置 代表一组参数（ntree , mtry）。同时，对参数进行初始赋值，设置参数 , A,C 的值。 Step 3 将每个灰狼的位置向量代入 RF 模型中，得出个体当前的适应度值。并根据 适应度值将当前最优的三个解赋值为 X 、 X 、 X 。 Step 4 根据 X 、 X 、 X ，其他灰狼个体更新当前的搜索位置。 Step 5 更新步长系数 A 和 C ，计算当前被更新的所有搜索个体的适应度值，从而 得到更新后的 X 、 X 、 X 。 Step 6 按 t  t 1 迭代，若满足要求，则停止搜索，输出最优解 X ；否则，返回 Step 4。 构建基于灰狼优化算法下的随机森林预测模型的流程如图 4-4 所示。
34

第四章 基于随机森林的货运需求预测模型

图 4-4 构建 GWO-RF 预测模型流程图 Fig.4-4 Flowchart of the proposed GWO-RF model

4.3 模型评估和模型选择

4.3.1 评估指标

对于回归模型的效果，其评价指标体系经历了一个逐渐完善的过程。其中，平均绝

对误差（Mean Absolute Error，MAE），均方根误差（Root Mean Square Error， RMSE），

决定系数（Coefficient of determination, R2 ）是最常用，也最具有代表性的性能度量指 标。假设 yˆi 为预测值， yi 为真实值，可以得出不同评价指标的度量情况。
（1）平均绝对误差

 MAE= 1
n

n i 1

yˆi



yi

(4-12)

平均绝对误差是所有单个观测值与算术平均值的偏差的绝对值的平均。与平均误差

相比，平均绝对误差由于离差被绝对值化，不会出现正负相抵消的情况，因而，平均绝

对误差能更好地反映预测值误差的实际情况，是最普遍的度量标准之一。

（2）均方根误差

 RMSE 

1 n

n i 1

( yˆi



yi

)2

(4-13)

均方根误差表示预测值和观测值之间差异（称为残差）的样本标准差，可用来说明

35

第四章 基于随机森林的货运需求预测模型

样本的离散程度。做非线性拟合时，均方根误差越小越好。

使用 RMSE 的缺点在于，由于它使用的是平均误差，而平均误差对异常点较敏感， 如果学习器对某个点的预测值很不合理，那么它的误差则比较大，从而会对 RMSE 的值 有较大影响。但是，用 RMSE 来定义损失函数是平滑可微的，且更容易进行数学运算， 它仍然是许多模型的默认度量标准。

（3）决定系数

 R2  1 ( yˆi  yi )2  ( yi  y)2

(4-14)

R2 是多元回归中的回归平方和占总平方和的比例，它是度量多元回归方程中拟合程

度的一个统计量，反映了回归模型所解释的因变量方差在总方差中的比例，或者说方程

对预测值的拟合程度如何。

理论上， R2 的取值范围是（-,1] ，正常取值范围为 [0,1] 。 R2 越接近 1，则表明特征

对因变量的解释能力越强，该模型对数据的拟合效果也越好；反之， R2 越接近 0，表明 模型拟合的越差。

4.3.2 交叉验证 在对学习器进行评估选择的过程中，通常会将数据集分为训练集（training set）跟
测试集（testing set）这两个子集，前者用以建立模型，后者则用来评估该模型对未知样 本进行预测时的精确度，即泛化能力（generalization ability）。无论是分类模型还是回归 模型，良好的泛化能力都是机器学习算法要达到的目标，而泛化能力是由测试误差估计 的泛化误差来评判的。通过评估得到高精确度和低预测误差的模型，是研究的期望。
然而，同一数据集如果既用于训练，又进行模型误差估计，对误差的估计会很不准 确，这就是模型误差估计的乐观性。为了克服这个问题，提出了交叉验证 （Cross-Validation）。交叉验证的基本思想是将数据分为两部分，一部分数据用来模型的 训练，称为训练集；另外一部分用于测试模型的误差，称为测试集。由于两部分数据不 同，估计得到的泛化误差更接近真实的模型表现。数据量足够的情况下，可以很好的估 计真实的泛化误差。但是实际中，往往只有有限的数据可用，需要对数据进行重复利用， 从而对数据进行多次切分，得到相对准确的误差估计。
对原始数据集采取不同的划分策略，模型精度的验证结果也不同。交叉验证可以解 决人为划分带来的随机性问题。通过对一个样本数据集进行多次不同的划分，得到不同 的互补子集，用训练集对分类器进行训练，在利用测试集来测试误差，反复进行，取多 次测试的平均值，即模型的泛化误差作为评价分类器的性能指标。常见的交叉验证方法 步骤如下：
将给定的数据样本集 D 划分为 k 个大小相似的互斥子集，即

36

第四章 基于随机森林的货运需求预测模型

D=D1 D2

Dk，Di Dj  (i  j) 。每个子集 Di 都尽可能保持数据分布的一致性，即

从 D 中通过分层采样得到。然后，每次用 k-1 个子集的并集作为训练集，余下的那个子

集作为测试集；这样就可以获得 k 组训练/测试集，从而可进行 k 次训练和测试，最终返

回的是这 k 个测试结果的均值。显然，交叉验证法评估结果的稳定性和准确性在很大程

度上取决于 k 的取值。为强调这一点，通常把交叉验证法称为“k 折交叉验证”（k-fold

Cross-Validation）[75]。图 4-5 给出了 10 折交叉验证的示意图。

图 4-5 10 折交叉验证原理 Fig.4-5 Schematic of 10-fold cross-validation
泛化误差反映了模型的泛化能力，泛化误差越小，则证明模型的预测性能越好。使 用交叉验证，不仅可以使有限的数据信息得到最大化的利用率，还可以在一定程度上减 小模型发生过拟合的情况。
4.4 本章小结
基于第三章提取的关键影响因素，本章节建立了货运需求预测模型。由于本研究的 数据样本为典型的高维小样本数据，因此采用随机森林回归算法建立预测模型。同时， 鉴于标准随机森林算法中的参数组合（ntree , mtry）多采用经验取值，本章节提出可利用 灰狼优化算法对其进行参数寻优，从而构建 GWO-RF 预测模型。
37

第五章 实例研究
第五章 实例研究
基于第三章中的多阶段混合式特征提取方法和第四章中的 GW-RF 铁路货运需求预 测模型，本章节将结合实际案例进行有针对性的货运需求预测工作。
5.1 南铁集团概况
中国铁路南昌局集团有限公司，即南昌铁路局，是中国铁路总公司管理的大型铁路 运输企业的 18 个铁路局之一，主要经营江西、福建两省全部和湖南、湖北两省境内部 分铁路运输及其相关产业，管辖京九、合福、沪昆普速、沪昆高铁、武九普速、武九高 铁、铜九、皖赣、鹰厦、峰福、赣龙、赣瑞龙、温福、福厦、厦深、昌福、昌赣、昌九 城际、吉衡、赣韶、九景衢等主要干线和 60 多条支线。截至 2019 年 5 月底，集团公司 营业里程达 8082.5 公里，其中高速铁路 2467.4 公里，全路排名第 5 位。时速 200 公里 及以上铁路 3321.6 公里，时速 300 公里及以上的铁路 1078.3 公里。南昌局集团公司管 辖范围东接“长三角”地区、南连“珠三角”地区，在全国铁路网中发挥着承东启西、 沟通南北的作用。因此，对其货运需求的预测，对于探究货运发展对策有重要的现实意 义。
属南昌铁路局管辖范围的铁路运营线路及货运站分布如图 5-1 所示，受篇幅所限， 本文只选取部分线路进行展示。
资料来源：《中国铁路总公司（南昌局）统计资料汇编》 图 5-1 南铁集团货运站示意图
Fig.5-1 Schematic diagram of Nanchang railway bureau freight station
38

第五章 实例研究

通过第二章中对铁路货运需求影响因素的定性分析，并综合《中国铁路总公司（南 昌局）统计资料汇编》，本研究初步选取 38 项指标作为货运需求影响因素，由于江西省 内的民航货运发展态势较为一般，市场所占份额远远低于其他货运方式，所以本文采取 其余 37 项影响因素进行研究，分别为：货车旅行速度（x1），机车平均全周转时间（x2）， 装卸机械化比重（x3），日均装车数（x4），机车平均牵引总重（x5），日均卸车数（x6）， 货车静载重（x7），货车周转时间（x8），一次货物作业停留时间（x9），货车中转停留时 间（x10），列车运行准点率（x11），货车平均通过总重（x12），货场总建筑面积（x13）， 货仓总使用面积（x14），货物装卸线数量（x15），日均支配机车数（x16），机车检修率（x17）， 管内装卸率（x18），机车日车公里（x19），货车全周转距离（x20），货车日均运输量（x21）， 空车走行率（x22），铁路运输业劳动生产率（x23），营业里程（x24），复线里程（x25）， 货运平均密度（x26），装卸总作业量（x27），运输总支出（x28）、地区生产总值（x29）、 第二产业增加值（x30）、社会消费品零售总额（x31）、居民消费水平（x32）、铁路固定资 产投资（x33）、营业里程电气化率（x34）、铁路运输业就业人员数（x35）、公路货运量（x36）、 水路货运量（x37）等 37 项货运量影响因素作为属性特征；采用 2008-2017 年间，南昌 铁路局 10 年内的铁路货物周转量（Y）作为输出变量。由于篇幅限制，仅展示部分样本 数据，其结构如表 5-1 所示。

特征
2008 2009
… 2016 2017 特征
2008 2009
… 2016 2017 特征
2008 2009
… 2016 2017 特征
2008

x1 /(km·h-1)
32.6 32.3 … 35.6 38.2 x8 /d 2.39 2.41 … 2.63 2.47 x15 /条 375 380 … 373 372 x22 /% 29.6

表 5-1 2008~2017 年铁路运输指标统计数据

x2 /h 41.8 40.9 … 29.7 23.4 x9 /h 18.3 17.9 … 21.5 21.6 x16 /台·d 1029.3 1136.9 … 1526.1 1482.1 x23 / t·月 1456

x3 /% 45.11 50.15 … 71.82 72.56 x10 /h 5.0 5.0 … 5.3 4.8 x17 /% 7.8 6.9 … 6.4 6.7 x24 /km 4345

x4 /车 4136 4015 … 3442 3797 x11 /% 97.8 98.0 … 97.8 97.8 x18 /% 0.98 0.99 … 0.98 0.97 x25 /km 1387.2

x5 /t 1622 1532 … 1271 1410 x12 /t 1714 1620 … 1357 1505 x19 /km 154 248 … 255 264 x26 /(万 t·km-1) 91.7

x6 /车 5345 5212 … 5096 5057 x13 /万 m2 472.2 477.7 … 466.9 463.6 x20 /km 607 598 … 671 652 x27 /万 t 10525.8

x7 /t 60.7 61.2 … 57.5 57.7 x14 /万 m2 23.9 24.9 … 25.8 26.2 x21 /t·km 10600 10500 … 7900 8100 x28 /万元 2015082

39

第五章 实例研究

2009

31.3

1417

4898.2

1933.9

94.7

8869

2083724

…

…

…

…

…

…

…

…

2016

45.9

1305

7503.3

4327.5

180.6

5482.9 3018466

2017

43.8

873

7763.2

4624.9

2092

5516.8 3286589

特征

x29

x30

x31

x32

/亿元

/亿元

/亿元

/元

x33 /亿元

x34

x35

/%

/万人

2008

6971.05 3554.81 2141.8

5805

131.93

39.1

57483

2009

7655.18 3919.45 2484.4

6212

162.94

46.2

60672

…

2016

18499

8829.54 6634.6

16040

180.31

64.8

64038

2017

20006

9627.98 7448.1

17290

186.26

70.5

64717

特征

x36

/万 t

x37 /万 t

Y /(百万 t·km-1)

2008

70270

4616

92568.2

2009

75200

5287

88297.7

…

2016

137782

10894

67866.4

2017

138074

11492

73085.1

数据来源：国家统计局网站 http://data.stats.gov.cn/；《中国铁路总公司（南昌局）统计资料汇编》
其中，对部分统计指标的名词解释如下：

机车平均全周转时间：机车每周转一次平均消耗的时间。

机车平均牵引总重：每台机车平均牵引列车的总重量。、

货车静载重：一定时期内，车站、铁路局或全路每装车一辆平均所装载的货物吨数。

货车周转时间：货车第一次装车完毕时起，至再一次装车完毕时止（即运用货车平

均每周转一次）所消耗的时间，计算时间为天。

一次货物作业停留时间：运用车在站线（包括区间）及专用线（包括路产专用线）

内进行装卸、倒装作业停留的时间。

货车中转停留时间：火车在车站进行解体、改编、中转技术作业及其他中转作业所

停留的时间。

机车检修率：检修机车占支配机车的比重。

管内装卸率：每一工作量平均装卸作业次数，工作量为每天的货运工作循环次数。

机车日车公里：平均每台运用机车在一昼夜内走行的公里。

货车全周转距离：运用货车平均每周转一次走行的公里。

空车走行率：空车走行公里占重车走行公里的比重。

铁路运输业劳动生产率：铁路运输业从业人员在单位时间内的生产效率。运输业劳

动生产率=货物总周转量/铁路运输业从业人员平均数。

货运平均密度：指每公里线路负担的火车载重。

5.2 数据预处理
在多指标综合评价体系中，由于各指标的评价体系不同，它们的量纲和数量级也不
40

第五章 实例研究

同。当各指标间的水平相差很大时，如果直接用原始指标值进行分析，就会突出数值较 高的指标在综合分析中的作用，相对削弱数值水平较低指标的作用。因此，为保证实验 结果的可靠性，在使用数据之前，需对所有数据样本进行标准化处理，以消除原始数据 在数量级和量纲上的差异。
数据标准化(normalization)是将原始数据按一定比例缩放，使之落入一个小的特定区 间，从而使数据转化为无量纲的纯数值，便于不同单位或量级的指标能够进行比较和加

权。其中最典型的就是数据的归一化处理，即将数据统一映射到[0,1]区间上，常用的有

min-max 标准化（min-max normalization），log 函数转换，z-score 标准化等方法。本研

究采用 z-score 标准化方法进行数据预处理，这种方法基于原始数据的均值和标准差进

行数据的标准化，经过处理的数据的均值为 0，标准差为 1。

假设有序列 x1, x2 , xn ，其转化公式为：

yi



xi

x s

(5-1)

这里

则新序列 y1, y2 , 为样本数据。

  x



1 n

n i 1

xi

，s

1 n 1

n i 1

( xi



x )2

(5-2)

yn 的均值为 0，方差为 1，且是无量纲的数值。标准化后的数据作

5.3 货运需求影响因素的特征提取
5.3.1 影响因素的二元比较排序 建立符合实际的隶属函数是模糊数学方法的关键，而特征的重要性评价是特征选择
的基础。因此，在对各影响因素进行重要性排序之前，本文采用二元对比排序法确定特 征间的二元比较级。
通常模糊决策方法中特征的二元对比采用专家打分法，鉴于该定性分析方法可靠性 不高，本文利用 MDA 可实现两个特征之间的二元对比。MDA 值越高，即该特征对于 样本的预测结果影响越大，进而说明其重要程度越高。
设有输入特征 n 个，经排列组合，将所有特征划分为两两组合的特征子集{(xi,xj)|i,j ∈n,i≠j}，即有 C228 =378个特征子集。为评估特征 xi 与特征 xj 的相对重要性，操作步骤如 下：
步骤 1：将只包含 xi, xj 两个特征的样本数据以 7：3 的比例分为训练集和验证集， 训练和验证支持向量机模型，得到预测正确率 acc。
步骤 2：给数据集中的 xi 随机添加噪声，xj 的样本值不变，利用扰动后的样本数据 重新训练和验证支持向量机模型，得到预测正确率 acci。
步骤 3：将步骤 2 重复 N 次，通过求取 acc 与 acci 的误差均值，获得特征 xi 的 MDA。
41

第五章 实例研究

特征 xi 重要性的计算方法为

 1 N

MDAxi 

N

(acc  acci )
i 1

(5-3)

步骤 4：给数据集中的 xj 随机添加噪声，xi 的样本值不变，重新训练模型得到预测

正确率 accj, 重复训练 N 次后，利用公式

 1 N

MDAxj  N

(acc  acc j )
j 1

(5-4)

求得 MDAxj 。则得到特征 xi 与特征 xj 的二元比较级( MDAxi , MDAxj )。

步骤 5：重复步骤 1-4，得到所有特征之间的二元比较级。

5.3.2 影响因素的重要性排序

设论域 U={国内生产总值、第二产业生产总值、社会消费品零售总额、居民消费水 平、固定资产投资、营业里程电气化率、铁路运输业就业人员数、公路货运量、水路货 运量、运行速度、货车周转时间、装卸机械化比重、日均装车数、机车平均牵引总重、 日均卸车数、货车静载重、机车周转时间、一次货物作业停留时间、货车中转停留时间、

列车运行准点率、货车平均通过总重、货场总建筑面积、货仓总使用面积、货物装卸线

数量、日均支配机车数、机车检修率、管内装卸率、机车日车公里、货车全周转距离、

货车日均运输量、空车走行率、装卸全员劳动生产率、营业里程、复线里程、运输密度、 装卸总作业量、运输总支出},A=“最重要的分类特征”是 U 上的模糊集。基于 5.3.1 节中 得到的特征间的二元比较级结果，可构建二元比较级矩阵。由于篇幅限制，本文只列出

矩阵的部分数据:

0.50 0.48 0.45 0.52 0.50 0.48 0.55 0.52 0.50   0.49 0.43 0.45  0.11 0.12 0.09 0.47 0.43 0.43

0.51 0.89 0.53 0.57 0.88 0.57 0.55 0.91 0.57
  0.50 0.87 0.51  0.13 0.50 0.12 0.49 0.88 0.50

将

(

fj ( xi ),

fi(xj))

代入

f

( xi

|

def
xj) 

fj(xi) 中，计算得到模糊相及矩阵，在此基础上

fj(xi)  fi(xj)

利用 λ-截矩阵方法进行影响因素重要程度排序，具体步骤为：对模糊相及矩阵的每行求

下确界，即每行最小值，以最大下确界所在行对应的 xi 为第一优越对象；划去第 i 行与 第 i 列，得 n-1 阶模糊相及矩阵，类似地找出第二优越对象；依此进行下去，就可对所

有影响因素进行总体排序，得到优先排序结果。各因素影响程度由低到高的排序结果如

图 5-2 所示。

42

第五章 实例研究

图 5-2 影响因素重要程度排序图 Fig.5-2 The ranking results of the influence degree of each factor

5.3.3 关键影响因素的选取

序列前向选择（Sequential Forward Selection, SFS）策略 , 特征子集 X 从空集开始，每次 选择一个特征 x 加入特征子集 X，使得特征函数 F(X)最优。依照 5.3.3 节中影响因素的

重要性排序结果，将样本数据从高到低重新整理，利用 SFS 策略对特征子集逐次添加重

要性最高的特征并重新训练模型。当平均绝对误差（δMAE）最小，平方相关系数（R2） 最大时，所对应的输入变量个数 k 就是最优特征子集的维度。从而可选取重要度最大的

前 k 个变量作为模型的最优输入特征集。选取 2008~2014 年间的样本数据进行拟合训练，

即训练集；2015~2017 年间的样本进行外推预测检验，即验证集。分别采用 BP 神经网

络（Back Propagation Neural Network, BPNN）、支持向量机（Support Vector Machine,

SVM）、随机森林（Random Forest, RF）算法构建训练模型。

其中，本文在构建 BP 神经网络模型时，由于输入样本有 28 个指标，故第一层(隐

含层)神经元个数设置为 2×28+1=57 个，而样本输出仅 1 个全社会货物运输量指标，故

第二层(输出层)神经元个数设置为 1 个。训练函数设置为 trainlm 函数，自适应函数设

置为 learngdm 函数，第一层的传递函数设置为 tansig 函数，第二层的传递函数设置为

purelin 函数。训练周期设置为 500，平均误差平方和设置为 10-10。在构建支持向量机模

型时，本研究采用径向基核函数 (Radial Basis Function, RBF)，即

 RB（F xi, xj）= exp( xi  xj )2 / 2 2 ,  0

(5-5)

为消除偏差影响，本文采用 5 折交叉验证评价各模型在不同输入情况下的拟合效果，

通过计算所得平均绝对误差（δMAE）和平方相关系数（R2）评价模型的预测效果。

  M A E 1 n y( t) ˆ y( t) n t1

(5-6)

43

第五章 实例研究

 R2 =

( yˆ (t ) y (t2 ) ) ( y (t ) y (t2 ) )

其中， y(t) 为真实值， y(t) 为真实值的均值， yˆ(t) 为预测值。

基于 ANN、SVM、RF 算法的回归模型的拟合效果见表 5-2。

特征 个 数

表 5-2 各模型随特征个数变化的拟合效果

ANN

R2

δMAE

RF

R2

δMAE

SVM

R2

δMAE

1 0.584 0.450 2 0.778 0.239 3 0.814 0.154 4 0.812 0.162 5 0.771 0.243 6 0.786 0.224 7 0.747 0.253 8 0.767 0.248 9 0.769 0.246 10 0.742 0.258 11 0.818 0.153 12 0.836 0.142 13 0.864 0.138 14 0.872 0.131 15 0.823 0.153 16 0.827 0.150 17 0.831 0.147 18 0.816 0.152 19 0.825 0.144 20 0.823 0.148 21 0.834 0.136 22 0.835 0.136 23 0.821 0.150 24 0.832 0.138 25 0.831 0.139 26 0.821 0.150 27 0.787 0.205 28 0.804 0.186 29 0.820 0.149 30 0.826 0.145 31 0.833 0.128

0.759 0.836 0.857 0.878 0.879 0.837 0.857 0.875 0.843 0.821 0.844 0.875 0.878 0.897 0.854 0.863 0.872 0.855 0.857 0.858 0.857 0.854 0.860 0.856 0.836 0.848 0.847 0.847 0.849 0.869 0.857

0.456 0.430 0.393 0.369 0.308 0.232 0.210 0.301 0.213 0.211 0.233 0.215 0.213 0.209 0.212 0.242 0.240 0.244 0.349 0.339 0.309 0.306 0.307 0.347 0.325 0.374 0.383 0.382 0.307 0.347 0.325

0.761 0.809 0.853 0.881 0.880 0.837 0.841 0.850 0.836 0.835 0.871 0.885 0.878 0.877 0.859 0.862 0.859 0.858 0.848 0.858 0.850 0.856 0.857 0.858 0.857 0.842 0.839 0.840 0.841 0.861 0.854

0.537 0.380 0.373 0.384 0.259 0.208 0.275 0.267 0.241 0.211 0.220 0.202 0.239 0.214 0.206 0.232 0.247 0.255 0.287 0.289 0.297 0.309 0.323 0.315 0.326 0.325 0.298 0.339 0.309 0.323 0.315

(5-7)

44

第五章 实例研究

32 0.831 0.141 33 0.825 0.147 34 0.824 0.143 35 0.805 0.181 36 0.824 0.143 37 0.823 0.148

0.866 0.858 0.865 0.871 0.870 0.857

0.374 0.383 0.211 0.215 0.212 0.231

0.860 0.861 0.854 0.861 0.856 0.855

0.326 0.302 0.241 0.211 0.220 0.247

三种预测模型下的 R2 随输入特征数量的变化曲线如图 5-3—图 5-5 所示。

图 5-3 BP 神经网络模型中 R2 随变量个数的变化曲线 Fig.5-3 Change trends of R2 with variable number of the BPANN model

图 5-4 RF 模型中 R2 随变量个数的变化曲线 Fig.5-4 Change trends of R2 with variable number of the RF model
45

第五章 实例研究
图 5-5 SVM 模型中 R2 随变量个数的变化曲线 Fig.5-5 Change trends of R2 with variable number of the SVM model
特征选择是数据挖掘中的一项重要工作，特别是在样本容量小、维数高的情况下。 本文提出了一种将机器学习与模糊评价理论相结合的嵌入式方法。在保证模型预测性能 的同时达到降低维度的目的。按照表 5-2 中特征的重要性顺序依次加入分析特征，然后 比较加入每个特征时的预测性能。根据图 5-3—图 5-5 可以看出，ANN 预测模型中，当 输入特征个数为 14 个时，δRMSE 最小，R2 最大；RF 预测模型中，当输入特征个数为 14 个时，δRMSE 最小，R2 最大；SVM 预测模型中，当输入特征个数为 12 个时，δRMSE 最 小，R2 最大。由此可见，随着数量的增加，特征对预测性能的影响开始逐渐增强，然 后逐渐减弱。当前 14 个特征组成特征子集时，预测误差和准确性的评价指标分别达到 最优值。随后值趋于稳定，仅在小范围内波动。这意味着模型的预测性能补会因为特征 数的增加而得到显著的提高。因此，我们得到了最佳特征子集为{货车平均通过总重、 公路货运量、货物日均卸车数、第二产业增加值、机车平均全周转时间、货仓总使用面 积、货物列车旅行速度、装卸机械化比重、居民消费水平、货车周转时间、装卸全员劳 动生产率、货车日均装车数、货场总建筑面积、机车平均牵引总重}。根据结果，只需 要 14 个相关因素的数据样本即可获得最准确的预测值，成功降低了特征向量的维数， 降维率高达 62%。
5.4 南铁货运需求预测
5.4.1 建立预测模型 机器学习具有良好的学习非线性关系的能力，因此，可以作为一种实时计算模型来
处理生命科学数据。其基本思想是：假设从获取的数据中得到了一个包含 m 个实例的数 据集，即输入空间：X={x1, x2,…,xi, …,xm},每个实例由 d 个属性描述：x i=(xi, 1, xi, 2,…, xi, d)，
46

第五章 实例研究
i=1, 2, ..., m；并定义了所有实例对应输出的集合 Y，即输出空间，其中 yi∈Y 是实例 xi 的输出。在此基础上通过对训练集 D={(x1,y1),(x2,y2),...,(xm,ym)}进行学习，可以建立一个 从输入空间 X 到输出空间 Y 的映射：f：X→Y。当这个映射关系被应用到一组新的输入 上，训练的模型可以根据学习到的因果关系来产生相应的输出。本文的输入空间为实例 数据集 X={x1, x2,…,xk}，每个实例由 14 个属性描述：xi={货车平均通过总重、公路货运 量、货物日均卸车数、第二产业增加值、机车平均全周转时间、货仓总使用面积、货物 列车旅行速度、装卸机械化比重、居民消费水平、货车周转时间、装卸全员劳动生产率、 货车日均装车数、货场总建筑面积、机车平均牵引总重}；输出空间为对应的标记 yk={货 物周转量}。
采用的预测算法为随机森林, 随机森林算法是一种流行的集成学习方法。集成学习 把 k 个学习得到的模型（或基学习器）M1,M2,…,Mk 组合在一起，旨在创建一个改进的复 合模型 M*。使用给定的数据集 D 创建 k 个训练集 D1,D2,…,Dk，其中 Di 用于创建基学习 器 Mi。给定一个待预测的数据元组，每个基学习器返回各自的预测结果，集成学习器基 于基学习器预测结果的均值返回最终预测值。随机森林简单、容易实现、计算开销小， 在很多现实任务中展现出强大的性能。随机森林中基学器的多样性不仅来自样本扰动， 还来自属性扰动，这就使得最终集成的泛化性能可通过个体学习器之间差异度得增加而 进一步提升，另外，随着森林中树的个数增加，随机森林通常会收敛到一个更低的泛化 误差，能有效降低过拟合的风险。
随机森林算法已广泛应用于各种分类和回归问题，在应用过程中影响随机森林回归 预测性能的主要参数有决策树的个数 ntree 和树节点预选的分裂变量个数 mtry。针对参数 ntree 和 mtry 的合理取值问题，目前多采用经验尝试法来解决，但这难以确保随机森林性 能最佳，因此本文使用改进的灰狼算法优化其参数。在初始化的狼群中，每条狼表示一 个（ntree,mtry）参数组合, 狼群根据位置更新策略进行寻优，以在验证集样本上的分类准 确率为目标函数，搜索到的全局最优解即为随机森林模型的最优参数组合（ntree,mtry）。
同时，为验证本文所提方法的优越性，将采用不同的智能算法对随机森林参数进行 优化，并通过与经验参数设置下的随机森林算法对比分析，评价不同模型的预测性能。 众多智能优化算法中，粒子群算法（Particle Swarm optimization, PSO）作为经典的智能 优化算法之一，由于计算速度快、易实现且效果较好等优点，在多目标寻优问题上得到 广泛应用，因此我们将选用粒子群算法作为对比[76]。
图 5-6 展示了灰狼算法和粒子群算法在标准测试函数上寻优的效果图，可以看出在 相对简单的寻优任务上，灰狼算法能更快的收敛；对于复杂的寻优任务，灰狼算法具有 更强的搜索能力。由此可见，灰狼算法比粒子群算法的优化效果更佳。
47

第五章 实例研究
图 5-6 灰狼算法与粒子群算法优化效果对比图 Fig.5-6 Comparison results of GWO and PSO
5.4.2 预测效果对比及分析 利用 R 3.6.0 实现了灰狼算法优化的随机森林。所有的训练和测试均运行在具有 4.2
GHz 处理器、32 GB 内存、64 位 Win10 环境的硬件设备上。 图 5-7 显示的是初始化的狼群位置，图中每只狼代表一个（ntree ,mtry）参数组合。经
过 20 次迭代后狼群有了明显的聚集现象，说明解在向局部极值收拢，结合图 5-8 可以 看出，经过 10 次迭代后目标函数 R2 值趋于收敛，可认定局部极值中有近似全局最优解 的存在。本次寻优的最优解为（ntree =2000, mtry=9）。
从图 5-8 中可以看出，基于灰狼算法优化的随机森林得到的 R2 值最高为 0.963，说 明该模型下的预测值与真实值的拟合程度最高；而基于粒子群算法优化的随机森林得到 的 R2 值为 0.941，拟合效果其次；传统随机森林方法得到 R2 值的为 0.890，即该模型下 的预测值与真实值的拟合程度最低。另外，基于灰狼算法优化的随机森林收敛领先于基 于粒子群算法优化的随机森林收敛，GW_RF 在迭代 10 次后趋于平稳，PSO_RF 在 13 次后趋于平稳，说明比起粒子群算法，灰狼算法优化的随机森林能更快的找到最优参数 组合。总的来说，在我们的实验中，利用灰狼算法优化后的随机森林方法明显优于其他 两种方法。
48

第五章 实例研究
图 5-7 寻优过程中的狼群分布 Fig.5-7 Distribution of wolves in the process of optimization
49

第五章 实例研究

图 5-8 各模型预测效果随迭代次数的变化情况 Fig.5-8 The prediction effect of different model with the number of iterations

另外，为验证本文预测模型的可靠性，将 GWO-RF 模型与货运需求预测中常用的 时间序列模型、GM(1,1)灰色预测模型以及多元线性回归模型分别对 2015-2017 年这三 年间的南铁货物周转量进行预测，并将预测值与真实值相比，检验 4 种不同模型的拟合 效果，表 5-3 展示了不同模型的对比结果。

年 份 2015 2016 2017

多元线性回归

R2

δMAE

0.584 0.550

0.578 0.439

0.723 0.348

表 5-3 各模型的拟合效果

GM(1,1)

时间序列

R2

δMAE

R2

δMAE

0.759 0.356

0.661 0.537

0.636 0.430 0.757 0.331

0.609 0.580 0.755 0.347

GWO-RF

R2

δMAE

0.958 0.187

0.964 0.160

0.962 0.157

由表 5-3 可知，与其他三种预测模型相比，GWO-RF 模型的 R2 高于其他模型，δMAE 低于其他模型，在历年的预测表现均能达到拟合效果最佳的结果，由此可证明 GWO-RF 模型的预测精度和预测性能优于其他预测模型。

5.5 本章小结
基于第三章构建的特征选择模型，以及第四章构建的货运需求预测模型，本章节采 集南铁 2008-2017 年间的相应数据，利用实际案例对前文的理论成果进行了验证分析， 在评估模型可靠性上，一方面，分别利用不同算法优化下的随机森林进行预测，纵向评 估了不同模型的预测性能和效果；另一方面，分别利用现有研究中常用的 3 种货运需求 预测模型与 GWO-RF 模型的预测结果想比较，横向评估得到了 GWO-RF 模型性能最佳 的结论。

50

第六章 总结和展望
第六章 总结和展望
6.1 全文总结
本文在铁路进行运输结构调整以及货运量的市场份额持续下降的市场背景下，以预 测铁路货运需求的实际意义出发，在铁路货运需求相关影响因素分析的基础上，进一步 探究如何建立预测精度更高、模型泛化能力更强的铁路货运需求预测模型，完成了基于 算法融合的特征选择、模型参数的优化以及预测模型的构建和对比分析等一系列工作， 并利用实际案例验证了研究成果。根据实验结果，本文的主要工作和结论如下：
（1）铁路货运需求的关键影响因素有 14 个，按照它们的影响程度从高到低排列， 依次为货车平均通过总重、公路货运量、货物日均卸车数、第二产业增加值、机车平均 全周转时间、货仓总使用面积、货物列车旅行速度、装卸机械化比重、居民消费水平、 货车周转时间、装卸全员劳动生产率、货车日均装车数、货场总建筑面积、机车平均牵 引总重。
铁路的货物运输系统受多个因素影响，且具有不确定性、模糊性和非线性的特点， 因此在进行铁路货运需求预测时，为达到较全面的信息覆盖率，得到泛化性能更优的预 测模型，需要综合外部需求侧和内部供给侧两个方面进行分析。考虑到多个特征因素之 间可能存在一定的特征冗余，且过高的特征维度会影响后续预测模型的构建，因此本文 结合定性分析和定量分析的方法，以更科学严谨的选取策略对货运需求影响因素进行筛 选，在最大程度保证预测精度的前提下约束模型的复杂度。本文采用了一种多阶段混合 式的特征提取方法，其主要思路是先利用改进的模糊决策理论得到影响因素的重要度排 序，然后基于机器学习算法筛选出可使预测精度达到最高的特征子集，该特征子集即为 关键影响因素的集合。目前，模糊决策方法中对于元素二元比较级的确定通常采用专家 打分法，鉴于该定性分析方法可靠度不高，本文创新性的采用基于随机森林算法中的 OBB 分类准确率为工具计算两两特征之间的相对重要程度，量化分析了货运内部因素 内在的复杂联系，排序结果更加精准科学。
（2）本文采用铁路货物周转量作为货运需求的代表性指标，提出基于优化随机森 林的货运需求预测模型，经实验验证，相比传统的机器学习模型，基于灰狼算法优化的 随机森林模型具有更理想的预测性能。
相比只研究单一时间维度的传统时间序列预测模型，或是对数据分布及关联度有假 设条件的传统回归模型，以数据为驱动的机器学习理论为物流需求预测领域提供了新的 思路。由于本研究采用的数据样本有限，而随机森林在小样本上的表现优于其他经典机 器学习模型[77]，因此本文采用随机森林作为货运需求预测的基础模型。然而，基本随机 森林算法中通常采用经验参数，为提高模型的预测精度与稳定性，本文采用不同的智能
51

第六章 总结和展望
算法对随机森林进行参数优化，从而提高模型的预测效率与预测准确率。分别利用近年 来兴起的灰狼算法，以及广泛应用的粒子群算法进行随机森林参数寻优，并与基本随机 森林模型进行横向对比。实验结果发现，未优化的随机森林模型平方相关系数为 0.890， 即预测精度最低；基于粒子群算法的随机森林模型平方相关系数为 0.941，预测精度较 好；基于灰狼算法的随机森林模型平方相关系数为 0.963，预测精度最好。同时，相比 粒子群算法，灰狼算法的寻优速度更快，预测效率更高。由此可见，基于灰狼算法优化 的随机森林模型表现最好，具有最佳的预测性能，该结论有助于实际应用中把握铁路货 运情况，对于铁路物流成本控制具有一定的现实意义。
6.2 研究展望
本文对基于特征选择和算法融合的铁路货运需求预测研究展开了系统的试验分析， 基本实现了精准预测铁路货运需求的目标。但受限于准备时间紧张，以及本人学术水平 有限，本研究尚存在很多不足之处，需要从以下两个方面开展进一步的研究：
（1）数据样本量不足。由于分析的特征变量维度较高，并且铁路货运系统涉及的 影响因素范围广，相关统计数据庞大冗杂。2008 以前，甚至缺乏完整的货运数据统计， 只能查阅部分指标数据，缺乏本研究所需的大量细化指标的年统计量资料，使得本研究 能够采集的数据资料有限，一定程度上阻碍了预测模型的效果。随着数据挖掘在铁路相 关研究领域的蓬勃发展，铁路的货运数据资料必将愈发完善，为后续研究提供充分的数 据支持。
（2）政策因素的分析不足 本文对货运需求影响因素的分析虽然尽力做到全面，但对政策因素的分析不足。 2018 年，国务院确定了以推进大宗货物运输“公转铁、公转水”为主攻方向的行动计划。 通过大力发挥铁路的绿色、环保优势，提高物流行业的综合运输效率，调整运输结构。 在政策红利推动下，必将带来铁路货运需求空间扩大；另一方面，现代物流行业是合作 共赢的市场。随着多式联运的发展，铁路物流平台与其他运输平台之间已逐渐超越狭隘 竞争范畴的关系，在多式联运的动态衔接下，不同运输方式的优势得以发挥，能切实提 高铁路运输供给质量，从而有益于铁路货运需求上升。因此，本文简单的将铁路运输与 其他运输方式视为竞争关系是不够准确的，后续研究中应当对其内部的复杂关联进行进 一步深入的探讨。
6.3 政策建议 通过特征选择及排序结果可知，铁路货运需求的关键影响因素主要集中在铁路自身
供给方面，因此本文主要从铁路自身运输组织结构调整方面提出政策性建议，为铁路运 输提高市场竞争优势，扩大货运需求提供一定参考。
第一，缩短货物运达期限。目前铁路货运快运班列的运输组织基本采用了“五固定”
52

第六章 总结和展望
的方式运行，即固定车次、固定编组、固定时间、固定路线、固定停站，用客车的标准 组织开行货物快运班列。其中直接影响铁路部门盈利的因素就是固定编组和固定停站， 由于初期宣传力度不够，很多车站几乎没有货物需求，所以快运列车基本处于空运状态， 站站停的模式极大的增大了运输成本。故而该种运输组织方式并不适合铁路物流的长期 健康发展，可以考虑规范车站作业流程、灵活编组、减少停站等方式。
第二，大力发展多式联运。要创新设计公铁、铁水和铁航等多式联运中的关键技术 和关键设备，提升效率和控制成本，将不利因素化为有利因素。要加强铁路与公路、水 运、空运等信息平台的互联互通和公开共享，整合搭建物流大数据共享信息平台，推动 建立船、车、班列、港口、场站、货物等信息资源开放与共享机制。打造“互联网+交 通物流”服务模式，实现需求提报、到达交付、信息查询、通关查验、转账结算、保价 理赔等“一站式”线上服务。同时，铁路货运也应在推动多式联运的过程中，建立以铁 路集装箱及其内部自由分箱、联合物流中心自动分拣系统为主导的快递配送标准体系， 在效率和服务上打赢竞争对手。
第三，提升自身服务质量。铁路需要充分借用自身品牌及信誉，利用铁路强大的投 融资能力，精耕细作，在物流网络建设上实现新的突破。在“十三五”规划中，铁路仅 固定资产投入就达到了 3.5 万亿元至 3.8 万亿元，这是任何快递企业无法企及的资本高 度，铁路货运要充分发挥铁路网络优势，利用与地方政府和民营资本的共赢，形成强大 的物流服务优势和规模效应，并借此实现铁路货运的现代化升级改造。
53

参考文献
参考文献
[1] 张诚,于兆宇,刘美玲.新时代铁路货运加速向现代物流转型的动力和举措[J].北京交通大学学报 (社会科学版),2019,18(01):10-18.
[2] 张小强,刘丹,王斌.多运输方式竞争下的铁路快捷货运定价方法[J].交通运输系统工程与信 息,2016,16(05):27-32.
[3] 肖润谋,闫晟煜,陈荫三.铁路货运市场的定位和政策建议[J].综合运输,2016,38(04):25-29. [4] 周新军.中国铁路货运转型发展:基于综合交通运输结构优化的视角[J].华北电力大学学报(社会科
学版),2019(02):48-61. [5] 刘杰,何世伟,郭建民,周建国.铁路货运产品与车站资源协同分配优化模型及算法研究[J].铁道学
报,2017,39(05):15-21. [6] 樊桦.我国铁路货运需求影响因素及发展趋势[J].综合运输,2018,40(02):12-17+22. [7] 于春荣,张智文.铁路货物运输需求的建模与经济分析[J].工业技术经济,2008(05):113-115. [8] Anoop K P, Panicker V V, Narayanan M, et al. A mathematical model and solution methods for rail
freight transportation planning in an Indian food grain supply chain[J]. Sadhana-academy Proceedings in Engineering Sciences, 2018, 43(12). [9] Peetawan W, Suthiwartnarueput K. Identifying factors affecting the success of rail infrastructure development projects contributing to a logistics platform: A Thailand case study[J]. The Kasetsart Journal Social Sciences, 2018, 39(2): 320-327. [10] 冯 芬 玲 , 周 广 富 . 基 于 Kano 模 型 的 铁 路 货 运 服 务 质 量 提 升 策 略 分 析 [J]. 铁 道 科 学 与 工 程 学 报,2017,14(09):2005-2012. [11] 李名良.铁路货运需求影响因素研究——以美国为例[J].综合运输,2017,39(02):83-86. [12] Laroche F, Sys C, Vanelslander T, et al. Imperfect competition in a network industry: The case of the European rail freight market[J]. Transport Policy, 2017: 53-61. [13] Guo J, Wang J, Li Q, et al. Construction of prediction model of neural network railway bulk cargo floating price based on random forest regression algorithm[J]. Neural Computing and Applications, 2019, 31(12): 8139-8145. [14] Woodburn A G. Rail network resilience and operational responsiveness during unplanned disruption: A rail freight case study[J]. Journal of Transport Geography, 2019: 59-69. [15] Khan M Z, Khan F. Estimating the demand for rail freight transport in Pakistan: A time series analysis[J]. Journal of Rail Transport Planning & Management, 2020. [16] 郭 玉 华 , 陈 治 亚 , 冯 芬 玲 , 畅 博 . 基 于 经 济 周 期 的 铁 路 货 运 量 神 经 网 络 预 测 研 究 [J]. 铁 道 学 报,2010,32(05):1-6. [17] 刘 畅 , 左 忠 义 , 尹 盼 盼 , 王 菁 . 基 于 服 务 水 平 的 铁 路 货 运 价 格 优 化 研 究 [J]. 中 国 安 全 科 学 学 报,2018,28(S2):133-137. [18] 马元园.论营改增对铁路运输企业的影响及对策分析[J].财经界(学术版),2019(15):207-208. [19] 林婉婷.“公转铁”形势下铁路货运市场发展探讨[J].铁道货运,2019,37(08):44-48. [20] Guo Z, Fu J. Prediction Method of Railway Freight Volume Based on Genetic Algorithm Improved General Regression Neural Network[J]. Journal of intelligent systems, 2018, 28(5): 835-848. [21] 崔 淑 华 , 王 娜 , 胡 亚 南 . 基 于 主 成 分 分 析 的 公 路 货 运 量 预 测 影 响 因 素 研 究 [J]. 森 林 工 程 , 2005(05):67-69. [22] Yang Y, Yu C. Prediction models based on multivariate statistical methods and their applications for
54

参考文献
predicting railway freight volume[J]. Neurocomputing, 2015: 210-215. [23] De Bakshi N, Tiwari G, Bolia N B, et al. Influence of urban form on urban freight trip generation[J].
Case studies on transport policy, 2019. [24] 文书生,叶怀珍.我国铁路货运需求结构的VAR模型分析[J].铁道运输与经济,2008(10):1-5. [25] Nuzzolo A, Comi A. Urban freight demand forecasting: A mixed quantity/delivery/vehicle-based
model[J]. Transportation Research Part E-logistics and Transportation Review, 2014: 84-98. [26] Gelhausen M, Berster P, Wilken D, et al. A new direct demand model of long-term forecasting air
passengers and air transport movements at German airports[J]. Journal of Air Transport Management, 2018: 140-152. [27] 张戎,何羽璐.我国铁路货运量影响因素探析[J].铁道货运,2019,37(11):14-21. [28] 叶艺勇,黄志明.关于偏远地区物流货运量精准预测仿真[J].计算机仿真,2018,35(03):397-400. [29] 梁宁,耿立艳,张占福,梁毅刚.基于GRA与SVM-mixed的货运量预测方法[J].交通运输系统工程与 信息,2016,16(06):94-99. [30] 游 艳 雯 , 郑 平 标 , 段 蕴 桔 . 铁 路 货 车 周 转 时 间 影 响 因 素 及 优 化 对 策 探 析 [J]. 铁 道 货 运,2019,37(01):7-11. [31] Wan Q T, Peng Z, Ke Q. Railway Freight Volume Forecast Based on GRA-WD-WNN[C]//4th International Conference on Intelligent Transportation Engineering, Singapore: IEEE, 2019:5-7. [32] JIANG Y S, ZHANG D K, WANG X M, et al. Exploring high dimension large data correlation analysis with mutual information and application[C]//International Conference on Oriental Thinking and Fuzzy Logic, Springer International Publishing, 2016. [33] 颜保凡,郭垂江,李夏苗.铁路货运量的内部影响因素及其敏感度分析[J].铁道科学与工程学 报,2018,15(05):1341-1346. [34] 武 华 华 , 匡 海 波 , 张 鹏 飞 . 基 于 VMD-WA-RFR 模 型 的 BDI 指 数 影 响 因 素 研 究 [J]. 科 研 管 理,2018,39(10):148-158. [35] 李丽辉,朱建生,强丽霞,乔庆杰.基于随机森林回归算法的高速铁路短期客流预测研究[J].铁道运 输与经济,2017,39(09):12-16. [36] Lim S, Yun H. An Analysis on Determinants of the Capesize Freight Rate and Forecasting Models[J]. Journal of Korean Navigation and Port Reserch, 2018, 42(6): 539-545. [37] Speiser J L, Miller M, Tooze J A, et al. A comparison of random forest variable selection methods for classification prediction modeling[J]. Expert Systems With Applications, 2019: 93-101. [38] [39] Sebastián Maldonado,Julio López. Dealing with high-dimensional class-imbalanced datasets: Embedded feature selection for SVM classification[J]. Applied Soft Computing, 2018, 67. [40] 吴华稳. 混沌时间序列分析及在铁路货运量预测中的应用研究[D].中国铁道科学研究院,2014. [41] 谢建文,张元标,王志伟.基于无偏灰色模糊马尔可夫链法的铁路货运量预测研究[J].铁道学 报,2009,31(01):1-7. [42] 尹 左 斌 , 郑 鹏 辉 , 梅 家 农 , 张 恩 . ARIMA 模 型 在 铁 路 货 运 量 预 测 中 的 应 用 [J]. 铁 道 货 运,2008(06):8-11+1. [43] Argyropoulos C, Panopoulou E. Measuring the Market Risk of Freight Rates: A Forecast Combination Approach[J]. Journal of Forecasting, 2018, 37(2): 201-224. [44] Feng F, Li W, Jiang Q, et al. Railway freight volume forecast using an ensemble model with optimised deep belief network[J]. Iet Intelligent Transport Systems, 2018, 12(8): 851-859. [45] 林昊.基于BP神经网络的福州市物流需求预测[J].物流工程与管理,2018,40(05):39-41.
55

参考文献
[46] 倪 继 娜 , 张 巍 , 张 栋 . 大 秦 铁 路 煤 炭 运 输 需 求 分 析 与 预 测 [J/OL]. 铁 道 货 运 , 2020(01):49-54[2020-02-07].https://doi.org/10.16669/j.cnki.issn.1004-2024.2020.01.10..
[47] 耿 立 艳 , 陈 丽 华 . 基 于 FOA 优 化 混 合 核 LSSVM 的 铁 路 货 运 量 预 测 [J]. 计 算 机 应 用 研 究,2017,34(02):409-412.
[48] 周 程 , 施 文 , 马 士 华 . 基 于 改 进 PSO-BP 非 线 性 补 偿 的 货 运 量 “ 分 解 - 集 成 ” 预 测 [J]. 统 计 与 决 策,2018,34(09):81-85.
[49] Plakandaras V, Papadimitriou T, Gogas P, et al. Forecasting transportation demand for the U.S. market[J]. Transportation Research Part A-policy and Practice, 2019: 195-214.
[50] Moscosolopez J A, Turias I J, Come M J, et al. Short-term Forecasting of Intermodal Freight Using ANNs and SVR: Case of the Port of Algeciras Bay[J]. Transportation research procedia, 2016: 108-114.
[51] Mi Chunrong,Huettmann Falk,Guo Yumin,Han Xuesong,Wen Lijia. Why choose Random Forest to predict rare species distribution with few samples in large undersampled areas? Three Asian crane species models provide supporting evidence[J]. PeerJ, 2017, 5.
[52] Barbour W, Samal C, Kuppa S, et al. On the Data-Driven Prediction of Arrival Times for Freight Trains on U.S. Railroads[C]. international conference on intelligent transportation systems, 2018: 2289-2296.
[53] Lei C, Deng J, Cao K, et al. A comparison of random forest and support vector machine approaches to predict coal spontaneous combustion in gob[J]. Fuel, 2019: 297-311.
[54] Anoop K P, Panicker V V, Narayanan M, et al. A mathematical model and solution methods for rail freight transportation planning in an Indian food grain supply chain[J]. Sadhana-academy Proceedings in Engineering Sciences, 2018, 43(12).
[55] Dorosiewicz S, Waśkiewicz J. Forecast for the development of the international freight transport market in Poland until 2030[J]. Logistics and Transport, 2018, 40(4): 103-110.
[56] 陈诚.基于城市群的铁路白货物流需求集聚方法研究[J].铁道运输与经济,2019,41(09):29-34.. [57] 冯芬玲,李杰潞.基于Hoteling模型的公路和铁路货运价格与服务竞争[J].铁道科学与工程学
报,2017,14(02):388-394. [58] 王 翔 , 胡 学 钢 . 高 维 小 样 本 分 类 问 题 中 特 征 选 择 研 究 综 述 [J]. 计 算 机 应
用,2017,37(09):2433-2438+2448. [59] Zhang J, Xiong Y, Min S, et al. A new hybrid filter/wrapper algorithm for feature selection in
classification[J]. Analytica Chimica Acta, 2019: 43-54. [60] Mafarja M, Mirjalili S. Whale optimization approaches for wrapper feature selection[J]. Applied Soft
Computing, 2018: 441-453. [61] Masood M K, Jiang C, Soh Y C, et al. A novel feature selection framework with Hybrid
Feature-Scaled Extreme Learning Machine (HFS-ELM) for indoor occupancy estimation[J]. Energy and Buildings, 2018: 1139-1151. [62] Kong Y, Yu T. A graph-embedded deep feedforward network for disease outcome classification and feature selection using gene expression data[J]. Bioinformatics, 2018, 34(21): 3727-3737. [63] Paul S, Drineas P. Feature selection for ridge regression with provable guarantees[J]. Neural Computation, 2016, 28(4): 716-742. [64] Hastie T, Tibshirani R, Tibshirani R J, et al. Extended Comparisons of Best Subset Selection, Forward Stepwise Selection, and the Lasso[J]. Methodology, 2017. [65] Lu M. Embedded Feature Selection Accounting for Unknown Data Heterogeneity[J]. Expert Systems With Applications, 2019: 350-361.
56

参考文献
[66] Ma L, Fan S. CURE-SMOTE algorithm and hybrid algorithm for feature selection and parameter optimization based on random forests[J]. BMC Bioinformatics, 2017, 18(1): 169-169.
[67] Deviaene M, Testelmans D, Borzee P, et al. Feature Selection Algorithm based on Random Forest applied to Sleep Apnea Detection[C]. international conference of the ieee engineering in medicine and biology society, 2019: 2580-2583.
[68] Yang Y, Chen D, Wang H, et al. Incremental Perspective for Feature Selection Based on Fuzzy Rough Sets[J]. IEEE Transactions on Fuzzy Systems, 2018, 26(3): 1257-1273.
[69] Wang P, Zhang X, Han B, et al. Prediction model for railway freight volume with GCA-genetic algorithm-generalized neural network: empirical analysis of China[J]. Cluster Computing, 2019, 22(2): 4239-4248.
[70] Suykens J A, Vandewalle J. Least Squares Support Vector Machine Classifiers[J]. Neural Processing Letters, 1999, 9(3): 293-300.
[71] Svetnik V, Liaw A, Tong C, et al. Random Forest: A Classification and Regression Tool for Compound Classification and QSAR Modeling[J]. Journal of Chemical Information and Computer Sciences, 2003, 43(6): 1947-1958.
[72] Cheng J, Liu Q, Lu H, et al. Ensemble learning for independent component analysis[J]. Pattern Recognition, 2006, 39(1): 81-88.
[73] Mirjalili S, Mirjalili S M, Lewis A, et al. Grey Wolf Optimizer[J]. Advances in Engineering Software, 2014: 46-61.
[74] Golafshani E M, Behnood A, Arashpour M, et al. Predicting the compressive strength of normal and High-Performance Concretes using ANN and ANFIS hybridized with Grey Wolf Optimizer[J]. Construction and Building Materials, 2020.
[75] Tavasszy L A. Predicting the effects of logistics innovations on freight systems: Directions for research[J]. Transport Policy, 2019.
[76] Kennedy J, Eberhart R C. Particle swarm optimization[C]. international conference on networks, 2002: 1942-1948.
[77] Falamarzi A, Moridpour S, Nazem M, et al. Development of Random Forests Regression Model to Predict Track Degradation Index: Melbourne Case Study[C]. transport research forum, 2018: 1-12.
57

个人简历 在读期间发表的学术论文
个人简历 在读期间发表的学术论文
个人简历 徐唯祎, 女, 江西九江人。 2015 年 7 月毕业于郑州航空工业管理学院，会计学专业。 2017 年 9 月进入华东交通大学攻读物流工程专业硕士研究生。 学术论文 [1] Yean Zhu, Weiyi Xu, Haolun Wang .et al. Enhanced Random Forest using Improved Artificial Fish
Swarm Algorithm for the Medial Knee Contact Force Prediction [J]. Artificial intelligence in medicine (2020).doi: 10.1016/j.artmed.2019.101811. [2] 朱 业 安 , 徐 唯 祎 , 王 睿 , 等 . 偏 瘫 步 态 障 碍 的 自 动 识 别 和 分 析 [J]. 生 物 医 学 工 程 学 杂 志,2019,36(02):306-314. 参与项目 [1] 江西省重点研发计划项目(S2019ZPYFB1734)：基于骨骼关键点检测的老年人跌倒风险预测。
58

致谢
致谢
攻读硕士学位的研究生生涯即将进入尾声，在学生生涯结束之前，我由衷的想感谢 这三年来每一个给予我帮助和支持的人。
首先感谢我的导师周湘峰教授，感谢老师对于我自主选择的研究方向给予支持，并 悉心指导我的研究思路和研究方法。尽管工作任务繁忙，周老师仍抽空督促我的研究进 展，给我的论文提供了诸多宝贵的意见。本论文的完成离不开在周老师的严格要求和全 心辅导。
其次，感谢我的男友朱业安，不仅在生活中给予我陪伴和鼓励，也是我学习上的良 师益友。读研以来，他严谨认真的科研态度，以及高效率的工作习惯，深深影响了我， 并将使我终生受益。
另外，感谢彭志勇、涂梦婕和余愿同学。在收集资料的过程中，他们不遗余力地为 我提供帮助。
最后，感谢辛勤抚育我的父母。是你们无私无悔的付出，才让我能心无旁骛地求学。 你们是我最坚实的后盾，是我人生旅途中永远的港湾。
59

