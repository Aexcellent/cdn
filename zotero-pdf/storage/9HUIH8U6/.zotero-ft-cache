硕士学位论文
基于相空间重构的铁路货运需求预测技术研究 Research on Railway Freight Demand Forecasting Technology
Based on Phase Space Reconstruction
作者：徐菲 导师：任爽
北京交通大学 2021 年 6 月

学位论文版权使用授权书
本学位论文作者完全了解北京交通大学有关保留、使用学位论文的规定。特 授权北京交通大学可以将学位论文的全部或部分内容编入有关数据库进行检索， 提供阅览服务，并采用影印、缩印或扫描等复制手段保存、汇编以供查阅和借阅。 同意学校向国家有关部门或机构送交论文的复印件和磁盘。学校可以为存在馆际 合作关系的兄弟高校用户提供文献传递服务和交换服务。
（保密的学位论文在解密后适用本授权说明）

学位论文作者签名： 签字日期： 年 月 日

导师签名： 签字日期： 年 月 日

学校代码：10004

密级：公开

北京交通大学
硕士学位论文

基于相空间重构的铁路货运需求预测技术研究
Research on Railway Freight Demand Forecasting Technology Based on Phase Space Reconstruction

作者姓名：徐菲 导师姓名：任爽 学位类别：工学 学科专业：计算机科学与技术

学 号：18120430 职 称：副教授 学位级别：硕士 研究方向：大数据与预测技术

北京交通大学 2021 年 6 月
i

致谢
行文至此，我的学生生涯也即将结束了，依然记得 2018 年夏天踏入校园的那 份激动之情，目之所及，皆是回忆，纵有千般不舍，但仍心存感激。
感谢我的导师任爽老师，有幸参与了导师的项目，拓宽了自己的眼界，也感 受到了老师身上细心严谨的工作作风，终身受用。从论文选题到最后的定稿对我 一路悉心指导，同时感谢老师在这过程中的鞭策。在学习生活中，老师时常告诫 我们要将自律养成习惯，主动学习，遇到压力时要积极面对，给予了我们很大的 帮助，再次感谢我的导师，愿您身体健康，工作顺利，家庭幸福。
感谢实验室各位小伙伴的帮助，特别要感谢继续深造读博的韩冰师姐和已经 毕业的刘笑佟师姐、周虹霖、钟丽君、闫玉波等人在科研以及平日生活中对我的 帮助和鼓励，这是一个温暖的大家庭，遇到困难伸以援手，这份友谊弥足珍贵。
感谢一路陪伴我的家人，为我遮风挡雨，包容我的任性和小脾气，成为了我 求学路上最坚强的后盾，虽然不是超人，却为我变成了万能。
感谢我的室友，许喆铭、薛洁婷和荆慧，感谢你们在我心情低落时的陪伴， 找工作受挫时的鼓励，愿我们一直是爱笑的女孩子，少点烦恼和忧愁，眼里有光， 始终满怀希望。
感谢实习期间认识的李学敏同学，记得敏敏给我带了快两个月的早餐，也记 得每天收到下午茶时的快乐，每次桌子上都能攒一大堆零食，感谢敏敏在我实习 期间对我的照顾，在我找工作时给予的帮助，在写论文时对我的关心问候，希望 敏敏工作顺利，所有的努力都有回报。
感谢我的十年好友周沐梓，感谢你一直在我身边，在我需要帮助想要哭诉时 总能坚定地站在身后支持我，希望疫情快快结束，让你在国外的工作和生活早日 恢复正常，也希望你所有的计划都可以早早实现，离我们见面的日子应该不远了。
最后，感谢参与本次评审和答辩的各位老师，谢谢您们的指导与建议。
ii

北京交通大学硕士学位论文

摘要

摘要
铁路货运是我国运输行业的一项重要组成部分。近年来，随着国际经济形势 的不断变化以及我国相关政策的出台，铁路货运市场得到了迅速发展。铁路相关 管理部门需要及时了解货物运输情况，掌握货运市场的发展动态，提前做好路线 规划以及合理分配运力资源。因此，准确地预测货运需求有利于铁路部门规划未 来发展，研究出科学有效的铁路货运需求预测方法就显得尤为重要，对铁路部门 工作有一定的指导参考意义。
目前国内外学者对于铁路货运预测技术的研究比较全面，总体上可以分为两 类，一类是不考虑影响因素，通过分析历史货运数据进行预测，另一类是通过分 析待预测序列与相关影响因素之间的关系进行预测。本文针对这两类预测方法各 自存在的问题开展研究，主要工作内容如下：
（1）提出了基于单元相空间重构的货运需求预测模型。根据历史数据走向预 测未来发展规律的方法存在一定的主观性，并且在面对波动较大的货运序列时， 预测精度有限。因此，引入混沌理论将单元时间序列重构到多维相空间，改进了 求解重构参数的 C-C 法，确定输入结构并利用非线性模型预测。同时考虑到利用 单一的预测模型有一定的局限性，引入分解集成思想减小预测误差，将原始的货 运序列分解得到低频和高频分量，利用线性模型预测低频分量，利用非线性模型 预测高频分量，最后将各分解分量的预测结果相集成。
（2）提出了基于多元相空间重构的货运需求预测模型。通过分析影响因素预 测货运需求的方法，通常是选用常用的模型对多变量建模以逼近原货运系统，但 这并不能充分挖掘货运系统的真实性质，影响预测精度。因此，在货运预测领域 中引入混沌理论发掘系统内部规律，并结合非线性模型拟合货运系统演变的动态 规律，提高预测精度。首先分析总结了货运需求的影响因素，选取关键的因素建 立指标体系，其次求解待预测序列与影响因素序列的重构参数，判断各序列的混 沌特性以及构建多元相空间，最后将多元相空间矩阵与神经网络相结合进行预测， 为现有的货运预测方法提供了一种新的思路。
本文在货运集装箱数据集上验证了两种预测模型的有效性，并与其他预测方 法进行了对比，实验证明提出的两种预测方法具有更高的准确度。 关键词：货运需求预测；相空间重构；混沌特性；神经网络

iii

北京交通大学硕士学位论文

ABSTRACT

ABSTRACT
Railway freight is an important part of my country's transportation industry. In recent years, with the continuous changes in the international economic situation and the introduction of relevant policies in my country, the railway freight market has developed rapidly. The relevant railway management departments need to keep abreast of the freight transportation situation, grasp the development trends of the freight market, make route planning in advance, and reasonably allocate transportation resources. Therefore, accurate forecasting of freight demand is conducive to the planning of future development of the railway sector, and it is particularly important to develop a scientific and effective railway freight demand forecasting method, which has certain guiding and reference significance for the work of the railway sector.
At present, domestic and foreign scholars have relatively comprehensive research on railway freight forecasting technology. Generally speaking, they can be divided into two categories. One is to make predictions by analyzing historical freight data without considering influencing factors, and the other is to predict by analyzing the relationship between the sequence to be predicted and related influencing factors. This paper conducts research on the problems of these two types of forecasting methods. The main contents of the work are as follows:
(1) A freight demand forecast model based on unit phase space reconstruction is proposed. The method of predicting the law of future development based on historical data is subjective, and the prediction accuracy is limited in the face of fluctuating freight series. Therefore, chaos theory is introduced to reconstruct the unit time series into a multi-dimensional phase space, and the C-C method for solving reconstruction parameters is improved, the input structure is determined and the nonlinear model is used for prediction. At the same time, considering the limitations of using a single prediction model, the idea of decomposition and integration is introduced to reduce the prediction error, and the original freight sequence is decomposed to obtain low-frequency and high-frequency components. The linear model is used to predict the low-frequency components, and the nonlinear model is used to predict the high-frequency components. Finally, the prediction results of each decomposition component are integrated.
(2) A freight demand forecasting model based on multi-phase space reconstruction is proposed. The method of forecasting freight demand by analyzing influencing factors

iv

北京交通大学硕士学位论文

ABSTRACT

is usually to use common models to model multi-variables to approximate the original freight system, but this does not fully excavate the true nature of the freight system and affects the prediction accuracy. First, it analyzes and summarizes the influencing factors of freight demand, and selects key factors to establish an index system. Secondly, the reconstruction parameters of the sequence to be predicted and the influencing factor sequence are solved, the chaotic characteristics of each sequence are judged, and the multivariate phase space is constructed. Finally, the combination of the multivariate phase space matrix and the neural network is used to predict, which provides a new idea for the existing freight forecasting methods.
This paper verifies the effectiveness of the two forecasting models on the freight container data set and compares them with other forecasting methods. The experiment proves that the two forecasting methods proposed have higher accuracy. KEYWORDS ： Freight demand forecast; Phase space reconstruction; Chaotic characteristics; Neural network

v

北京交通大学硕士学位论文

目录

目录
摘要 ......................................................................................................................... iii ABSTRACT............................................................................................................. iv 1 引言 .................................................................................................................... 1
1.1 研究背景 ...................................................................................................... 1 1.2 研究意义 ...................................................................................................... 2 1.3 研究现状 ...................................................................................................... 2
1.3.1 货运需求预测技术 .............................................................................. 2 1.3.2 混沌时间序列预测技术 ...................................................................... 5 1.4 本文研究内容 .............................................................................................. 6 1.5 论文组织结构 .............................................................................................. 7 2 相关背景知识 .................................................................................................... 9 2.1 相空间重构理论 .......................................................................................... 9 2.1.1 相空间重构意义 .................................................................................. 9 2.1.2 重构参数确定方法 ............................................................................ 10 2.1.3 混沌特性识别 .................................................................................... 10 2.2 传统 C-C 法................................................................................................ 11 2.3 变分模态分解 ............................................................................................ 12 2.4 支持向量回归机 ........................................................................................ 13 2.5 差分自回归滑动平均模型 ........................................................................ 15 2.6 预测结果评价标准 .................................................................................... 16 2.7 本章小结 .................................................................................................... 17 3 基于单元相空间重构的货运需求预测模型 .................................................. 18 3.1 模型框架 .................................................................................................... 18 3.2 算法设计 .................................................................................................... 19 3.3 实证分析 .................................................................................................... 23 3.3.1 实验数据及环境 ................................................................................ 24 3.3.2 VMD 算法分解 .................................................................................. 24 3.3.3 ARIMA 模型预测 .............................................................................. 25 3.3.4 SVR 模型预测.................................................................................... 30
vi

北京交通大学硕士学位论文

目录

3.3.5 预测结果及分析 ................................................................................ 33 3.4 本章小结 .................................................................................................... 35 4 基于多元相空间重构的货运需求预测模型 .................................................. 36 4.1 模型框架 .................................................................................................... 36 4.2 构建货运需求指标体系 ............................................................................ 37
4.2.1 影响因素定性分析 ............................................................................ 37 4.2.2 影响因素定量分析 ............................................................................ 39 4.3 算法设计 .................................................................................................... 41 4.4 预测实验及结果分析 ................................................................................ 48 4.4.1 实验数据 ............................................................................................ 48 4.4.2 构建多元相空间 ................................................................................ 50 4.4.3 预测结果及分析 ................................................................................ 52 4.5 本章小结 .................................................................................................... 58 5 总结与展望 ...................................................................................................... 59 5.1 总结 ............................................................................................................ 59 5.2 展望 ............................................................................................................ 60 参考文献 ................................................................................................................ 61 作者简历及攻读硕士学位期间取得的研究成果 ................................................ 65 独创性声明 ............................................................................................................ 66 学位论文数据集 .................................................................................................... 67

vii

北京交通大学硕士学位论文

引言

1 引言
铁路运输在我国运输行业中起到了强有力的支撑作用，我国铁路网建设日趋 完善，铁路运输也因其运输稳定安全，价格低廉等优点，成为了国家之间和国内 各区域之间货物运输方式的首选，铁路货运在不断发展的同时也影响着社会生产 过程。随着我国经济结构的不断调整，货物运输结构和市场环境也发生着变化。 与此同时，国民生活水平不断提高，导致货运需求激增，铁路运输的相关企业及 管理部门要想提高自身在物流市场的竞争力，就需要及时掌握货运市场的发展动 态，制定合理的规划方案。准确地预测货运需求可以为铁路部门及相关企业在之 后的管理工作中提供参考，促进铁路货运健康稳定地发展。
1.1 研究背景
铁路是国家重要的基础设施、国民经济的大动脉和经济发展的基础，铁路运 输因其安全性高、速度快、货运量大、成本低等优势，成为了我国综合交通运输 体系中的骨干，在推动我国经济社会又好又快发展的过程中发挥着重要作用。我 国的铁路运输网络纵横分布，铁路货物运输占据了我国运输行业很大一部分，对 于社会经济发展起到了强有力的支撑作用[1]。随着水运、公路、航空等运输方式的 发展，货运市场内部的激烈竞争使得铁路货运面临着巨大的挑战[2]。
2012 年，大宗货物运量下降，导致我国铁路货运量接连下滑。2013 年，我国 提出了“一带一路”的倡议，我国与周边的国家交流合作的机会越来越多，这对 于我国的经济发展是一个很好的趋势，尤其是促进了国内外货运市场的流通和货 运需求的增加。建设“一带一路”增加了各区域之间的流动，调动了人与货之间 的流动性，“一带一路”成为了我国发展战略的创新之举[3]。2015 年，我国开始对 过剩行业进行调整，影响了煤炭、钢铁等大宗货物的产能，导致铁路货运量下降。 2018 年，会议提出了对运输结构进行调整，即减少公路货运量，增加铁路货运量。 在“公转铁”政策的引导下，铁路获得了巨大的货物需求，同时相关部门也加快 了铁路基础设施的建设速度[4]。我国一直在大力推动“公转铁”政策的落实，铁路 货运市场迎来了快速发展的势头。2019 年，为完成铁路部门提出的《三年货运增 量行动方案》，铁路货运量创下历史极值。2020 年，虽然受到新冠肺炎疫情的影响， 没有完成增量目标，但是铁路货运量仍有所增长。
面对不断增长的铁路货运量，铁路部门的压力也随之而来。目前铁路货运面 临着经济布局的优化和经济结构的调整，货运需求越来越复杂，铁路存在运能不
1

北京交通大学硕士学位论文

引言

足的问题，并且铁路货物运输的时间较长，在运输途中也有一定的时间损失，影 响铁路部门提供运输服务的能力。铁路部门一是需要加大基础建设，提高物流的 运作效率，提升铁路货运的服务能力；二是需要调整管理模式，加强内部的沟通 和信息交流，使得运力资源得到充分调配。铁路部门及市场经营者如果想要准确 地把控市场环境，利于不败之地，就要及时调整政策战略，提升应对随时发生变 化的市场的能力，即准确预测铁路货运需求和发展趋势。
1.2 研究意义
准确的铁路货运预测对掌握未来铁路货运市场的发展趋势以及提高中国铁路 运输系统的综合竞争力有着重要意义，铁路货运预测的重要意义可以总结为以下 几点：
（1）评价经济效益 铁路管理部门和相关运输企业在制定运输计划或市场营销计划时，货运量预 测作为一项重要的参考依据，利于分析整体计划的运营情况、资金情况、风险情 况等，以及评价项目的经济和社会效益。 （2）控制运营成本 准确的铁路货运预测结果有利于铁路部门充分调配运力资源，规划未来运输 路线，制定相关设施的建设方案，在投资阶段做到合理有效，减少运输过程中的 时间及运营成本，同时也避免了铁路部门在制定决策的过程中出现主观臆断的情 况，使决策更加科学化。 （3）掌握市场发展动态 目前，我国货物运输市场环境比较复杂，竞争激烈。由于政策不断改革以及 市场结构不断变化，影响铁路货物运输的因素也随时发生变化，为铁路相关部门 提供及时准确的货运发展趋势，有利于铁路相关部门快速了解市场变化，制定符 合铁路货运市场现状的政策及管理方案，提高自身的市场竞争力。
1.3 研究现状
1.3.1 货运需求预测技术
在货运预测领域，国内外的学者做了大量的研究，目前货运预测方法大体上 可以分为两类，一类为不考虑货运量的影响因素，根据历史数据即过去的变化趋 势预测未来的发展；另一类为考虑货运量的影响因素，描述相关的影响因素与货
2

北京交通大学硕士学位论文

引言

运量之间的因果关系，从而预测未来货运量的发展。下面将对这两类预测方法的 国内外研究情况进行介绍。
（1）不考虑影响因素 在不考虑影响因素的情况下进行货运量预测，主要方法有时间序列预测法及 灰色预测法。 时间序列预测法指的是利用历史数据的情况计算求出模型的参数，再根据建 立的模型进行预测[5]。汤银英等[6]针对具有趋势和季节变化的月度货运量数据，采 用三次指数平滑法进行预测，同时可以消除一些随机波动所带来的影响。张立欣 等[7]针对铁路货运量的发展趋势，采用 X11 方法将原始数据分离出趋势和季节因 素，并结合差分自回归滑动平均模型（Autoregressive Integrated Moving Average Model，ARIMA）对货运量进行预测分析。胡洁琼等[8]利用专家建模自动获取最佳 模型，从而预测货运量。Rudakov 等[9]利用自回归模型，差分自回归滑动平均模型 和直方图预测模型，进行短期铁路运输量预测。Farhan 等[10]利用季节性差分自回 归滑动平均模型（Seasonal Autoregressive Integrated Moving Average，SARIMA）预 测港口集装箱货运吞吐量，同时考虑了季节的变化。时间序列预测法的优点在于 适用于短期预测，比较简单，容易操作，缺点在于受外界影响比较大，如果外界 出现一定的变化，预测精度有所下降。 灰色预测法指的是在有很多不确定的因素影响下进行预测。徐莉等[11]将传统 的 GM(1,1)灰色预测模型分别进行了一次和二次修正，实验证明可以有效提高预测 精度。贺政纲等[12]利用灰色 Verhulst 模型预测货运量，采用粒子群算法（Partical Swarm Optimization，PSO）优化参数并进行傅里叶误差修正。Yuan 等[13]将马尔科 夫链模型应用到灰色 Verhulst 模型的预测过程中，减少预测误差。褚衍昌等[14]利 用灰色马尔科夫链模型应用在货运量的预测，与 GM(1,1)模型相比，预测精度更优。 崔乃丹等[15]利用小波降噪分析法，消除数据存在的噪声，并在此基础上利用灰色 GM(1,1)模型进行预测。灰色预测法的优点在于需要的数据量比较小，不需要考虑 数据的分布情况，适用于短期预测，缺点在于只适用于呈指数趋势增长的预测， 局限性较大，而且无法描述系统内部复杂性。 （2）考虑影响因素 在考虑影响因素的情况下进行货运量预测，主要方法有机器学习预测方法和 组合预测方法。 关于机器学习预测方法，Guo 等[16]利用指数平滑法预测影响因素，输入到广 义回归神经网络（Generalized Regression Neural Network，GRNN）进行货运量预 测，并采用遗传算法优化参数。耿立艳等[17]利用灰色关联法分析铁路货运量影响 因素，输入到最小二乘支持向量机预测模型，并采用随机权重粒子群算法优化参
3

北京交通大学硕士学位论文

引言

数。Qiu 等[18]利用长短时记忆网络（Long Short Term Memory Network，LSTM）进 行货运量预测，并采用粒子群算法优化参数。Gao 等[19]利用随机森林回归法进行 预测，实验表明随机森林回归法的预测结果优于反向传播（Back Propagation，BP） 神经网络模型及多元线性回归法，同时抗干扰能力较强。侯维磊等[20]针对复杂的 货运量影响因素，首先进行了灰色关联分析和主成分分析，其次利用 BP 模型进行 预测，并采用遗传算法优化参数，在提高预测精度的同时也加快了运行速度。Sun 等[21]利用 17 个铁路货运量影响因素作为 GRNN 模型的输入，并采用粒子群优化 算法搜索参数，实验证明了模型的有效性。Liu 等[22]利用支持向量回归机（Support Vector Regression，SVR）预测铁路货运量。Moscoso-López 等[23]首先对货运量数 据进行了指数平滑的预处理，利用 SVR 模型对港口的货运量数据进行了中短期预 测。宋苏民等[24]利用径向基神经网络预测铁路货运量，相比 BP 模型和灰色预测模 型预测误差更小。机器学习预测方法的优点在于具有很强的学习能力，可以映射 比较复杂的非线性关系，缺点在于收敛速度慢，容易陷入局部极小值。
组合模型预测方法指的是利用两种及以上的模型进行预测。徐玉萍等[25]将 SARIMA 与 LSTM 模型相结合，并引入了注意力机制，与单一的预测模型相比， 预测精度更高。Feng 等[26]利用 SARIMA 模型发掘货运量的发展规律，利用深度置 信网络揭示货运量与影响因素之间的关系，最后将两种模型的预测结果集成，提 高预测准确性。Uvarov 等[27]利用 ARIMA、LSTM 等模型进行叠加以预测短期铁路 货物运输量。Li 等[28]分析货运量影响因素之后，将支持向量机和 NARX 神经网络 进行线性组合，结果表明组合预测模型方法优于任何单一模型，预测结果较好。 Du 等[29]将灰色 GM(1,1)和 BP 网络相结合，预测中国最近 20 年的货运量。组合模 型预测方法的优点在于可以综合利用各种预测方法提供的有效信息，有效地提高 预测精度，缺点在于每个预测方法也存在自身的不足之处，而且实现起来相对复 杂。
对于货运预测，除了以上提到的主要预测方法，还有一些其他的预测方法。 方文清等[30]引入分形理论，利用变形的分形分布模型进行预测，避免因对影响因 素估计不准确而影响预测结果。分形理论预测方法的优点在于实验数据简单，不 存在收敛问题，可以有效排除干扰项，缺点在于预测结果存在时间滞后。Xiao 等[31] 在货运预测方面引入了模糊回归模型，并证明了具备一定的实际操作意义。张诚 等[32]应用粗糙集理论进行数据离散化，通过属性约简得到关键指标并计算指标的 权重。粗糙集理论预测方法的优点在于可以避免主观因素的影响，能够分析不完 备信息，缺点在于原始数据一旦离散化，就会影响预测精度，运算过程比较复杂。
当前的货运预测研究中，预测技术相对比较完善，但是这两类预测方法仍存 在不足之处，对于第一类预测方法，传统的预测模型会存在一定的主观性，货运
4

北京交通大学硕士学位论文

引言

需求受各种不确定因素的影响，导致其波动性较大，模型的预测精度有限；对于 第二类预测方法，面对十分复杂的货运系统，系统内在的一些隐含信息往往不能 被完整地揭示出来，即传统的预测方法难以获取系统内部的发展规律。因此对于 这两类预测方法，还需要进一步的研究。
1.3.2 混沌时间序列预测技术
非线性科学是一门交叉科学，主要研究非线性现象的共性问题，其中混沌理 论是一大主体[33]。混沌理论揭示的是复杂系统中看似随机，毫无规律性，不可预 测的现象背后实际存在着一定的规律。混沌理论主要有以下几个独有的特征：
（1）初始条件敏感性 初始条件存在一些微小的差距，经过一段时间，混沌行为会在未来的演化轨 迹等方面形成巨大的差别。 （2）内部随机性 一般情况下，一个确定性系统在没有外界干扰下，输出也一定是确定的，但 是对于混沌的确定性系统来说，即使没有外界干扰，输出也会是随机的，因此这 种随机的特征实际是从系统内部产生的。 （3）整体稳定局部不稳定 整体稳定指的是系统在受到微小的扰动之后依然能保持原有的运动状态，而 局部不稳定指的是混沌系统对于初始条件的敏感性。 （4）普适性 普适性指的是在混沌状态下，不同系统会表现出某些共同的特性。普适性体 现了混沌系统中存在的内在规律。 混沌时间序列预测是混沌理论的一个重要方向和研究热点。目前，混沌理论 的研究应用领域非常广泛，包括经济、交通、电力等，并在各自的应用领域中取 得了比较好的效果。下面将介绍混沌时间序列预测法在各个领域的研究情况。 在交通领域中，廖荣华等[34]面对复杂的交通系统，采用混沌时间序列的局域 预测法进行交通流预测，并改进了邻近点的选取方式。Li 等[35]选取三种交通流的 影响因素进行重构，利用贝叶斯估计理论获得相空间中的最佳融合相点，并结合 径向基神经网络进行预测。Zhang 等[36]分析空中交通流的混沌特性，利用相空间重 构映射到高维空间，并利用极限学习机进行预测。王硕等[37]将混沌理论与 BP 预测 模型相结合，并利用思维进化算法对 BP 模型进行优化。 在电力领域中，陈伟等[38]提出将相空间重构分别与径向基神经网络和最小二 乘支持向量机相结合，对风电功率进行预测，并利用协方差将两种模型的预测结
5

北京交通大学硕士学位论文

引言

果组合，提高了预测精度。Tian[39]证明了短期风速序列的混沌性，改进回声状态网 络，抑制输入噪声对预测性能的影响。Li 等[40]利用主成分分析减少重构参数选择 不当的影响，并结合资源分配网络对风电数据进行预测。Xue 等[41]首先利用集成 经验模态分解法，减少混沌吸引子的时延效应及各相空间功率序列波动对预测精 度的影响，最后将优化后的相空间与 BP 预测相结合，提高了预测方法的准确性。
在经济领域中，Fan 等[42]从混沌的角度研究煤炭价格，并提出了利用多层感知 器模型来预测煤价。Sun 等[43]利用最小二乘支持向量机对具有混沌性的石油价格进 行预测，并利用遗传算法选取最优相空间重构和最小二乘支持向量机的参数。Yu 等[44]将相空间重构与长短时记忆神经网络相结合，预测金融产品的价格。Shi 等[45] 在预测碳市场价格时，提出利用 PSO 算法同时优化最小二乘支持向量回归模型和 相空间重构的参数，模型预测能力有所提升。
由此可见，针对内部因素复杂并且相互作用的系统，混沌时间序列预测技术 为其提供了一种新的研究途径，而融合了多因素的铁路货运系统，缺少这一方面 的研究，可以考虑在货运预测领域引入混沌理论，充分挖掘货运系统内部的演化 规律，提取更多有效信息，从而提高预测精度。
1.4 本文研究内容
铁路货运的发展随着市场环境的变化具有不确定性，而铁路货运的发展趋势 以及货运需求直接影响国家铁路部门的决策部署，因此铁路相关部门需要做好铁 路货运需求预测，在货运结构不断调整的背景下，能及时安排运力资源，提高服 务效率。本文的主要研究内容如图 1-1 所示，在对货运预测方法和混沌时间序列预 测方法充分调研的基础上，针对现有货运预测技术存在的问题，根据不同的研究 对象分别提出了新的预测思路并且构建了相应的货运需求预测模型。具体研究内 容如下：
（1）针对第一类不考虑影响因素的预测技术，为了避免因预测过程的主观性 及数据波动大导致预测精度不高的情况，提出了基于单元相空间重构的铁路货运 需求预测模型。单元时间序列具有不稳定、非线性等特点，利用非线性模型进行 拟合效果较好，引入相空间重构避免盲目选择输入集，同时考虑直接建立模型预 测效果一般，利用分解集成的思想可以有效地减小误差。首先利用变分模态分解 算法对原始单元时间序列进行分解，根据中心频率确定模态的分解个数，将分解 后得到的模态分为高频模态和低频模态。其次针对各类模态的特征采用不同的预 测方法进行预测，低频模态选择 ARIMA 模型预测，高频模态选择 SVR 模型预测。 在对高频模态预测的过程中，引入混沌理论，进行相空间重构处理，并在重构参
6

北京交通大学硕士学位论文

引言

数的确定方法上进行了改进。最后将多种模态的预测结果相加。 （2）针对第二类考虑影响因素的预测技术，考虑到货运系统中存在的一些有
序信息对预测结果有一定的影响，提出了基于多元相空间重构的铁路货运需求预 测模型，将原货运系统的特征恢复出来，挖掘系统内部信息。首先，本文从宏观 经济、物流市场以及工业发展三个方面对货运需求的影响因素进行分析，并从国 家统计局整理影响因素数据，利用灰色关联分析对各影响因素的关联度排序，选 出关联度靠前的影响因素。其次，对待预测序列与影响因素序列分别利用 C-C 法 求解重构参数，根据重构参数判断各货运序列是否具有混沌特征，将具备混沌特 征的货运序列构建为多元相空间。最后，利用混沌相空间确定模型的输入和输出 集，结合几种神经网络构建货运预测模型。
（3）利用集装箱装箱数数据进行实证分析，从实际应用场景出发，将原始数 据按时间维度整合为周度和月度数据，分别应用在本文提出的两种预测模型当中， 并与其他预测方法进行了对比，实验证明本文提出的两种预测模型拟合程度较好， 在预测精度上均有一定程度的提高。

图 1-1 本文研究内容框架图 Figure 1-1 Framework diagram of the research content of this thesis
1.5 论文组织结构
第一部分引言。本章首先详细介绍了铁路货运预测的研究背景和研究意义， 其次总结了目前货运需求预测技术及存在的问题，并且介绍了混沌时间序列预测 技术，最后引出本文的主要研究内容。
第二部分相关背景知识。本章首先介绍了相空间重构理论，其次介绍了本文 所用到的信号分解算法以及涉及的预测方法，最后介绍了本文用到的预测结果评 价指标。
7

北京交通大学硕士学位论文

引言

第三部分基于单元相空间重构的货运需求预测模型。本章首先介绍了该模型 的框架以及详细的算法设计流程，其次利用实验数据进行实证分析，最后与不同 的预测模型进行了比较，分析了该模型的预测拟合效果。
第四部分基于多元相空间重构的货运需求预测模型。本章首先介绍了该模型 的框架以及详细的算法设计流程，分析了货运需求影响因素以建立指标体系，其 次利用实验数据构建货运多元相空间，并与不同的神经网络相结合进行预测实验， 最后与其他预测模型的预测结果进行了对比分析。
第五部分总结与展望。本章是对本文研究内容的总结及对后续工作的展望。

8

北京交通大学硕士学位论文

相关背景知识

2 相关背景知识
本章首先对混沌时间序列预测中的相空间重构理论进行了详细地阐述，其次 介绍了本文提出的预测模型所涉及的相关技术及算法，最后介绍了本文所用到的 预测结果评价标准，以衡量模型的预测效果。

2.1 相空间重构理论
相空间重构是对混沌时间序列进行预测的基础，本节主要介绍相空间重构理 论的相关知识，为后续的货运预测实验提供理论基础。

2.1.1 相空间重构意义

混沌系统内部错综复杂，系统信息隐含在各混沌时间序列中，在实现预测的

过程中，如果能获取到这部分有用的信息，将会使模型的预测精度有所提高，相

空间重构的意义就在于从原混沌序列中恢复并提取原混沌系统中的信息。

相空间重构理论是研究如何在高维相空间中恢复混沌吸引子[46]。混沌系统演

化后会落在特定轨道，这个特定的轨道就是混沌吸引子。混沌吸引子具有两种运

动模式，一种是外部的，即混沌吸引子以外的运动都趋向于吸引子，看似无规律

的运动实则都在按照某种秩序在进行；另一种是内部的，即吸引子内部总是会出

现不稳定的运动。因此混沌系统的状态是有序和无序共存的，要想研究混沌系统

的运动轨迹，就需要明确混沌吸引子的变化状态。相空间重构理论指出任意一个

分量的演化会受到与其相关的分量的影响，任意一个分量也包含着与其相关的分

量的信息。荷兰数学家 Takens 证明了如果能够找到一个合理的嵌入维数，就可以 在嵌入维空间中恢复出来最后的特定轨道，即得到混沌吸引子。

对于时间序列{x1, x2 , , xN }，相空间重构后表达式如下：

X1 =  x1, x1+ , x1+2 , , x1+(m−1) 

X 2 =  x2 , x2+ , x2+2 , , x2+(m−1) 

（2-1）

X M =  xM , xM + , xM +2 , , xM +(m−1) 
其中，m 为嵌入维数， 为延迟时间，M = N − (m −1) 。在相空间重构过程中，m 和 影响着重构后的相空间质量，一定程度上影响着预测精度，因此需要选取恰当

9

北京交通大学硕士学位论文

相关背景知识

的延迟时间 和嵌入维数 m 。
2.1.2 重构参数确定方法
重构参数中的延迟时间和嵌入维数需要根据具体问题选择恰当的参数，参数 过大或者过小都会有影响。延迟时间选择过大，经相空间重构后的变量会压缩过 多的信息量，导致变量之间出现相互独立，不存在关联性的情况；延迟时间选择 过小，经相空间重构后的变量会非常接近，导致出现变量之间无法区分，相空间 信息无法充分展示的情况。延迟时间可以由多种方法确定，例如自相关函数法、 平均位移法和互信息法等。自相关函数是一种简单有效的方法，但这种方法只能 提取时间序列中的线性相关性，也就是无法推广应用到高维的研究中。Rosenstein 等[47]基于几何法提出了平均位移法。平均位移法中延迟时间的确定是通过判断相 空间轨道从主对角线的打开程度，但这种方法在总体变化过程中会发生抖动，即 存在随机性。Fraser 等[48]提出了利用互信息来计算延迟时间。互信息法需要计算联 合分布概率，计算比较复杂。
嵌入维数选择过小，吸引子会自相交，不能完全打开；嵌入维数选择过大， 虽然吸引子会完全打开，但会引入一定的噪声并且增加了计算负担，因此需要选 择合适的嵌入维数。嵌入维数可以由多种方法确定，例如几何不变量法、虚假最 近邻法和 Cao 方法等。几何不变量法是通过计算几何不变量，当其不再发生变化 时得到的嵌入维数即为所求。虚假最近邻法是指嵌入维数在增加时，虚假邻点不 断被剔除，直至虚假邻点的比例在某一范围内，此时的嵌入维数即为所求[49]。Cao 方法是对虚假最近邻法的改进，优点在于适用小数据量，需要的参数少，解决了 噪声的影响。
2.1.3 混沌特性识别
利用混沌时间序列预测技术进行预测之前需要判别时间序列是否存在混沌特 性，但是目前对于混沌的定义在混沌理论中并没有一个明确的描述，因此只能从 其他方面识别时间序列的混沌性。识别混沌特性的方法主要有两类，分别是定量 法和定性法[50]。定性法包括相图法、功率谱法、主成分分析法等，主要是分析时 间序列在时域或者频域表现出来的特殊性质，优点是操作简单，结果比较直观， 缺点是主观判断存在不确定性。定量法包括关联维数、Kolmogorov 熵、最大 Lyapunov 指数等，主要是通过计算一些特征指标来确定序列是否具备混沌特性。
（1）相图法
10

北京交通大学硕士学位论文

相关背景知识

根据时间序列重构过程中的演化轨迹来判断时间序列是否混沌，如果轨迹是 一条封闭的曲线，即识别为混沌；如果轨迹在一定范围内一直做无规律的运动， 同时轨迹互不相交，则识别为非混沌。
（2）功率谱法 根据功率谱图的形态来判断时间序列是否混沌，如果功率谱具备宽峰特征并 且是连续的，则识别为混沌；如果功率谱只是一条连续的曲线，则该时间序列为 白噪声。 （3）主成分分析法 利用主成分分析后得到的主成分谱图进行判断时间序列是否混沌，如果是一 条过定点且斜率为正的直线，则识别为混沌。 （4）关联维数 关联维数描述的是混沌系统内部吸引子的复杂度，计算得到时间序列混沌吸 引子的关联维数，如果关联维数随着嵌入维数增加而增加，并且关联维数会收敛 于某一个值，则判断该时间序列存在混沌特性；如果关联维数增加到一定程度并 不收敛，则判断该时间序列不存在混沌特性。 （5）Kolmogorov 熵 Kolmogorov 熵描述的是系统随时间演化信息产生的频率，以此来判断系统的 运动情况，若 Kolmogorov 熵为 0，则该时间序列不存在混沌性，来自确定性系统； 若 Kolmogorov 熵趋近无穷，则系统具有随机性；若 Kolmogorov 熵为正数，则该 系统为混沌系统，时间序列存在混沌特性。 （6）最大 Lyapunov 指数 Lyapunov 指数描述的是时间序列重构过程中演化轨迹的扩散情况，以此来判 断时间序列是否存在混沌特性[51]。目前常以最大 Lyapunov 指数作为判断依据，如 果最大 Lyapunov 指数为正数，则说明该时间序列存在混沌特性；如果最大 Lyapunov 指数为负数，则说明该时间序列存在混沌特性。计算最大 Lyapunov 指数最常用的 两种方法，Wolf 法和小数据量法。
2.2 传统 C-C 法
延迟时间和嵌入维数的选取方法有很多种，主要可以总结为两类，一类是将 这两个参数视为不相关，即先计算求出延迟时间，再求出嵌入维数；另一类则是 将这两个参数视为有关联的。C-C 法的原理是固定延迟时间窗口，利用关联积分得 到延迟时间和嵌入维数[52]。C-C 法在实际应用中效果较好，而且抗噪能力较强， 适用于小数据量计算。C-C 法中关联积分定义如式（2-2）。
11

北京交通大学硕士学位论文

相关背景知识

 C(m,

N , r, t)

=

2 M (M

−1) 1i jM

 (r

−

dij )

（2-2）

其中， r 为半径， 为单位阶跃函数，关联积分描述的是任意两个相空间点距离小
于 r 的概率。将一组时间序列xi ， i = 1, 2, , N ，分为 t 个不重叠的序列，每个序
列长度 L = N t ，如式（2-3）所示。

  x1, xt+1, x2t+1,   x2 , xt+2 , x2t+2 ,

（2-3）

xt , x2t , x3t , 

每个子序列的统计量 S(m, N, r,t) 定义如式（2-4）。令 N →  ，则 S(m, r,t) 定义 如式（2-5）。

 S (m,

N,

r,t)

=

1 t

t s =1

Cs

(m,

N t

,

r,

t)

−

Csm

(1,

N t

,

r , t ) 

 S

(m,

r,

t

)

=

1 t

t s =1

Cs

(m,

r,

t)

−

Csm

(1,

r,

t)

,

m

=

2,

3,

（2-4） （2-5）

如果在固定 m 和 t 的情况下，当 N →  时，S(m, r,t) 的取值与 r 无关，恒为 0， 但是根据实际情况， N 的取值是有限的，定义 S(m,t) 为 S(m, r,t) 最大与最小值的 差，如式（2-6）。

S(m,t) = max{S(m, rj ,t)}− min{S(m, rj ,t)}

（2-6）

C-C 法主要计算 S(t) ， S(t) 以及 Scor (t) 的值以得到相空间重构的参数，选取 m = 2,3, 4,5 ， ri = i 2 ， i = 1, 2,3, 4 ，各公式如下：

  S(t)

=

1 16

5 m=2

4 j =1

S(m, rj ,t)

（2-7）

 S(t) = 1 5 S(m,t)
4 m=2

（2-8）

Scor (t) = S(t) + S(t)

（2-9）

最佳时延 为 S(t) 中第一个极小值，时间窗口 w 为 Scor (t) 的最小值，根据公 式 w = (m −1) 求出最佳嵌入维度 m 。

2.3 变分模态分解

变分模态分解（Variational Mode Decomposition，VMD）算法是一种新的信号

12

北京交通大学硕士学位论文

相关背景知识

处理方法，收敛速度快并且对于噪声具有良好的鲁棒性[53]。VMD 算法把原始信号 分解为 k 个中心频率为k 的模态分量 k ，同时使所有模态分量的带宽总和最小化， 这实际上是在解决一个约束变分问题，通过求解约束变分模型来得到每个分解模 态的中心频率和带宽。对于原始的时间序列 f (t) ，VMD 分解相当于构造下面的约 束变分表达式：

 
{umk },i{nk } k

[(

(t

)

+

j t

)



uk

(t

)]e

−

jk

t

2 2

 

s.t. uk (t) = f (t)
k

（2-10）

其中， (t) 为狄拉克分布函数， 为卷积操作， j2 = −1 ，每个模态的带宽是根据其 梯度的 L2 范数平方估计所得的。利用增广拉格朗日函数法将约束变分问题转化为 无约束变分问题，如式（2-11）所示。

 L({uk},{k}, ) = 
k

[(

(t

)

+

j t

)



uk

(t

)]e

−

jk

t

2
+
2

  f (t) −

2
uk (t) +

(t), f (t) −

uk (t)

k

2

k

（2-11）

其中，(t) 为拉格朗日乘子， 为二次惩罚项，为了得到式（2-11）的鞍点，也就

是最优解，利用交替方向乘子法解决优化问题，模态分量 k 表示为式（2-12），对 应的中心频率k 表示为式（2-13），  表示为式（2-14）。

 ˆkn+1() =

fˆ ()

−

ik

ˆi ()+

ˆ() 2

1+ 2 ( − k )2

（2-12）



2

 ˆkn+1() =

0  ˆk () d



2

0 ˆk () d

 ˆn+1() = ˆn () + ( fˆ () − ˆkn+1()) k

（2-13） （2-14）

其中， ˆkn+1() ， fˆ () ， ˆi () ， ˆ() 均为傅里叶变换之后所得。

2.4 支持向量回归机

支持向量机（Support Vector Machine，SVM）是一种建立在统计学习理论基础 的监督学习方法，主要基于统计学习理论中的结构风险最小化原则提高模型的推 广能力[54]。支持向量回归机（Support Vector Regression，SVR）是支持向量机的一

13

北京交通大学硕士学位论文

相关背景知识

个分支，是 SVM 模型衍生到回归领域所得到的一种回归分析方法。简单来说，SVR 与 SVM 的区别在于：SVR 解决回归预测的问题，SVM 解决分类和识别的问题； SVR 是寻找一个最优的超平面，使所有样点离超平面的距离的方差和尽可能小， 而同样是为寻找最优超平面，SVM 使多类样本分离的间隔尽可能大。
SVR 回归函数的表达式如下：

f (x) = T(x) + b

（2-15）

其中，(x) 为样本从低维到高维的映射函数， 和 b 为相关的系数。 在 SVR 模型中，给定一组样本 (x, y) ，回归问题可以理解成将样本拟合到一个
回归函数 f (x) ，使函数值与真实值之间的误差不能超过  ，也就是说 SVR 模型可 以容忍 f (x) 与 y 之间有不超过  的误差。  损失函数定义如下：

L(

f

(x),

y, )

=

0, f (x) −   f (x) − y

y  −, f

(x) −

y





（2-16）

SVR 优化问题表示为式（2-17）。

 min 1 2

n
w 2 + C (i + i*)
i =1

 

yi

−

 T  ( xi

)

−

b





+

i

s.t.T(xi ) + b − yi   + i*



i ,i*  0

（2-17）

其中，C  0 ，表示对超出  的样本的惩罚参数，i 和i* 为松弛因子。使用拉格朗 日方法获得优化问题的对偶形式如式（2-18）所示，约束条件为式（2-19）。

   max
i ,i*

n i =1

yi (i

−i*) −

n i =1

(i

+i*) −

1 2

i,

n j =1

(i

−i*)( j

−



* j

)

K

(

xi

,

x

j

)

（2-18）

n

 s.t.

(i*

−i

)

=

0,

0



i

,



* i



C

i

（2-19）

其中， K (xi , x j ) 为核函数，于是最终的 SVR 回归模型表示为式（2-20）。

n

 f (x) =

(i

−



* i

)K

( xi

,

x

j

)

+

b

i =1

（2-20）

常用的核函数有线性核函数，多项式核函数和径向基核函数。径向基核函数 的学习泛化能力较好，适合解决非线性问题，并且涉及参数较少，定义为式（2-21）。

K (x, xi ) = exp(− x − xi 2 )

（2-21）

14

北京交通大学硕士学位论文

相关背景知识

综上，SVR 模型中需要确定的两个参数分别是核函数中的  和惩罚参数 C ， 参数直接影响到预测结果，所以参数的选择也是至关重要的。

2.5 差分自回归滑动平均模型

自回归滑动平均模型（Autoregressive Moving Average Model，ARMA）是时间

序列预测法中常见的一种模型。利用 ARMA 建模需确保数据平稳，否则需要通过

d 阶差分使数据平稳。通过差分后再建立 ARMA 模型，称为差分自回归滑动平均

模型（Autoregressive Integrated Moving Average Model，ARIMA）。常用的时间序

列模型有：自回归模型、移动平均模型、自回归滑动平均模型和差分自回归滑动

平均模型[55]。

（1）自回归模型

如果时序xt 满足方程（2-22），则说明它服从于 p 阶自回归过程，记为 AR ( p) 。

xt = 0 + 1xt−1 + 2 xt−2 + + p xt− p + t

（2-22）

其中，t 为白噪声，0,1, ,p 为自回归模型的参数。
（2）移动平均模型

如果时序xt 满足方程（2-23），则称xt 为 q 阶移动平均过程，记为 MA (q) 。

xt = t −1t−1 −2t−2 − −qt−q

（2-23）

其中，t 为白噪声，1,2 , ,q 为移动平均模型的参数。
（3）ARIMA 模型 在实际应用中，时间序列经常是非平稳的，一个非平稳序列经过差分后成为

平稳序列，利用 ARIMA ( p, d, q) 模型进行预测分析，其中 AR 为自回归，MA 为移

动平均， p 为自回归项， q 为移动平均项， d 为使序列平稳时的差分次数。 如果 ARIMA ( p, d, q) 模型中的一些参数出现了缺省的情况，则称为疏系数模
型，如果只缺少部分的自回归项，则模型表达如式（2-24）所示，如果只缺少部分

的移动平均项，则模型表达如式（2-25）所示，如果自回归项和移动平均项均有部

分的缺失，则模型表达如式（2-26）所示。

ARIMA (( p1, p2 , pm ), d, q)

（2-24）

ARIMA ( p, d , (q1, q2 , qn ))

（2-25）

ARIMA (( p1, p2 , pm ), d , (q1, q2 , qn ))

（2-26）

图 2-1 为建立 ARIMA 模型的步骤： （1）对时间序列绘制序列图，并进行单位根检验 （Augmented Dickey-Fuller

15

北京交通大学硕士学位论文

相关背景知识

test，ADF），判断其是否平稳。 （2）对非平稳序列进行差分处理成为平稳序列，在这一过程中可确定差分的
阶数，即 d 的值。 （3）拟合模型，通过自相关和偏自相关函数图确定 p 和 q 的值。 （4）模型选择，比较各模型的赤池信息准则（Akaike Information Criterion，
AIC）的值，选取最优模型。 （5）模型检验，检验模型的拟合效果。对 ARIMA 模型的检验主要有两个方
面：一是检验参数估计是否具有显著性；二是检验拟合模型残差序列的随机性， 即残差是否具有相关性，一般通过观察自相关图、偏相关图、Q 统计量和对应的 P 值来实现。
（6）模型预测，根据最终确定的模型预测未来短期数值。

图 2-1 ARIMA 模型建模流程图 Figure 2-1 Flow chart of ARIMA model
2.6 预测结果评价标准
为比较各模型的预测效果，本文实验部分选择最大相对误差、最小相对误差、 平均相对误差平方和均方根、均方根误差（Root Mean Square Error，RMSE）及平 均绝对百分误差（Mean Absolute Percentage Error，MAPE）作为模型预测性能的评 价指标。
（1）最大相对误差及最小相对误差
16

北京交通大学硕士学位论文

相关背景知识

相对误差是绝对误差与实际值之间的比值，以百分数表示，最大相对误差及 最小相对误差反映最大偏差程度和最小偏差程度，表达式如下：

 max

M yi − yˆi y i=1
i

 min M yi − yˆi y i=1 i

（2-27） （2-28）

（2）相对误差平方和均方根 相对误差所有值平方求和，求其均值，再开平方，用来衡量相对误差整体偏 差程度，表达式如下：

 1 M ( yi − yˆi )2
M i=1 yi

（2-29）

（3）RMSE 预测常用的评价指标主要为均方根误差，描述的是预测值与真实值之间的关 系，可以衡量预测值与真实值的偏差，在同一组数据下比较不同模型的预测性能， RMSE 值越小，说明预测模型精确度越高，其表达式如下：

 RMSE = 1
M

M i

( yi

−

yˆi )2

（2-30）

（4）MAPE 平均相对误差为所有预测值之间的相对误差求和后的平均值，能从实际的角 度更准确地反映预测误差，其表达式如下：

 MAPE = 1
M

M yi − yˆi y i=1
i

其中， M 为预测样本数， yi 为真实值， yˆi 为预测值。

（2-31）

2.7 本章小结

本章首先介绍了相空间重构理论的相关知识，包括意义，重构参数的确定方 法及混沌特性的识别方法，其次介绍了本文在预测实验中涉及到的模型和算法， 最后介绍了预测模型的性能评价标准。

17

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

3 基于单元相空间重构的货运需求预测模型
现有货运需求预测技术中的一类通过分析历史数据预测未来的方法，虽然操 作简单，但存在一定的主观性，面对波动较大的序列预测效果也十分有限。本章 提出了基于单元相空间重构的货运需求预测模型，对非平稳的单元货运时间序列 进行分解，根据分量不同的特征有针对性地进行预测分析，并引入相空间重构理 论构建相空间，将一维的高频分解分量重构到多维空间，确定输入输出结构，最 后将不同频率的分解分量的预测结果进行组合。本章将通过实验验证所提出预测 模型的有效性。
3.1 模型框架
单元的货运时间序列受各种因素的影响，呈现出非线性、非平稳等特点，传 统的预测模型并不适合这类随机波动较大的单元时间序列，如果利用非线性预测 模型进行预测，输入集一般根据经验确定，因此本文引入了相空间重构理论，提 出基于单元相空间重构的货运需求预测模型，解决了盲目选择输入集这一问题， 考虑直接利用非线性模型预测，预测效果可能一般，在此基础上引入分解集成的 思想减小误差，将原始的单元货运序列进行分解，针对不同分解分量选用合适的 模型预测，最后将上述方法集成获得预测结果。该模型框架如图 3-1 所示。

图 3-1 基于单元相空间重构的货运需求预测模型框架 Figure 3-1 Model framework of freight demand forecast based on unit phase space reconstruction
原始的集装箱货运数据存在一些异常缺失的情况，需要进行预处理再进行后 续实验，从该模型框架图 3-1 中可以看出，整个预测过程基于分解集成的原则，总 体可以分为四个部分。
第一部分，经过预处理的数据利用 VMD 算法提取隐藏在原始时间序列中不同 频率的模态。
18

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

第二部分，VMD 分解得到的低频模态反映了原始序列的波动趋势，ARIMA 模型在捕捉线性关系方面具有一定的优势，因此选择 ARIMA 模型预测低频模态。
第三部分，VMD 分解得到的高频模态反映了原始数据更详细的局部特征，波 动性更大，SVR 模型适合预测非线性系统，因此选择 SVR 模型预测高频模态，并 引入了相空间重构理论，确定 SVR 预测模型的输入输出结构。
第四部分，将低频模态和高频模态的预测结果相加得到最终的预测结果。

3.2 算法设计

根据 3.1 小节所构建的模型框架，接下来将详细地介绍算法设计流程：
将原始单元货运需求时间序列设为x(t) ， t = 1, 2, , N ，其中 N 为时间序列
的长度。根据 VMD 算法原理，将单元货运时间序列分解为 K 个分量，表示为式 （3-1）。

K

K

  x(t) = imfi (t) = Ai (t) cos(i (t))

i =1

i =1

（3-1）

其中， imfi (t) 表示的是经 VMD 分解后的第 i 个分解分量在 t 时刻的值， Ai (t) 表示

的是 imfi (t) 的瞬时振幅，i (t) 表示的是 imfi (t) 的瞬时相位。经 VMD 分解后的第 i 个

分解分量设为 imfi ，表示为式（3-2）。

imfi = imfi (1),imfi (2), ,imfi (N),i =1, 2, , K

（3-2）

选取具有线性特征的低频分量{imfi}，i = 1, 2, , D ，D 为低频分量的个数，利 用 ARIMA 模型进行预测，根据 2.5 小节所介绍的内容，ARIMA 建模过程如下：

首先，进行 ADF 单位根检验判别低频分量 imfi 是否为平稳序列，如果不是平 稳序列，需要进行差分处理，一阶和二阶差分计算公式如（3-3）和（3-4）所示。

imfi (t) = imfi (t) − imfi (t −1)

（3-3）

2imfi (t) = imfi (t) − imfi (t −1)

（3-4）

其次，确定拟合模型的参数，通常情况下，模型参数是根据自相关系数和偏 自相关系数的性质来判断的。自相关系数表示的是在给定滞后阶数的情况下，原 有观察值和滞后观察值之间的相关度，计算公式如（3-5）所示。

N −k

 (imfi (t) − i )(imfi (t + k) − i )

rk = t=1

N

 (imfi (t) − i )2

t =1

（3-5）

19

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

其中， k 为滞后阶数， i 为第 i 个分解分量的平均值。偏自相关系数表示的是扣除 时间序列中的 k −1项，即排除 imfi (t − k +1),imfi (t − k + 2), ,imfi (t −1) 影响后 imfi (t) 与 imfi (t − k) 之间的相关度。计算公式如（3-6）所示。

11 = r1 k−1

 
 kk

=

rk

−
i =1 k −1

 r k −1,i k −i

,k

=

2, 3,

 

 1 −  r k−1,i k −i i =1

ki = k−1,i − kkk −1,k −i , i = 1, 2,

,k −1

（3-6）

借助平稳时间序列的相关图选择适合的模型，分为以下三种情况：

（1）若自相关函数呈现拖尾状态，偏自相关函数在 p 阶呈现截尾状态，则选

择模型 AR(p) ；

（2）若自相关函数在 q 阶呈现截尾状态，偏自相关函数呈现拖尾状态，则选

择模型 MA(q) ；

（3）若自相关和偏自相关函数均呈现拖尾状态，则选择模型 ARMA(p,q) 。

如果根据相关图难以确定自相关函数和偏自相关函数的性质是拖尾或截尾，

则此时需要尝试不同的模型，通过分析参数显著性检验结果选择拟合模型。参数

显著性检验的过程如下：

（1）设序列均值为 c ，原假设 c = 0 ，备假设 c  0 ；

（2）在给定显著性水平 的情况下，进行参数 t 检验，计算原假设成立的概

率 p ，若 p   ，则拒绝原假设，即参数不显著为 0，参数是有意义的。

利用 AIC 准则在多种模型中确定最优拟合模型，AIC 计算公式如（3-7）所示。

AIC = 2l − 2ln (L)

（3-7）

其中， l 为模型中参数的个数， L 为模型的似然函数。 利用通过参数显著性检验的模型拟合原序列，可以得到残差序列，为了检验
该拟合模型的适应性，残差序列必须通过 Q 检验才可以选用该模型进行预测。残 差序列 Q 检验的过程如下：
（1）设残差序列的自相关系数为 resk ，原假设残差序列不存在自相关，即 res1 = res2 = = resk = 0 ，备假设残差序列存在自相关；
（2）在给定显著性水平 的情况下，计算 Q 统计量在原假设成立时的概率 p ， 若 p   ，则不能拒绝原假设，即残差序列为白噪声，不存在自相关。
最后，选择通过显著性检验和适应性检验的最佳拟合模型进行预测，得到第 i 个低频分量在 t 时刻的预测结果 yi' (t) ，ARIMA 模型对第 i 个低频分量在 t 时刻的预

20

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

测结果 yi1(t) 与差分阶数有关，计算公式如（3-8）所示。

  

yi1 yi1

(t (t

) )

= =

yi' (t), d = 0 imfi (t −1) +

yi' (t), d

=1



 yi1(t) = 2imfi (t −1) − imfi (t − 2) + yi' (t −1), d = 2

（3-8）

选取具有非线性特征的高频分量{imf j} ， j = 1, 2, ,G ，G 为高频模态的个数。 利用 SVR 模型进行预测，在预测之前需要对各高频分量 imf j 进行相空间重构处理， 利用 C-C 法求解相空间重构的参数 m j 和  j ， M j 为重构后相空间点的个数， M j = N − (mj −1) j ，构成的相空间如式（3-9）所示。



imf j (1)

 

imf j (2)



imf j (N − (mj −1) j )

imf j (1+ j ) imf j (2 + j )
imf j (N − (mj − 2) j )

imf j (1+ (mj −1) j ) 

imf

j

(2

+

(mj

−1)

j

)

 

（3-9）



imf j (N )

 

根据重构后的相空间确定 SVR 模型的输入集和输出集，SVR 预测模型的输入

为重构后的相空间点，输出为下一个相空间点的最后一维，将训练好的 SVR 模型

对测试数据进行预测，第

j

个高频分量在 t

时刻的预测结果为

y

2 j

(t

)

。

根据以上所描述的预测过程，该组合模型的最终预测结果计算公式如（3-10）

所示。

D

G

  y(t) =

yi1(t) +

y

2 j

(t

)

i =1

j =1

（3-10）

SVR 预测模型虽然在处理非线性问题上具有一定的优势，但 SVR 预测模型中 有两个重要的参数会直接影响到最终的预测结果，分别是惩罚参数 C 和核函数中 的  。为了提高预测精度，同时避免出现过学习或欠学习的情况，需要一种优化算 法来解决这个问题。
本文采用启发式学习的粒子群算法（Partical Swarm Optimization，PSO）来优 化 SVR 模型的参数。PSO 算法的主要思想：每个优化问题的解为一个粒子，每个 粒子对应一个适应度，飞行方向和距离由粒子的速度决定，粒子根据本身和最优 个体的经验动态调整位置，通过不断迭代搜索得到最优位置。PSO 算法优化流程 如图 3-2 所示。
设在一个 D 维搜索空间，存在一个包括 m 个粒子的粒子群，其中第 i 个粒子的 位置为 xi = (xi1, xi2 , , xiD ) ，速度为 vi = (vi1, vi2 , , viD ) ，在搜索过程中所经过的最好 位 置 为 pi = ( pi1, pi2 , , piD ) ， 粒 子 群 在 搜 索 过 程 中 所 经 过 的 最 好 位 置 为 g = (g1, g2, , gD ) ，每个粒子速度和位置的更新公式为式（3-11）和式（3-12），适

21

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

应度函数选择可以衡量 SVR 模型回归性能的均方误差，为式（3-13）。

vij (t +1) = wvij (t) + c1r1( pij − xij (t)) + c2r2 (gi − xij (t))

（3-11）

xij (t +1) = xij (t) + vij (t)

（3-12）

 1
n

n i =1

( yi

−

yˆi )2

（3-13）

其中，c1 和 c2 为学习因子，作用是调节学习步长，r1 和 r2 为随机函数，作用是使搜 索具备随机性，取值在[0,1] ， w 为权重因子且 w  0 ， yi 和 yˆi 分别为第 i 组数据的 真实值和预测值。

图 3-2 PSO 算法优化流程 Figure 3-2 The optimization process of the PSO algorithm
PSO 优化算法的具体步骤为： （1）在随机的条件下，初始化粒子群，包括粒子群的规模，粒子的速度和位 置； （2）根据公式（3-13）计算每个粒子的适应度，记录适应度最好的粒子，初 始全局极值 g 为这个粒子的位置； （3）比较每个粒子此刻适应度和自身历史最优适应度 p ，如果前者更优，则 p 被替换；比较每个粒子此刻适应度和全局最优适应度 g ，如果前者更优，则 g 被 替换； （4）根据公式（3-11）和公式（3-12）更新粒子的速度和位置； （5）判断是否满足结束的条件，如果不满足，返回步骤（2）直到算法结束， 结束条件是达到了最大迭代次数或者适应度满足收敛条件。
22

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

综上，基于单元相空间重构的货运需求预测模型的算法流程如图 3-3 所示。

图 3-3 基于单元相空间重构的货运需求预测模型算法流程图 Figure 3-3 Algorithm flow of freight demand forecasting model
based on unit phase space reconstruction
3.3 实证分析
为了验证基于单元相空间重构的货运需求预测模型的有效性，本章节将结合 预测模型的实现过程在现有的货运集装箱数据集上进行实验，并与其他预测方法 进行对比分析，总结此模型的特点和优势。
23

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

3.3.1 实验数据及环境

本文研究采用的是全国货运站点之间集装箱发送情况的数据集，数据集共有 5 个字段，5168221 条天度数据，包括 689 个发站和 701 个到站，时间跨度为 2007 年 1 月至 2018 年 4 月初旬。根据本文研究实验需要，从货运集装箱发送情况的数 据集中提取装箱数字段代表总体货运需求，过滤掉品类和到发站字段。货运集装

箱发送情况的数据是从货运系统中直接采集的，数据存在一定的缺失，主要原因

是采集数据时系统出现了故障或人工填写失误等，因此要对数据集进行预处理，

对于缺失的数据选取的填充方法是取周围装箱数数据的平均值。

本文实验的硬件和软件环境如表 3-1 所示。

表 3-1 实验环境

Table 3-1 Experimental environment

环境

版本

操作系统 内存
存储空间 CPU 型号 Python 版本 Mysql 版本 Matlab 版本 Eviews 版本

Windows10 16G 1T
Intel(R) Core(TM) i7-8550U CPU @ 1.80GHz 3.7
5.7.17 9.1 8.0

根据目前集装箱货运市场实际分析的时间维度，并结合本章的实验内容，将

原有的天度实验数据整理为周度数据，最终得到 588 组周度集装箱装箱数数据， 将前 576 组数据作为训练数据用于建立预测模型，后 12 组数据作为测试数据用于 模型检验，即用所建立的模型进行预测。

3.3.2 VMD 算法分解
在对集装箱周度装箱数序列分解之前，需要确定 VMD 算法分解的模态个数 K 。 K 值的选取对于整体的预测结果较为重要，如果 K 值过小，会导致时间序列 中隐含的特征不易被提取出来，如果 K 值过大，即分解后的模态过多，导致误差 的积累，同时也会出现模态混叠的情况。本文通过观察在给定不同的 K 值条件下， 对应的不同分解模态的中心频率的变化来确定最佳的 K 值。各模态对应的中心频 率的变化如表 3-2 所示。

24

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

表 3-2 各模态数对应的中心频率

模态数

Table 3-2 Center frequency corresponding to different K 中心频率(Hz)

2

1.0604e-04 0.0139 -

-

-

-

-

-

3

1.0549e-04 0.0139 0.3055 -

-

-

-

-

4

8.5434e-05 0.0111 0.0618 0.3070 -

-

-

-

5

8.5329e-05 0.0111 0.0616 0.3055 0.4568 -

-

-

6

8.1309e-05 0.0105 0.0543 0.1372 0.3078 0.4574 -

-

7

8.1204e-05 0.0105 0.0542 0.1366 0.3047 0.3779 0.4615

-

8

7.9256e-05 0.0103 0.0502 0.1167 0.2224 0.3084 0.3811 0.4619

从表 3-2 中可以看出，当 K =7 时，有两种模态的中心频率很相近，分别是 0.3047 和 0.3779，这说明出现了过分解的情况，所以模态数 K 选为 6。分解结果如图 3-4 所示。

图 3-4 集装箱周度装箱数序列 VMD 分解结果 Figure 3-4 VMD decomposition result of the container per-week packing sequence
3.3.3 ARIMA 模型预测
从图 3-4 中可以看出，集装箱周度装箱数序列经过 VMD 算法分解后，得到了 6 种模态分量 imf1, ,imf6 ，imf1 和 imf2 为低频模态，其余为高频模态。现对低频模 态 imf1 和 imf2 分别建立 ARIMA 模型进行预测。
对模态 imf1 建立 ARIMA 模型，预测过程如下： （1）平稳性检测 利用 ADF 单位根检验判断其是否为稳定的时间序列，如果单位根检测得到的 统计量同时小于 1%、5%、10%三种不同程度的临界统计值，则拒绝原假设，即此 时为平稳序列，否则需要进行差分处理。模态 imf1 的 ADF 单位根检验结果如表 3-3
25

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

所示。

表 3-3 ADF 检测结果

Table 3-3 ADF test results

指标

结果

统计量 t 概率 P 临界值（1%） 临界值（5%） 临界值（10%）

0.591397 0.9895 -3.441573 -2.866383 -2.569409

统计量 t 为 0.591397，均大于显著性水平 1%、5%、10%的 ADF 临界统计值 且概率 P 值大于 0.05，所以不能拒绝存在单位根的原假设，模态 imf1 为非平稳序列， 需要进行差分处理。差分处理指将相邻的两项做差，即 y = yt − yt−1 。现对模态 imf1 进行一阶差分处理，ADF 单位根检验结果如表 3-4 所示。

表 3-4 一阶差分 ADF 单位根检测结果

Table 3-4 First-order differential ADF unit root detection results

指标

结果

统计量 t 概率 P 临界值（1%） 临界值（5%） 临界值（10%）

-1.889697 0.3372
-3.441569 -2.866387 -2.569413

一阶差分后统计量 t 为-1.889697，均大于显著性水平 1%、5%、10%的 ADF 临界统计值且概率 P 值大于 0.05，所以依然不能拒绝存在单位根的原假设，继续 差分处理，二阶差分后的 ADF 单位根检验结果如表 3-5 所示。

表 3-5 二阶差分 ADF 单位根检测结果

Table 3-5 Second-order differential ADF unit root detection results

指标

结果

统计量 t 概率 P 临界值（1%） 临界值（5%） 临界值（10%）

-9.890147 0.0000
-3.441654 -2.866419 -2.569428

二阶差分后统计量 t 为-9.890147，均小于显著性水平 1%、5%、10%的 ADF 临界统计值且概率 P 值小于 0.05，所以拒绝存在单位根的原假设，即二阶差分后 得到的序列是平稳的。

26

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

（2）模型的参数估计 差分后序列的自相关和偏自相关分析情况如图 3-5 所示，难以从图中直接确定 模型的阶数，但是从自相关图中可以看出，延迟 1、3、6、7 阶的自相关系数显著 大于 2 倍标准差，从偏自相关图中可以看出，延迟 1、2、6、7 的偏自相关系数显 著大于 2 倍标准差，现尝试几种不同的模型拟合，各种模型的参数显著性检验结 果如表 3-6 所示，只有模型 2 和模型 3 的参数显著性结果均小于 0.05，证明参数显 著。模型 2 的 AIC 值为 10.87999，模型 3 的 AIC 值为 10.60162，因此最终选择模 型 3，即 ARIMA((1,2,6),2,(1,2,4,6,7))疏系数模型用于预测模态 imf1 。

图 3-5 自相关和偏自相关系数结果图

Figure 3-5 Results graph of self-correlation and partial correlation coefficients 表 3-6 各模型参数显著性检验结果

Table 3-6 Test results for the significance testing of each model parameter

模型

1

2

3

4

AR(1)

0.2129

0.0000

0.0005

0.8612

AR(2)

0.2798

0.0000

0.0285

0.1472

AR(6)

0.0000

0.0028

0.0000

0.0016

AR(7)

0.2132

-

-

-

MA(1)

0.0000

0.0000

0.0000

0.0000

MA(2)

-

-

0.0000

0.1837

MA(3)

0.6818

0.0000

-

0.0000

MA(4)

-

-

0.0000

0.0000

MA(6)

0.1006

0.0000

0.0052

0.3057

MA(7)

0.4610

0.0021

0.0002

0.0000

（3）模型适应性检验 拟合模型的好坏的判断依据是看它能否充分提取序列中的样本信息，所以模

型适应性检验也就是要判断残差序列是否为白噪声。如果残差序列不是白噪声，

则表明拟合的模型不够有效。模态 imf1 拟合的 ARIMA((1,2,6),2,(1,2,4,6,7))模型生成 残差序列，残差序列自相关和偏自相关图的 Q 统计量及其 P 值如表 3-7 所示，从

27

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

表中可以看出 P 值都显著大于 0.05，则接受原假设，得到的残差序列是白噪声序 列，即模型是有效的。

表 3-7 ARIMA((1,2,6),2,(1,2,4,6,7))模型残差序列 Q 统计量及其 P 值

Table 3-7 ARIMA((1,2,6),2,(1,2,4,6,7)) model residual sequence Q statistics and P values

阶数

Q 统计量

P

1

0.4530

0.510

2

0.6003

0.741

3

2.1009

0.552

4

3.0494

0.550

5

5.8075

0.325

6

5.8225

0.443

7

11.378

0.123

（4）模型预测 本文是样本内预测，因此利用静态预测的方式进行模型的预测，即每一步预

测，预测值都要被真实值代替，接着代入估计区间，再进行一次预测，静态预测

效果评估结果如表 3-8 所示，其中 Theil 不相等系数约为 0.37，协方差比例约为 0.84， 偏差比例约为 0.16，方差比例约为 0，偏差比例和方差比例较小，而协方差比例较 大，表明该模型的拟合程度较好，预测结果较理想。

表 3-8 静态预测效果评估结果

Table 3-8 Static prediction effect assessment results

指标

结果

Theil 不相等系数 协方差比例 方差比例 偏差比例

0.366661 0.840754 0.000014 0.159232

对模态 imf2 建立 ARIMA 模型，预测过程如下： （1）平稳性检测 模态 imf2 的 ADF 单位根检验结果如表 3-9 所示。统计量 t 为-5.426603，均小 于显著性水平 1%、5%、10%的 ADF 临界统计值且概率 P 值小于 0.05，所以拒绝 存在单位根的原假设，模态 imf2 为平稳序列。 （2）模型的参数估计 序列的自相关图和偏自相关图如图 3-6 所示，在自相关图中，延迟 1、2、3、 4、5 阶的自相关系数显著大于 2 倍标准差，在偏自相关图中，延迟 1、2、3、6、 7 的偏自相关系数显著大于 2 倍标准差，尝试几种不同的模型拟合，各种模型的参

28

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

数显著性检验结果如表 3-10 所示，最终选择模型 2，即 ARIMA((1,3),0,(1,2,3,4,5)) 疏系数模型用于预测模态 imf2 。
表 3-9 ADF 单位根检测结果

Table 3-9 ADF unit root detection results

指标

结果

统计量 t 概率 P 临界值（1%） 临界值（5%） 临界值（10%）

-5.426603 0.0000
-3.441573 -2.866383 -2.569409

图 3-6 自相关和偏自相关系数结果图

Figure 3-6 Results graph of self-correlation and partial correlation coefficients

表 3-10 各模型参数显著性检验结果

Table 3-10 Test results for the significance testing of each model parameter

参数

模型 1

模型 2

模型 3

模型 4

AR(1)

0.0000

0.0000

0.0000

0.0000

AR(2)

0.9708

-

-

-

AR(3)

0.0000

0.0000

0.0000

-

AR(6)

0.0000

-

0.0000

0.0119

AR(7)

0.7532

-

-

0.1635

MA(1)

0.0000

0.0000

0.0000

0.0000

MA(2)

0.9983

0.0022

0.3632

0.0047

MA(3)

0.0000

0.0004

0.0000

0.3817

MA(4)

0.0000

0.0000

0.0000

0.0099

MA(5)

0.2587

0.0230

0.8467

0.0000

（3）模型适应性检验 模态 imf2 拟合的 ARIMA((1,3),0,(1,2,3,4,5))模型生成残差序列，残差序列自相 关和偏自相关图的 Q 统计量及其 P 值如表 3-11 所示，P 值都显著大于 0.05，则接 受原假设，得到的残差序列是白噪声序列，即模型是有效的。

29

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

表 3-11 ARIMA((1,3),2,(1,2,3,4,5))模型残差序列 Q 统计量及其 P 值

Table 3-11 ARIMA((1,3),2,(1,2,3,4,5)) model residual sequence Q statistics and P values

阶数

Q 统计量

P

1

0.0853

0.510

2

1.7239

0.741

3

3.4785

0.552

4

3.6039

0.550

5

5.4834

0.325

6

6.3974

0.177

7

11.397

0.135

（4）模型预测 静态预测效果评估结果如表 3-12 所示，其中 Theil 不相等系数约为 0.31，协 方差比例约为 0.90，偏差比例约为 0.10，方差比例约为 0，偏差比例和方差比例较 小，而协方差比例较大，表明该模型的拟合程度较好，预测结果较理想。

表 3-12 静态预测效果评估结果

Table 3-12 Static prediction effect assessment results

指标

结果

Theil 不相等系数 协方差比例 方差比例 偏差比例

0.313028 0.902788 0.000086 0.097126

综上，两种低频模态 imf1 和 imf2 经 ARIMA 模型预测的结果如图 3-7 所示。

图 3-7 两种低频模态的 ARIMA 模型预测结果图 Figure 3-7 Results graph of self-correlation and partial correlation coefficients
3.3.4 SVR 模型预测
SVR 预测模型在处理非线性问题上具有一定的优势，在对高频模态进行 SVR
30

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

模型预测之前，需要对高频模态进行相空间重构。首先，需要求出各个高频模态 的嵌入维数 m 和时间延迟 ，采用第二章所描述的 C-C 算法分别求解每个高频模 态的相空间参数，选取 C-C 算法中 S(t) 的第一个极小值作为最佳时间延迟 ，同 时选取 Scor (t) 的最小值作为时间窗口 w ，并利用公式 w = (m −1) ，求出最佳嵌入 维度 m 。四种高频模态的相空间参数确定情况如图 3-8 所示。根据图 3-8 确定各时 间序列的时间延迟和时间窗口，进而求出嵌入维数，计算得到四种高频模态的相 空间参数结果如表 3-13 所示。

图 3-8 四种高频模态的相空间参数确定图

Figure 3-8 The phase spatial parameters of the four high-frequency modes 表 3-13 四种高频模态的相空间参数

参数

Table 3-13 Phase space parameters of four high-frequency modes

imf 3

imf 4

imf 5

imf 6

m

4

5

4

3



4

3

3

2

徐自励等[56]提出使用传统的 C-C 法虽然易操作、计算量小，但是直接由一段 数据估计出 m 和 两个参数，具有一定的波动性。本文借鉴谱估计中平均法的思想， 提出对实际非线性时间序列采用分段处理，在求出不同时间序列段对应的 m 和 后，取其平均作为最后的重构参数，减少传统 C-C 法的不可靠性，提高重构的合 理性。具体的实现过程为：高频模态 imfi (t) ，t = 1, 2, , N ，N 为时间序列的长度， 将 imfi 平均分为 M 段序列 imfi1,imfi2 , ,imfiM ，每段序列的长度为 N / M ，得到 imfi 最终的相空间参数 mi 和 i ，表达式如（3-14）和（3-15）所示。

31

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

M
 mi = mij / M j =1
M
 i = ij / M j =1

（3-14） （3-15）

其中， mij 为第 i 个高频模态第 j 段序列的嵌入维数，ij 为第 i 个高频模态第 j 段序 列的时间延迟。利用 C-C 平均法将高频模态 3 至模态 6 分为相同的段数，计算得 到每种模态的重构参数，结果见表 3-14。

表 3-14 每种高频模态的重构参数

模态

Table 3-14 Reconstruction parameters for each high-frequency mode

参数

C-C-3

C-C 平均法

C-C-4

C-C-5

C-C-6

m

3

3

2

3

imf 3



3

3

3

3

m

2

3

3

3

imf 4



4

4

3

3

m

3

3

3

3

imf 5



4

3

4

4

m

2

2

3

3

imf 6



5

3

3

3

经传统 C-C 法计算重构参数后，根据式（3-9）确定各种高频模态所对应的 SVR 预测模型具体输入输出结构，如表 3-15 所示。经 C-C 平均法得到的具体输入输出 结构不再赘述。
表 3-15 预测模型的输入和输出

Table 3-15 The input and output sets of the prediction model

模态

输入

输出

x(1), x(5), x(9), x(13)

x (14)

x(2), x(6), x(10), x(14)

x (15)

imf 3

x(575), x(579), x(583), x(587)

x (588)

x(1), x(4), x(7), x(10), x(13)

x (14)

x(2), x(5), x(8), x(11), x(14)

x (15)

imf 4

x(575), x(578), x(581), x(584), x(587)

x (588)

32

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

表 3-15（续） 预测模型的输入和输出

Table 3-15 (Continue) The input and output sets of the prediction model

模态

输入

输出

x(1), x(4), x(7), x(10)

x (11)

x(2), x(5), x(8), x(11)

x (12)

imf 5

x(578), x(581), x(584), x(587)

x (588)

x(1), x(3), x(5)

x (6)

x(2), x(4), x(6)

x (7)

imf 6

x(583), x(585), x(587)

x (588)

3.3.5 预测结果及分析
经过相空间重构的高频模态输入到 SVR 预测模型，并使用 PSO 算法优化 SVR 模型的参数，设粒子群数量为 30，最大迭代次数为 100，学习因子 c1 = c2 = 2 ，惯 性权重 w = 0.3，考虑到 PSO 算法的随机性，对每种高频模态进行五次相应的 SVR 模型预测，然后计算五次预测结果的平均值，最后与 ARIMA 模型对低频模态的预 测结果相加求和，得到最终预测结果。将本文提出的 VMD-ARIMA-SVR 模型与 ARIMA、SVR、BP、指数平滑法和经 C-C 平均法优化重构参数后的模型进行比较， 各种预测模型预测结果如图 3-9 所示。

图 3-9 各种预测模型预测结果对比 Figure 3-9 The forecast results of various prediction models
从图 3-9 中可以看出，本文提出的预测模型相比于其他单一的预测模型，拟合 程度更高，重构参数经过优化后的预测结果在图中不方便进行比较，为了更加具
33

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

体直观地比较各种预测模型的拟合程度，计算各种预测模型的相对误差，如表 3-16 所示。

表 3-16 预测误差分析

序号 本文 算法

Table 3-16 Error analysis of prediction results 相对误差(%)
C-C-3 C-C-4 C-C-5 C-C-6 ARIMA SVR

指数 BP 平滑法

1 5.20 3.38 5.37 7.44 7.34

7.24

3.80 4.94 5.31

2 1.41 1.34 2.45 3.09 3.14

0.54

3.24 2.98 2.42

3 4.41 0.57 3.09 1.64 1.25

6.18

6.38 8.55 7.49

4 1.70 2.53 0.27 4.69 3.27

0.50

4.95 1.53 1.25

5 6.80 6.85 3.88 5.60 4.15

7.17

7.20 7.05 7.70

6 4.91 10.33 11.28 6.59 5.02

6.92

3.80 2.83 7.97

7 5.29 1.25 1.21 1.07 3.61 10.67 8.58 8.16 11.91

8 11.09 8.92 10.33 7.46 10.33 13.34 9.33 11.73 13.42

9 6.26 5.48 4.56 5.13 9.26 13.94 7.65 7.27 14.60

10 5.12 5.33 8.86 3.14 7.27

1.77

5.80 5.77 0.48

11 6.23 6.81 1.87 2.29 1.60

3.18

6.77 2.96 4.63

12 6.34 5.31 8.76 9.99 6.61 12.42 10.10 6.88 15.27

从表 3-16 中可以看出，各种预测模型在前期的预测误差大部分可以控制在 10%以内，从第 8 周开始，预测误差与前期相比偏大，但本文提出的模型在后期的 预测过程中预测误差仍可以保持稳定，波动不大，说明该模型的泛化性较好，各

模型预测评价指标结果如表 3-17 所示。

表 3-17 不同模型预测评价指标

模型

Table 3-17 Predictive evaluation indicators for different models

相对误差(%)

相对误差

最大绝对 最小绝对 平方和均方根

RMSE

MAPE

本文算法

11.0879

1.4129

0.0590

12626.23

0.0540

C-C-3

8.9249

0.5712

0.0568

11755.22

0.0481

C-C-4

10.3325

0.2660

0.0629

13167.41

0.0516

C-C-5

9.9932

1.0701

0.0550

11196.62

0.0484

C-C-6

10.3334

1.2535

0.0594

12891.74

0.0524

ARIMA

13.3371

0.4958

0.0839

17693.78

0.0699

SVR

10.0996

3.2436

0.0681

14135.99

0.0647

BP 指数平滑法

11.7269 15.2737

1.5293 0.4759

0.0654 0.0915

13892.00 19053.56

0.0589 0.0770

34

北京交通大学硕士学位论文

基于单元相空间重构的货运需求预测模型

由表 3-17 可以得出以下结论： （1）针对集装箱的周度装箱数数据，本文依据“分解集成”的思想，提出的 VMD-ARIMA-SVR 预测模型与单一 ARIMA 模型和 SVR 模型预测结果相比，预测 效果更好，预测精度有所提高，虽然在最大相对误差方面比 SVR 模型高 0.9883%， 在最小相对误差方面比 ARIMA 模型高 0.9171%，但在相对误差平方和均方根方面 分别降低了 2.49%和 0.91%，在 RMSE 方面分别降低了 5067.55 和 1509.76，在 MAPE 方面分别降低了 1.59%和 1.07%。 （2）将原始时间序列分成 3 至 6 段，C-C 平均法求解重构参数所得到的输入 输出结构，经 SVR 模型最终得到的预测结果在最小相对误差、最大相对误差和 MAPE 方面比传统的 C-C 法预测结果要好。 （3）将原始时间序列分成 5 段，C-C 平均法后经 SVR 模型最终得的预测结果 在 RMSE 方面预测精度最高，但原始时间序列分为 3 段的预测结果与其相差不大， 在最小相对误差、最大相对误差和 MAPE 方面均达到最低，因此可以得到结论： 将原始时间序列分为 3 段，经 C-C 平均法确定重构参数，以分解集成原则得到的 预测模型预测精度最高。
3.4 本章小结
本章针对周度的集装箱装箱数这类具有非线性特征的单元时间序列的数据， 提出了基于单元相空间重构的铁路货运需求预测模型。首先，基于分解集成的原 则，将复杂的货运预测问题分解为比较简单的子序列预测问题，即利用 VMD 算法 将实验数据分解为不同频率的模态，对于不同频率的模态选择不同的预测模型进 行预测，其中低频模态呈现的是线性特征，选择 ARIMA 预测模型；高频模态呈现 的是非线性特征，选择 SVR 预测模型，并利用 PSO 算法优化 SVR 模型的参数。 为了确定 SVR 模型的输入输出结构以及使高频模态中隐含的信息状态能够更好地 表现出来，引入了相空间重构理论，利用传统的 C-C 法得到重构后的相空间，为 了提高重构的合理性，借鉴平均法的思想将每种高频模态分段处理后取各段重构 参数的平均值作为最终的重构参数进行相空间重构。其次，将低频模态和高频模 态的预测结果集成得到最终的预测结果。最后，将本文提出的预测模型与传统的 单一预测模型进行性能对比，最终证明了本章提出的基于单元相空间重构的货运 需求预测模型是有效的，预测精度有所提高。

35

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

4 基于多元相空间重构的货运需求预测模型
我国对铁路基础建设不断增加投入力度，以及近年来对铁路货运的政策指导， 可以看出我国十分关注铁路货运的发展，准确的货运预测技术可以为铁路部门的 各项工作提供数据支持，然而铁路货运系统十分复杂，常用的一些货运预测方法 很难考虑到货运系统内部的变化信息。因此本章在货运预测领域引入混沌理论， 提出了基于多元相空间重构的货运需求预测模型。首先多方面分析货运需求的影 响因素，利用灰色关联法建立最终的指标体系；其次构建多元相空间矩阵，并识 别各时间序列的混沌特性，剔除不具备混沌特性的因素；最后将货运多元相空间 与神经网络结合进行预测。本章将通过实验验证所提出预测模型的有效性。
4.1 模型框架
铁路货运系统具有明显的非线性、关联性，又具有一定的随机性甚至某种混 沌性，简单的预测模型无法揭示铁路货运系统与其影响因素之间的复杂关系。本 文针对货运系统中的多元时间序列，引入混沌理论中的相空间重构理论，建立基 于多元相空间重构的货运需求预测模型，挖掘货运系统内部存在的规律性，该模 型框架如图 4-1 所示。

图 4-1 基于多元相空间重构的货运需求预测模型框架 Figure 4-1 Model framework of freight demand forecast based on multi-phase space reconstruction
从该模型的预测流程图 4-1 中可以看出，整个预测过程总体可以三个部分。
36

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

第一部分，构建铁路集装箱货运需求相关影响因素指标体系，一是利用定性 分析的方式整理影响因素，二是利用定量分析的方式选择关键因素建立指标体系。
第二部分，构建货运多元相空间。将铁路集装箱数据和相关因素构造为多元 时间序列，引入相空间重构理论求解重构参数，接着对每组重构后的时间序列进 行混沌特性识别，将具有混沌特征的时间序列重构为多元相空间矩阵。
第三部分，根据多元相空间矩阵确定输入输出结构以及训练测试集，训练预 测模型，得到预测结果。
4.2 构建货运需求指标体系
要想准确地预测铁路集装箱货运需求，就要对影响集装箱货运需求的相关因 素进行分析研究，采用定性和定量分析相结合的方式，保证货运需求指标体系建 立的科学完整性。
4.2.1 影响因素定性分析
影响铁路集装箱货运需求的因素繁多，总体可以归纳为宏观经济、物流市场 和工业发展情况这三个层面的影响因素。
（1）宏观经济 国家财政收入是指国家政府在一定时期内所取得的货币总和，是改善人民生 活质量和经济社会环境，维持社会秩序稳定和谐的物质基础，为经济社会发展提 供了财力经济的保障。财政收入关系着国家经济发展和社会进步，影响着国民经 济、社会生产力和居民消费意愿，进而影响着货物流通和货运需求。国民经济发 展影响着对外贸易，促进了经济交流合作，同样影响着货运需求。另外，经济的 发展也导致了我国产业结构的调整，某些原材料需要跨区域运输，同时工业转型 也促进了附加产品的生产，这导致货运需求明显增加[57]。 （2）物流市场 随着我国经济水平的不断增强，货运需求也在不断增加，同时物流行业的基 础设施也进一步完善，因此国内物流市场规模不断扩大。目前我国物流运输方式 主要包括公路、铁路、水路、民航和管道。时效性作为评价货物运输服务的一项 指标，客户对货物种类的需求不断增加，同时也加大对货物运输时效性的关注力 度。铁路运输适用于大宗货物的运输，其特点是运输量大，运输成本低，受环境 影响比较小，但是铁路运输的时效性低，作业时间长，货物在装卸的过程中有一 定的损耗，这导致一些货物的运输方式发生了调整。
37

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

公路运输因其较强的灵活性，成为了我国主要的货物运输方式[58]。我国公路

快速建设发展，提升了运输效率，缩短了区域间的距离，加快了人与货物之间的

流动速度，满足了不断增长的货运需求。公路运输相关企业注重信息化建设，有

助于及时向运营管理部门反馈物流信息，制定合理的指导决策，提升货物运输服

务水平。水路运输的一大特点是比较绿色环保，对生态环境污染小，国家目前正

在大力推进绿色运输，明确表示要将一些中长距离货物运输方式向水路转移。民

航运输虽然价格高，但是运输速度快，不受地形条件的限制，适用于对时间要求

比较高的货物。上述的这些运输方式协同发展，也存在着一定的竞争，对铁路运

输无疑是一种挑战。

（3）工业发展 我国各类能源资源丰富，但受地形地质等自然条件的影响，各类资源分布并

不均衡。煤炭在我国的储量较大，是我国铁路货运中运量最大的品类，煤炭在提

供能量的同时，也可以将煤作为原材料，加工为各类燃料加以利用。铁矿石在我

国各地均有分布，但主要集中在东北华北地区，铁矿用于冶炼钢铁，在国民生活

中发挥着重要作用，为国民经济发展提供了物资保障。国内铁矿一般就近运输，

很少跨省运输，主要采用铁路运输的方式。煤、矿石等原材料及工业和能源的主

要产品占据着货物运输的一大部分，因此其产量直接或间接影响着铁路货运需求。

本文通过从宏观经济、物流市场、工业发展三方面对集装箱货运需求的影响

因素进行定性分析，共选取 23 个具体的影响因素指标，如表 4-1 所示。

表 4-1 货运需求影响因素

类型

Table 4-1 Freight demand factors

序号

影响因素

单位

1

国家财政收入

亿元

2

社会消费零售总额

亿元

宏观经济

3

进出口总值当期值

亿元

4

进口总值当期值

亿元

5

出口总值当期值

亿元

1

公路货运量

万吨

物流运输

2

水路货运量

万吨

3

民航货运量

万吨

1

原煤

万吨

2 工业及能源主要产品
3

原油 天然气

万吨 亿立方米

4

焦炭

万吨

38

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

表 4-1（续） 货运需求影响因素

类型

Table 4-1 (continue) Freight demand factors

序号

影响因素

5

6

7

8

9

工业及能源主要产品

10

11

12

13

14

15

发电量 铁矿石原矿
磷矿石 金属制品
原盐 玻璃 成品糖 塑料 布 纱 化学品

单位 亿千瓦时
万吨 万吨 万吨 万吨 万平方米 万吨 万吨 亿米 万吨 万吨

4.2.2 影响因素定量分析
从理论上来说，在进行预测模型的实验过程中，模型输入的影响因素越多， 预测的准确性越高。但是在实际情况中铁路货运是一个十分复杂的系统，各种因 素指标对货运量产生的影响也不尽相同，有主次之分，有潜在明显之分等，同时 各种因素之间也会存在相互影响的情况。因此当选用过多的因素指标时，很有可 能会因为模型过于复杂而导致无法得到有效的预测结果，无法解决实际问题。因 此要对定性分析得到的影响因素进行筛选，选择对货运需求影响程度比较大的因 素，这样经过处理的影响因素才具有代表性。
分析影响程度的大小则需要一个量度，灰色关联分析法是灰色理论中一项重 要的研究内容，灰色关联度是指系统中的不同因素随时间或研究对象而变化的关 联程度，即关联性大小的量度。若两种因素之间的发展变化趋势较为相同，则两 者的关联度较高；若两种因素之间的发展变化趋势较为不同，则两者的关联度较 低。灰色关联分析非常适合对影响因素进行定量分析，对关联度进行排序。
灰色关联分析法有以下几个计算步骤： （1）确定待分析数列 待分析数列分为两类，一类是参考数列，另一类是比较数列。参考数列是指 能够反映整体系统行为特征的目标数列，即铁路集装箱货运需求。比较数列是指 能够计算与目标数列关联度的数列，即影响因素组成的数列。设 n 个比较数列组成 矩阵 X ' ，如表达式（4-1）所示。
39

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

X ' = (x1' , x2' ,

,

xn'

)

=

   

x1' (1) x1' (2)

 

x1'

(m)

x2' (1)

x

' 2

(2)

x2' (m)

xn' (1) xn' (2)

  



xn'

(m)

 

（4-1）

其中， m 为影响因素序列的长度，参考数列 x0' 如表达式（4-2）所示。 x0' = x0' (1), x0' (2), , x0' (m)

（4-2）

（2）原始数据无量纲化 在定性分析选择影响因素的过程中，会出现量纲不同的情况，例如万吨、亿 元等，如果此时不进行数据规范化处理，在计算过程中会难以进行比较或者产生 一定的误差，所以在计算关联度之前，要对原始数据进行无量纲化处理。本文选 择均值化方法，第 i 个比较数列的第 k 项指标 xi' (k) 无量纲后的数值 xi (k) 由公式 （4-3）计算所得。

 xi (k)

=

1 m

xi' (k)
m

,i

xi' (k)

k =1

=

0,1,

, n, k = 1, 2,

,m

（4-3）

规范化处理后，目标数列与参考数列一同构成矩阵 X 如式（4-4）所示。

X = (x1, x2 ,

 x1(1)

,

xn

)

=

  

x1 (2)

 

x1

(m)

x2 (1) x2 (2)
x2 (m)

xn (1) 

xn

(2)

 



xn

(m)

 

（4-4）

（3）分别计算目标序列与比较序列对应元素的绝对差值

利用差值大小作为关联度的衡量标准，计算 x0 (k) − xi (k) 的值，并确定两极的

最大差 max max

i

k

x0 (k) −

xi (k)

和最小差 min min ik

x0 (k) -

xi (k)

。

（4）计算关联系数和关联度

关联系数 i 是指铁路集装箱货运需求与影响因素在各个时刻点的关联程度， 由公式（4-5）计算得到，其中  为分辨系数。由于关联系数过于分散，为了方便

整体进行比较，采用求平均值法使信息集中，定量计算关联度，计算公式如（4-6）

所示。

i

=

min min ik

x0 (k)

−

xi (k)

x0 (k) − xi (k) + 

+



* max max

i

k

x0 (k) −

xi (k)

* max max

i

k

x0 (k)

−

xi (k)

,

=

0.5

 ri

=

1 m

m
i (k)
k =1

（4-5） （4-6）

40

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

4.3 算法设计

将混沌理论与货运预测相结合，若要获得货运系统各时间序列蕴含的信息， 就需要事先恢复原始的混沌货运系统，一般情况下，实现精准地恢复比较困难， 需要从另一角度间接地获取货运系统的内部信息，也就是进行相空间重构，在相 空间中进行混沌时间序列预测。根据 4.1 小节所构建的模型框架，接下来将详细地 介绍算法设计流程：
（1）由于本文要挖掘整个货运系统的内部信息，需要对待预测序列和经过灰 色关联分析得到的关键影响因素时间序列分别进行相空间重构，映射到高维相空 间，恢复出原始的货运系统特征。设待预测序列为 X1 = {x1(1), x1(2), , x1(N )} ，第 i
个影响因素序列为 Xi = xi (1), xi (2), , xi (N) ， i = 2,3, , K +1 ，其中 N 为时间序
列的长度， K 为影响因素序列的个数。第 i 个货运序列重构后得到的相空间如式 （4-7）所示。

X i1 =  xi,1, xi,1+i , xi,1+2i , X i2 =  xi,2 , xi,2+i , xi,2+2i ,

, x  i,1+(mi −1)i , x  i,2+(mi −1)i

（4-7）

X iMi =  xi,Mi , xi,Mi +i , xi,Mi +2i , , x  i,Mi +(mi −1)i

其中， i 表示的是第 i 个货运序列的时间延迟， mi 表示的是第 i 个货运序列的嵌入 维数， Mi 表示的是第 i 个货运序列重构后的相空间维数， Mi = N − (mi −1)i 。
（2）构建多元相空间之前，需要对各货运序列进行混沌特性的识别，如果多 元相空间中存在不具备混沌特征的货运序列，会导致无法从相空间中恢复出混沌
吸引子。利用小数据量法计算最大雅普诺夫指数，第 i 个货运时间序列重构后得到 的相空间{X ij} ， j = 1, 2, , Mi ，找到每个相空间点 Xij 的最近邻点 X ij' ，表达式如 （4-8）所示。

dij (0) = min X ij − X ij' , j − j'  Pi

（4-8）

其中， Pi 为第 i 个货运时间序列经过快速傅里叶变换得到的平均周期。这样，就可 以通过找到每个相空间点的最近邻点，计算其平均发散速率的估计值得到最大 Lyapunov 指数，公式如（4-9）所示。

 i

(k)

=

1 kt

1 (M −

k)

M −k j

ln

dij (k) dij (0)

（4-9）

其中，dij (k) 表示的是第 i 个序列重构后得到的第 j 个相空间点的邻近点在经过 k 个

离散时间步长后与最近邻点之间的距离。设

X ij

与

X

' ij

的指数发散率均为

i

，表达

41

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

式如（4-10）所示

dij (k) = dij (0)ei (kt)

（4-10）

对式（4-10）两边取对数，得到表达式（4-11），从式（4-11）中可以看出 k 与 ln dij (k) 之间呈线性关系，固定 k 不变，对每个 j 所对应的 ln dij (k) 求平均值，表达 式如（4-12）所示。

ln dij (k) = ln Cij + ikt,Cij = dij (0)

（4-11）

 1 qi

yi (k) =

qi t

ln dij (k)
j =1

（4-12）

其中， qi 表示的是 dij (k ) 的个数， qi  0 。利用最小二乘法拟合直线，这组直线的 斜率即为最大 Lyapunov 指数，计算公式如（4-13）所示。

 k  y i (k) − yi  k

  i = k

k
k2 −k k

k

k

（4-13）

其中， k 和 yi 的计算公式如（4-14）所示。

k

=

1 n


k

k

 

 

yi

=

1 n

k

yi (k)

（4-14）

最大 Lyapunov 指数分为两种情况，若 i  0 ，则说明第 i 个货运时间序列不存 在混沌特性，需要在之后的预测模型中剔除掉；若 i  0 ，则说明第 i 个货运时间 序列存在混沌特性，混沌识别为之后在多元相空间中建立混沌预测模型奠定了基
础。
（3）经过混沌特性识别，具备混沌特性的货运时间序列为 X1, X 2, X S ，其中
Xi = xi (1), xi (2), , xi (N) ， i = 1, 2, , S ， S 为具备混沌特性的货运序列个数。每
个货运序列重构后简化表示为式（4-15），多个货运序列构建的多元相空间表示为 式（4-16）。

Xi (t) = xi (t), xi (t −i ), , xi (t − (mi −1)i )

X (t) = X1(t), X2 (t), , X S (t)

其中，

t

=

 max
1i  S

(mi

− 1) i 

+1,

, N −1, N 。

货运多元相空间也可以展开表示为式（4-17）。

（4-15） （4-16）

42

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型



x (t) 1

x (t − )

1

1

 

x 1

(t

+

1)

x (t +1− )

1

1







x (N) 1

x (N − )

1

1

x (t − (m −1) )

1

1

1

x (t +1− (m −1) )

1

1

1

x (N − (m −1) )

1

1

1

x (t) x (t − )

S

S

S

x (t +1) x (t +1− )

S

S

S

x (N) x (N − )

S

S

S

x (t − (m −1) )

S

S

S



x S

(t

+

1

−

(m S

−1)

S

)



x (N S

−

(m S

−1) ) S

 

（4-17）

（4）货运多元相空间揭示了货运系统复杂的运动特性，并发现了货运系统中 存在着一种确定的规律性，这种规律性表现在相空间中不同时间延迟下各序列的 相关性，使得货运系统看似存在着一种记忆能力，利用一般传统的方法很难将这 种规律性解析出来。
神经网络是一类模拟生物神经细胞运作模式的机器学习技术，目前广泛应用 在预测、语音识别[59]、目标检测[60]等多种领域，神经网络是以数学表达式的方式 建立起神经元之间的连接，可以构建复杂关系模型并且具备良好的学习能力，这 种非线性拟合的信息处理能力，可以与混沌理论很好地结合起来。
本文选用在预测领域表现比较好的三种神经网络，分别是径向基（Radical Basis Function，RBF）神经网络，Elman 神经网络以及小波神经网络（Wavelet Neural Network，WNN），这三种神经网络均是从传统的神经网络发展而来，接下来将分 别介绍各自的优点及网络结构，以便后续构建预测模型进行预测实验。
为了方便表示，统一设样本输入为 U (i) ，样本输出为 O(i) ， i = 1, 2, , L ， U (i) = {u1(i),u2 (i), ,uD (i)} ，其中 L 为样本个数，即货运序列的长度， D 为输入层 神经元个数，设隐含层神经元个数为 h ，隐含层节点与输入层节点之间的连接权重 为 w1j = {w1j1, w1j2, , w1jD} ， 隐 含 层 节 点 与 输 出 层 节 点 之 间 的 连 接 权 重 为 w2j ， j = 1, 2, , h 。输入到模型中的货运数据均经过了最大最小归一化处理，加快模型 的收敛和学习速度。
（1）RBF 神经网络 RBF 神经网络属于前馈网络，网络结构一共有三层，分别是输入层，隐含层 和输出层，隐含层的激活函数是径向基函数。输入层只起到传输的作用，隐含层 将低维的数据映射到高维空间，隐含层与输出层的关系是线性的，网络的输出是 将隐含层的值通过线性加权得到的。RBF 神经网络的结构使其具有能够逼近任意 非线性函数的能力，而且收敛速度快，泛化能力强。RBF 的网络结构如图 4-2 所 示。 Rj 为隐含层第 j 个神经元的输出，选用高斯函数作为激活函数，具体的计算 公式为式（4-18），其中 cj 表示的是隐含层第 j 个神经元的径向基中心， j 表示的 是隐含层第 j 个神经元的径向基方差。输入第 k 组样本得到的货运需求 O(k) 与隐含 层 Rj 的关系表示为式（4-19）。

43

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

2

Rj (U (i), c j )

= exp(−

U (i) − cj 2 j2

), j = 1, 2,

h

h
 O(k) = w2j Rj (U (k), cj ) j =1

（4-18） （4-19）

图 4-2 RBF 神经网络
Figure 4-2 The structure of RBF neural network
RBF 神经网络需要学习的参数一共有三个，分别是径向基中心、径向基方差 和隐含层到输出层连接的权值。本文选用自组织选取中心法学习参数，学习过程 如图 4-3 所示。自组织选取中心法总共分为两部分，第一部分属于无监督学习，计 算径向基中心和方差，第二部分属于有监督学习，计算连接权值。

图 4-3 自组织选取中心法流程 Figure 4-3 Self-organized selection center method process
利用 K 均值聚类方法求径向基中心，首先选取 h 个训练样本作为初始聚类中 心 cj ， j = 1, 2, , h ，其次将样本数据依据最近邻规则聚类，即根据U (i) 与聚类中 心 cj 之间的欧氏距离归入聚类集合i ，最后调整聚类中心，计算每个聚类集合i 的 均值，获得新的聚类中心，重复计算直到聚类中心不再变化。利用公式（4-20）求 出径向基方差，其中 cmax 为径向基中心距离的最大值。
44

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

i

=

cmax 2h

（4-20）

输入层与隐含层之间的连接权重为 1，所以只需要学习隐含层与输出层之间的 连接权重，利用最小二乘法来计算，公式如（4-21）。

w

=

exp(

h c2
max

U (i) − c j

)

（4-21）

（2）Elman 神经网络 Elman 神经网络是一种动态回归神经网络，与传统 BP 三层网络结构相比多了 一个承接层，属于前馈型网络[61]。Elman 网络结构如图 4-4 所示。Elman 网络之所 以具备记忆和适应时间变化的能力，是因为加入了承接层。承接层的作用是用来 存储隐含层上一时刻的输出，接着与下一时刻的输入数据一并输入到隐含层，这 种结构使 Elman 网络对历史数据的敏感性更高，有利于时间序列的预测。

图 4-4 Elman 神经网络 Figure 4-4 The structure of Elman neural network
Elman 神经网络各层的表达式如下： O(i) = f (w2 X (i))
X (i) = g(wc X c (i) + w1U (i −1)) X c (i) = X (i −1)

（4-22） （4-23） （4-24）

其中，X 表示的是隐含层向量，X c 表示的是承接层向量，wc 为承接层到隐含层之 间连接权重， f 和 g 分别是输出层和隐含层的传递函数， g 取线性函数。Elman 神 经网络采用梯度下降算法调整权重，直到预测值与真实值的误差达到了设定的精 度或最大训练次数，定义 Elman 误差函数为式（4-25）。

L
E =  (O(i) − Oˆ (i))2 i =1

（4-25）

其中， Oˆ (i) 为第 i 组样本所对应的实际货运需求。Elman 神经网络的训练过程如图

45

北京交通大学硕士学位论文
4-5 所示。

基于多元相空间重构的货运需求预测模型

图 4-5 Elman 神经网络训练过程
Figure 4-5 Elman neural network training process
（3）小波神经网络 小波神经网络（Wavelet Neural Network，WNN）是一种前馈型神经网络，由 于结合了小波理论，WNN 既具备收敛速度快的特点，又有时域局部特性[62]。小波 理论与神经网络的结合方式有两种，本文采用的是紧密型，隐含层的激活函数采 用的是 Morlet 小波函数，小波函数中的两个参数使得 WNN 在逼近非线性序列的 能力方面更加灵活。WNN 网络结构如图 4-6 所示。

图 4-6 WNN 神经网络

Figure 4-6 The structure of WNN neural network

Z j 为隐含层第 j 个神经元的输出，隐含层 Z j 在输入第 k 组样本时的输出为式 （4-26），其中 为 Morlet 小波函数，定义为式（4-27），a j 和 bj 分别是隐含层第 j 个神经元中小波基函数的伸缩和平移参数。输入第 k 组样本得到的货运需求 O(k)

与隐含层 Z j 的关系表达式为式（4-28）。

Zj

=

( w1jU (k) aj

− bj

)

（4-26）

46

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

(x) = cos(1.75x)exp(− x2 ) 2
h
 O(k) = w2j Z ( j) j =1

（4-27） （4-28）

WNN 神经网络中连接权重和小波函数参数的更新方法同 Elman，均采用梯度 下降算法，WNN 网络误差定义同式（4-25）。WNN 神经网络的训练过程如图 4-7 所示。

图 4-7 WNN 神经网络训练过程
Figure 4-7 WNN neural network training process
神经网络的输入输出结构由已构建的货运多元相空间，即式（4-17）来确定， 相空间点 X (t) 作为输入，输入集如式（4-29），x1(t +1) 作为输出，输出集如式（4-30）， 确定输入输出集的结构后，利用训练集对神经网络进行训练，将测试集输入到训 练好的网络得到最终的预测结果。



x (t) 1

x (t − )

1

1

 

x 1

(t

+

1)

x (t +1− )

1

1







x 1

(

N

−

1)

x (N −1− )

1

1

x (t − (m −1) )

1

1

1

x (t +1− (m −1) )

1

1

1

x (N −1− (m −1) )

1

1

1

x (t) x (t − )

S

S

S

x (t +1) x (t +1− )

S

S

S

x (N −1) x (N −1− )

S

S

S

x (t − (m −1) )

S

S

S



x S

(t

+

1

−

(m S

−

1)

S

)

 

（4-29）



x S

(N

−1

−

(m S

−1)

S

)



x 1

(t

+

1)



 

x 1

(t

+

2)







x (N) 1



（4-30）

综上，基于多元相空间重构的货运需求预测模型的算法流程如图 4-8 所示。

47

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

图 4-8 基于多元相空间重构的货运需求预测模型算法流程图 Figure 4-8 Algorithm flow of freight demand forecasting model
based on multi-phase space reconstruction
4.4 预测实验及结果分析
为了验证基于多元相空间重构的货运需求预测模型的有效性，本章节将根据 上文设计的模型框架以及算法流程在现有的数据集上构建预测模型进行实验，并 与其他预测方法进行对比分析，总结此模型的特点和优势。
4.4.1 实验数据
根据 4.2.1 小节对货运需求影响因素定性分析的情况，收集相关实验数据，数 据来源于国家统计局月度数据，时间跨度为 2007 年 1 月至 2018 年 3 月，其中化 学品产量为统计数据中硫酸、烧碱、纯碱、乙烯和化学农药原药产量总和，玻璃
48

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

产量为统计数据中钢化玻璃、夹层玻璃和中空玻璃产量总和，金属制品为生铁、 粗钢、钢材等 16 种工业主要产品的产量总和，定性分析所得到的影响因素具体数 据如表 4-2 所示。另外，本章实验数据选取 2007 年 1 月至 2018 年 3 月的全国集装 箱装箱数月度数据作为研究对象，其中 2007 年 1 月至 2017 年 3 月的数据用于建 立预测模型，2017 年 4 月至 2018 年 3 月的数据用于模型检验，即用所建立的模型 进行预测。

表 4-2 影响因素实验数据

Table 4-2 Experimental data of influencing factors

指标

2018.03 2018.02

⋯⋯

2007.02 2007.01

国家财政收入(亿元)

13993

12932.3

⋯⋯

3045.5

5196

社会消费品零售总额(亿元) 29193.6 30540.9

⋯⋯

7013.7

7488.3

进出口总值(亿元)

353225743 309481182 ⋯⋯ 140434953 157358930

出口总值(亿元)

174121483 171616391 ⋯⋯

82095593 86619731

进口总值(亿元)

179104260 137864792 ⋯⋯

58339361 70739199

公路货运量(万吨)

306352

167206

⋯⋯

113236

126400

水路货运量(万吨)

51215

46587

⋯⋯

17837

19500

民航货运量(万吨)

62

46

⋯⋯

24

29

原煤(万吨)

29022

51628

⋯⋯

14203.23 17479.01

原油(万吨)

1595.6 1518.75

⋯⋯

1434.1

1609.4

天然气(亿立方米)

135.2

135.65

⋯⋯

58

58.1

焦炭(万吨)

3557.4

3365.5

⋯⋯

2288.9

2403.8

发电量(亿千瓦时)

5283.4 5227.25

⋯⋯

1967.3

2512.4

铁矿石原矿(万吨)

6688.5 8805.45

⋯⋯

4221.4

5156.15

磷矿石(万吨)

890.9

1089.45

⋯⋯

216.5

349.65

金属制品(万吨)

27957.6 25524.5

⋯⋯

12928.5 13617.5

原盐(万吨)

364.2

289.3

⋯⋯

243.5

284.6

玻璃(万平方米)

5546.1

4710.5

⋯⋯

786.6

996.6

成品糖(万吨)

317.2

285.9

⋯⋯

225.8

270.7

塑料(万吨)

1309.7 1357.65

⋯⋯

454.3

499.3

布(亿米)

51.5

43.85

⋯⋯

29.2

35.1

纱(万吨)

295.8

265.95

⋯⋯

115.9

144.2

化学品(万吨)

1405.7

1356.1

⋯⋯

756

743.7

利用 4.2.2 小节所介绍的灰色关联法选择对铁路集装箱货运需求影响较大具有 代表性的影响因素，按照关联度进行排序，值越大，说明两者关系越密切，各影

49

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

响因素的关联度大小如表 4-3 所示，选择关联度大于 0.85 的影响因素作为后续预 测模型的输入变量，即国家财政收入、进出口总值当期值、进口总值当期值、出

口总值当期值、公路货运量、水路货运量、民航货运量、原煤等 19 个指标。

表 4-3 铁路集装箱货运需求相关影响因素及其关联度

Table 4-3 Factors and correlations related to the demand for railway container freight

影响因素

关联度

影响因素

关联度

国家财政收入

0.85541

天然气

0.897823

社会消费零售总额

0.850441

焦炭

0.896775

进出口总值当期值

0.901549

发电量

0.914098

进口总值当期值

0.898285

铁矿石原矿

0.885211

出口总值当期值

0.893013

磷矿石

0.845525

公路货运量

0.896158

金属制品

0.905233

水路货运量

0.893453

原盐

0.810956

民航货运量

0.916517

玻璃

0.816812

原煤

0.897778

成品糖

0.601112

原油

0.873576

塑料

0.898112

布

0.895481

纱

0.90215

化学品

0.91311

-

-

4.4.2 构建多元相空间
嵌入维数和时间延迟是构建多元相空间的关键参数，实验采用第二章所描述 的 C-C 算法求解Y , X1, X 2, , X19 每个货运序列的相空间参数，其中Y 为待预测的 货运集装箱装箱数序列， X1, X 2 , , X19 为货运需求影响因素序列，各货运序列的 重构参数确定情况如图 4-9 所示。根据图 4-9 确定各货运序列的时间延迟和时间窗 口，进而求出嵌入维数，计算得到各货运序列的相空间重构参数结果如表 4-4 所示。
在利用基于多元相空间重构的货运需求预测模型进行预测之前，需要对各货 运序列进行混沌特性的识别，如果不存在混沌特性，则对应的货运序列需要在模 型中被剔除掉。采用 4.3 小节所描述的小数据量法来计算最大 Lyapunov 指数，判 断这 20 组货运序列是否具有混沌性，最大 Lyapunov 指数计算结果如表 4-5 所示， 其中 X15 和 X19 这两组货运序列的最大 Lyapunov 指数均小于 0，即金属制品和化学 品产量当期值不具备混沌性。

50

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

表 4-4 各货运序列相空间重构参数 Table 4-4 Phase space reconstruction parameters of each freight sequence

时间序列 嵌入维数 m

时间延迟 时间序列 嵌入维数 m

时间延迟

Y

3

X 1

2

X 2

2

X 3

2

X 4

2

X 5

2

3

X 10

2

3

6

X 11

2

2

6

X 12

2

4

3

X 13

2

6

3

X 14

2

3

4

X 15

2

14

X 6

2

13

X 16

2

13

X 7

2

15

X 17

2

2

X 8

2

13

X 18

2

6

X 9

2

4

X 19

3

6

表 4-5 各货运序列最大 Lyapunov 指数

Table 4-5 The largest Lyapunov exponents of each freight sequence

时间序列

最大 Lyapunov 指数

时间序列

最大 Lyapunov 指数

Y

0.0180

X 10

0.0291

X 1

0.0026

X 11

0.0112

X 2

0.0040

X 12

0.0359

X 3

0.0107

X 13

0.0048

X 4

0.0060

X 14

0.0112

X 5

0.0039

X 15

-0.0062

X 6

0.0083

X 16

0.0080

X 7

0.0047

X 17

0.0415

X 8

0.0082

X 18

0.0022

X 9

0.0262

X 19

-0.0048

经过混沌特性识别之后，根据式（4-17）构建货运多元相空间如式（4-31）所

示，各组货运序列重构相空间的嵌入维数总和为 37，根据式（4-29）和式（4-30）

得到预测模型的输入输出结构如表 4-6 所示。

 y(16)

 

y(17)



 

y(135)

y(13) y(14)
y(132)

y(10) y(11)
y(129)

x1(16) x1(17)
x1(135)

x1(10) x1(11)
x1(129)

x17 (16) x17 (17)
x17 (135)

x17 (10) 

x17 (11)

 

（4-31）



x17

(129)

 

51

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

图 4-9 各货运序列重构参数确定图 Figure 4-9 Diagram of determining the reconstruction parameters of each freight sequence

表 4-6 预测模型的输入和输出

Table 4-6 The input and output sets of the prediction model

输入

输出

 y(16), y(13), y(10), x1 (16), x1 (10),  , x17 (16), x17 (10)  y(17), y(14), y(11), x1 (17), x1 (11),  , x17 (17), x17 (11)

y (17) y (18)

 y(134), y(131), y(128), x1(134), x1(128), , x17 (134), x17 (128)

y (135)

4.4.3 预测结果及分析
根据 4.3 小节所描述的算法设计流程，分别构建多元相空间重构和 RBF、 Elman、WNN 的货运需求预测模型，具体实验内容如下：

52

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

（1）基于多元相空间重构和 RBF 的货运需求预测模型 根据 4.4.2 小节所构建的货运多元相空间确定 RBF 神经网络的输入层神经元个 数为 37，由于是单步预测，输出层神经元个数为 1，隐含层神经元个数根据经验 公式 k = n + m + a 进行计算，其中 n 和 m 分别是输入层和输出层的神经元个数，a 取 1 至 10 以内的常数，则 7  k 16 ，经过多次试验，k 取 10，此时误差最小。本 实验预测结果和单一 RBF 模型的预测结果如图 4-10 所示。

图 4-10 集装箱装箱数月度数据预测结果

Figure 4-10 Forecast results of monthly data on the number of containers loaded
从图 4-10 中可以看出，对于集装箱装箱数月度数据，两种模型的预测结果都 能较好地拟合发展趋势，但基于多元相空间重构和 RBF 的预测模型的拟合效果更 好，泛化能力更强，预测精度更高，为了更加具体直观地比较两种预测模型的拟

合程度，计算两种预测模型的相对误差，如表 4-7 所示。

表 4-7 预测误差分析

序号
1 2 3 4 5 6 7 8 9 10 11 12

Table 4-7 Error analysis of prediction results 相对误差(%)
基于多元相空间重构和 RBF 预测模型 3.6370 3.2947 1.3886 3.4040 3.2883 1.8758 2.0767 2.7089 4.4758 3.7983 2.3398 4.0416

RBF 预测模型 5.5691 7.9648 0.7188 4.2269 5.6571 6.7781 4.7844 5.6425 8.4670 6.0497 7.9055 12.3515

53

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

从表 4-7 中可以看出，尽管后四个月的货运数据突增，本文提出的预测模型整 体的相对误差仍可以控制在 5%以内，而且只有在预测第三个月集装箱数据时，基 于多元相空间重构和 RBF 的预测结果的相对误差略高于单一 RBF 预测结果，两种 模型预测评价指标结果如表 4-8 所示。

表 4-8 模型预测评价指标

Table 4-8 Evaluation index for prediction model

模型

相对误差(%)

相对误差

最大绝对 最小绝对 平方和均方根 RMSE MAPE

基于多元相空间重构和 RBF 4.4758

1.3886

0.0360 21425.36 0.0303

RBF

12.3515 0.7188

0.0689 50297.96 0.0634

从表 4-8 中可以看出，基于多元相空间重构和 RBF 的预测模型在最大相对误 差和最小相对误差方面均优于单一的 RBF 预测模型，相对误差平方和均方根降低 了 3.29%，MAPE 降低了 3.31%，RMSE 降低了 28872.6，说明此模型预测效果更 好，可以明显提高预测精度。

（2）基于多元相空间重构和 Elman 的货运需求预测模型 Elman 神经网络的输入层神经元个数为 37，输出层神经元个数为 1，隐含层神 经元个数经试算确定为 16，激活函数取 sigmoid 函数。设最大迭代次数为 10000， 学习速率为 0.01，训练目标最小误差为 0.001，本实验预测结果和单一 Elman 模型 的预测结果如图 4-11 所示。

图 4-11 集装箱装箱数月度数据预测结果 Figure 4-11 Forecast results of monthly data on the number of containers loaded
从图 4-11 中可以看出，对于集装箱装箱数月度数据，基于多元相空间重构和 Elman 的预测模型的拟合效果更好，但是在预测后四个月时，两种预测模型的预测 结果与真实值均有较大的偏差，为了更加具体直观地比较两种预测模型的拟合程 度，计算两种预测模型的相对误差，如表 4-9 所示。
54

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

表 4-9 预测误差分析

序号
1 2 3 4 5 6 7 8 9 10 11 12

Table 4-9 Error analysis of prediction results

相对误差(%)

基于多元相空间重构和 Elman 预测模型

Elman 预测模型

3.8185

7.3032

2.1611

2.2493

3.5327

8.4623

2.7919

1.1922

0.8582

6.5791

1.9526

9.2852

1.3321

0.2193

7.9233

5.8115

7.8138

12.0200

8.98552

10.9123

9.7201

5.5771

10.9632

13.2451

从表 4-9 中可以看出，在前 11 个月的预测过程中，基于多元相空间重构和 Elman 的预测相对误差均可以控制在 10%以内，虽然此模型在后期的预测过程中， 预测精度仍优于单一的 Elman 预测模型，但对比前期预测结果，预测精度有所下 降，说明此模型还是比较适合短期预测，两种模型预测评价指标结果如表 4-10 所 示。

表 4-10 模型预测评价指标

Table 4-10 Evaluation index for prediction model

模型

相对误差(%)

相对误差

最大绝对 最小绝对 平方和均方根 RMSE MAPE

基于多元相空间重构和 Elman 10.9632 0.8582

0.0623 49225.91 0.0515

Elman

13.2451 0.2193

0.0798 59592.22 0.0690

从表 4-10 中可以看出，基于多元相空间重构和 Elman 的预测模型虽然在最小 相对误差方面略低于单一的 Elman 预测模型，但在其他预测评价指标方面均优于 单一的 Elman 预测模型，相对误差平方和均方根降低了 1.75%，MAPE 降低了 1.75%，RMSE 降低了 10366.31，尽管提升幅度并不高，但相比而言，此模型预测 效果更好，可以在一定程度上提高预测精度。

（3）基于多元相空间重构和 WNN 的货运需求预测模型 WNN 神经网络的输入层神经元个数为 37，输出层神经元个数为 1，隐含层神 经元个数经试算确定为 14，激活函数取 Morlet 小波基函数。设最大迭代次数为 1000，连接权重和小波函数参数的学习速率分别设为 0.01 和 0.001。本实验预测结

55

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

果和单一 WNN 模型的预测结果如图 4-12 所示。

图 4-12 集装箱装箱数月度数据预测结果

Figure 4-12 Forecast results of monthly data on the number of containers loaded
从图 4-12 中可以看出，对于集装箱装箱数月度数据，基于多元相空间重构和 WNN 的预测模型的拟合效果更好，尽管此模型在前期的预测过程中有一定的偏 差，但还是基本顺应了实际的变化趋势，而单一 WNN 预测模型在预测前八个月的 集装箱数据时，波动比较大，预测精度不高，为了更加具体直观地比较两种预测

模型的拟合程度，计算两种预测模型的相对误差，如表 4-11 所示。

表 4-11 预测误差分析

序号

Table 4-11 Error analysis of prediction results

相对误差(%)

基于多元相空间重构和 WNN 预测模型

WNN 预测模型

1

2.3250

2

1.6341

3

4.7338

4

3.1069

5

7.5058

6

8.0126

7

8.8756

8

3.8393

9

5.9746

10

1.5530

11

6.0457

12

7.2830

1.8882 5.4968 7.6079 8.6028 6.0879 8.1116 2.1263 9.0114 12.1971 8.9445 4.2602 13.0497

从表 4-11 中可以看出，基于多元相空间重构和 WNN 的预测相对误差均可以 控制在 10%以内，在面对第九和第十个月突增的数据，相对误差仅为 5.9746%和 1.5530%，低于单一的 WNN 预测模型，两种模型预测评价指标结果如表 4-12 所示。

56

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

表 4-12 模型预测评价指标

Table 4-12 Evaluation index for prediction model

模型

相对误差(%)

相对误差

最大绝对 最小绝对 平方和均方根

基于多元相空间重构和 WNN 8.8756

1.5530

0.0564

WNN

13.0497 1.8882

0.0802

RMSE
35409.74 57817.83

MAPE
0.0507 0.0728

从表 4-12 中可以看出，基于多元相空间重构和 WNN 的预测模型在最大相对 误差和最小相对误差方面均优于单一的 WNN 预测模型，相对误差平方和均方根降 低了 2.38%，MAPE 降低了 2.21%，RMSE 降低了 22408.09，说明此模型预测效果 更好，可以提高预测精度。

本文另外选择了 Stepwise Regression，Lasso Regression，SVR 和 GM(1,N)四种 预测模型进行预测结果的对比分析，四种预测模型预测结果如图 4-13 所示。

图 4-13 四种预测模型结果对比 Figure 4-13 Comparison of the results of four prediction models
从图 4-13 中可以看出，GM(1,N)和 Lasso Regression 两种预测模型的预测误差 较小，在前期的预测过程中，GM(1,N)预测模型除了在第二和第三个月突然出现较 大的预测偏差，其他预测结果均比较贴近原始数据，拟合效果较好。在后期的预 测过程中，Lasso Regression 预测模型的预测结果比较贴近原始数据，计算四种模 型预测评价指标，结果如表 4-13 所示。
57

北京交通大学硕士学位论文

基于多元相空间重构的货运需求预测模型

表 4-13 模型预测评价指标

模型

Table 4-13 Evaluation index for prediction model

相对误差(%)

最大绝对

最小绝对

相对误差 平方和均方根

RMSE

MAPE

Stepwise Regression Lasso Regression SVR GM(1,N)

20.2812 14.6786 14.9473 13.3069

1.7469 3.0221 0.6722 0.3781

0.1210 0.0820 0.0882 0.0810

88937.34 0.1036 62263.72 0.0735 65769.71 0.0775 57954.81 0.0663

综合以上预测实验结果，可以得到以下结论：

（1）多元相空间重构和 RBF、Elman、WNN 的预测模型的预测结果均优于单 一的 RBF、Elman、WNN 预测模型，其中基于多元相空间重构和 RBF 的预测模型 只有在最小相对误差方面略高于基于多元相空间重构和 Elman 的预测模型，在其 他的预测评价指标方面均达到最优。

（2）从表 4-13 中可以看出，GM(1,N)预测模型在各种评价指标方面均优于 Stepwise Regression、Lasso Regression、SVR 这三种预测模型，基于多元相空间重 构的货运需求预测模型虽然在最小相对误差方面均高于 GM(1,N)预测模型，但是 在相对误差平方和均方根方面至少降低了 1.87%，MAPE 方面至少降低了 1.48%， RMSE 方面至少降低了 8728.9，这说明本文提出的基于多元相空间重构的货运需 求预测模型可以更好地挖掘铁路货运系统中的确定性复杂规律，相对完整的信息

利于模型训练，从而提高预测精度，满足实际需求。

4.5 本章小结
本章针对月度的集装箱装箱数这类受各种复杂因素影响的时间序列，提出了 基于多元相空间重构的铁路货运需求预测模型。首先，介绍了预测模型的框架和 详细的算法设计流程，并从宏观经济、物流市场、工业发展三个方面分析影响月 度货运需求的相关因素，通过灰色关联分析选择关联度高的影响因素。其次，将 月度集装箱装箱数和对应的影响因素进行相空间重构，并进行混沌特性识别，形 成最终的货运多元相空间。最后，将多元相空间与多种神经网络预测模型进行组 合，并与单一的神经网络预测模型，传统的回归预测模型等进行对比，最终证明 了本章提出的基于多元相空间重构的货运需求预测模型的有效性，对于复杂的货 运需求预测精度更高。

58

北京交通大学硕士学位论文

总结与展望

5 总结与展望
5.1 总结
铁路货运量是铁路运输中格外关注的一项，尤其是近年来国家政策“公转铁” 的提出，铁路各部门积极配合为新政策做好服务，让铁路运输量大幅提升，与此 同时，复杂的铁路货运市场也给铁路管理部门带来了巨大挑战，铁路基础建设如 何投资，货运服务质量如何提升等，准确的货运需求预测成为了目前亟待解决的 问题，本文将针对这一问题完成的研究工作内容和创新总结如下：
（1）介绍了铁路货运预测的研究背景，调研并总结了 2012 年以来铁路货物 运输的发展情况，阐述了货运预测的研究意义，并对目前国内外学者关于货运预 测技术的研究成果进行整理总结。目前的货运预测技术主要有时间序列预测法， 灰色预测法，神经网络预测法，组合预测法，粗糙集理论预测法等，对于主流的 预测方法分别对其优缺点进行了分析，并根据研究思路的不同将预测方法归纳为 两类，一类为不考虑影响因素，另一类为考虑影响因素，关于这两类预测方法的 研究虽然取得了一定的进展，但仍存在一些可以改进的地方，例如在目前的货运 预测技术研究当中，忽略了货运系统中看似杂乱无章，实则存在的内部规律，而 这些蕴含的信息对货运预测具有重要的意义。本文对混沌时间序列预测技术进行 调研发现，在交通、电力等领域，混沌时间序列预测技术可以通过相空间重构获 得系统全面的演变规律。因此，本文将混沌理论与铁路货运领域相结合，提出了 基于单元和多元相空间重构的货运需求预测模型。
（2）介绍了基于单元相空间重构的货运需求预测模型的设计实现过程。面对 利用历史数据拟合未来发展趋势的局限性和主观性，引入分解集成的思想来减小 预测误差，通过 VMD 算法将集装箱装箱数周度数据进行分解，选择合适的分解个 数，充分提取序列的特征，分解得到的低频模态更容易表现出原始序列波动的趋 势，ARIMA 模型适合预测这类具有线性趋势的序列，而分解得到的高频模态呈现 非线性，SVR 模型可以更好地捕捉这类特征。为了构建 SVR 模型的输入输出集， 引入了混沌理论，利用传统 C-C 法求得相空间重构参数，构建相空间以获取高频 序列中隐含的信息，为预测提供新的有效信息。传统 C-C 法对一段时间序列直接 求参有一定的波动性，因此尝试分段处理取平均的方法来解决这一问题。为了得 到 SVR 模型的最佳参数，利用 PSO 算法进行优化。最后将本文提出的预测模型与 单一的预测模型进行实验对比分析，证明了本文提出的预测模型的有效性，在预
59

北京交通大学硕士学位论文

总结与展望

测精度方面有一定的提高。 （3）介绍了基于多元相空间重构的货运需求预测模型的设计实现过程。复杂
多变的影响因素的影响最终都体现在货运时间序列中，传统的预测模型对于货运 系统内部相互作用的分析是不足的，因此创新性引入了混沌理论，提取内部动态 信息输入到预测模型中。首先总结了目前影响货运需求的各种因素，数据来源于 国家统计局，通过灰色关联分析建立了关键指标体系。其次计算最大 Lyapunov 指 数进行混沌特性识别，构建货运多元相空间。最后将多元相空间与 RBF 等多种神 经网络相结合构建预测模型。最后实验证明，本文提出的预测模型相比于传统的 预测模型，预测精度得到了提升。
5.2 展望
本文将混沌理论引入了铁路货运预测领域中，研究结果表明，本文提出的预 测模型预测性能有所提升，但仍存在一些不足之处，还需要更进一步的展开研究。 下面为可以继续完善的工作内容：
（1）本文主要是研究混沌时间序列预测，着重在相空间重构方面，对于预测 模型的参数选择有待进一步优化，在今后的研究过程中，可以考虑改进神经网络 结构或利用多种参数优化算法，降低运算难度同时提高预测精度。
（2）尝试将混沌理论与其他预测方法结合，利用不同预测方法的优点，扩大 混沌理论的应用范围。
（3）利用 VMD 算法分解得到的多种模态，目前只是区分为高频和低频，之 后可以更细化，发掘不同的特征，选择合适的模型分别进行预测。
以上问题都值得深入研究，进一步完善货运预测技术，为铁路运输领域提供 有效的参考信息。

60

北京交通大学硕士学位论文

参考文献

参考文献
[1] 李银冰. 我国铁路货运现状及发展方向研究[J]. 智能城市, 2019, 5(21):133-134. [2] 刘丽. 基于深化改革背景下的铁路货运发展策略阐述[J]. 山东工业技术, 2019(7):226. [3] 覃娜, 张坚. “一带一路”倡议下我国国际铁路货物联运探析[J]. 对外经贸, 2017(9):30-32. [4] 林婉婷. “公转铁”形势下铁路货运市场发展探讨[J]. 铁道货运, 2019, 37(8):44-48. [5] 杨海民, 潘志松, 白玮. 时间序列预测方法综述[J]. 计算机科学, 2019, 46(1):21-28. [6] 汤银英, 李龙. 基于 Holt-Winters 模型的铁路月度货运量预测研究[J]. 交通运输工程与信
息学报, 2017, 15(2):1-5+13. [7] 张立欣, 张艳波, 杨翠芳. 基于 X11-ARIMA 模型的铁路货运周转量分析[J]. 数学的实践
与认识, 2018, 48(17):154-161. [8] 胡 洁 琼 , 李 珍 萍 . 基 于 时 间 序 列 的 全 社 会 货 运 量 预 测 及 分 析 [J]. 物 流 技 术 , 2014,
33(9):128-130. [9] Rudakov K V, Strizhov V V, Kashirin D O, et al. Selecting an optimal model for forecasting the
volumes of railway goods transportation[J]. Automation and Remote Control, 2017, 78(1):75-87. [10] Farhan J, Ong G P. Forecasting seasonal container throughput at international ports using SARIMA models[J]. Maritime Economics & Logistics, 2018, 20(1):131-148. [11] 徐莉, 薛锋. 基于 GM(1,1)残差二次修正的铁路货运量预测[J]. 交通运输工程与信息学报, 2019, 17(2):44-50. [12] 贺政纲, 黄娟. 基于 FPSO 灰色 Verhulst 模型的铁路货运量预测[J]. 铁道学报, 2018, 40(8):5-12. [13] Yuan S Q, Bao X Y, Wang Q C. Research on railway freight volume prediction based on markov verhulst model[J]. Railway Standard Design, 2016, 60(10):27-30. [14] 褚衍昌, 连文浩, 王媛卓. 基于 GM-Markov 模型的京津冀区域物流需求量的预测[J]. 数学 的实践与认识, 2019(21):262-270. [15] 崔乃丹, 向万里, 孟学雷, 等. 基于小波灰色 GM(1,1)模型的货运量预测研究[J]. 铁道科学 与工程学报, 2017, 14(11):2480-2486. [16] Guo Z D, Fu J Y. Prediction method of railway freight volume based on genetic algorithm improved genetic algorithm improved general regression neural network[J]. Journal of Intelligent Systems, 2018, 27(2):291-302. [17] 耿立艳, 张天伟, 赵鹏. 基于灰色关联分析的 LS-SVM 铁路货运量预测[J]. 铁道学报, 2012, 34(3):1-6. [18] Qiu Y Y, Zhang Q, Lei M. Forecasting the railway freight volume in China based on combined PSO-LSTM model[J]. Journal of Physics: Conference Series, 2020, 1651(1):1-5. [19] Gao J, Lu X. Forecast of china railway freight volume by random forest regression model[C]. //2015 International Conference on Logistics, Informatics and Service Sciences (LISS). IEEE, 2015:1-6. [20] 侯维磊, 刘力军, 崔晶娜. 基于 GRA—PCA—GA—BP 网络模型的铁路货运量预测分析[J]. 铁道货运, 2017, 35(1):54-58.
61

北京交通大学硕士学位论文

参考文献

[21] Sun Y, Lang M X, Wang D Z, et al. A PSO-GRNN model for railway freight volume prediction: Empirical Study from China[J]. Journal of Industrial Engineering and Management, 2014, 7(2):413-433.
[22] Liu Y, Lang M X. Railway freight volume prediction based on support vector regression[J]. Applied Mechanics & Materials, 2014, 587-589:1954-1957.
[23] Moscoso-López J A, Turias I J, Aguilar J, et al. SVR-ensemble forecasting approach for Ro-Ro freight at port of Algeciras (Spain)[C]. //International Conference on Soft Computing Models in Industrial and Environmental Applications. Springer, Cham, 2018:357-366.
[24] 宋苏民, 旷文珍, 许丽, 等. RBF 神经网络在铁路货运量预测中的应用[J]. 铁路计算机应 用, 2017, 26(1):47-51.
[25] 徐玉萍, 邓俊翔, 蒋泽华. 基于组合预测模型的铁路货运量预测研究[J]. 铁道科学与工程 学报, 2021, 18(1):243-249.
[26] Feng F L, Li W, Jiang Q W. Railway freight volume forecast using an ensemble model with optimised deep belief network[J]. IET intelligent transport systems, 2018, 12(8):851-859.
[27] Uvarov N D, Kuznetsov M P, Malkova A S, et al. Selecting the superpositioning of models for railway freight forecasting[J]. Moscow University Computational Mathematics and Cybernetics, 2018, 42(4):186-193.
[28] Li X, Lang M. Combination prediction of railway freight volume based on support vector machine and NARX neural network[M]. Berlin Heidelberg:Springer, 2015:865-870.
[29] Du B C, Chen A L. Research on logistics demand forecast based on the combination of grey GM(1,1) and BP neural network[C]. //The 5th Annual International Conference on Network and Information Systems for Computers (ICNISC). IOP, 2019:1-7.
[30] 方文清, 蒋由辉, 文军. 分形理论用于航空货运量的预测[J]. 交通科技与经济, 2009, 11(2):105-106+109.
[31] Xiao M, Li C. Fuzzy regression prediction and application based on multi-dimensional factors of freight volume[J]. Earth and Environmental Science, 2018, 108(3):1-7.
[32] 张诚, 张广胜. 基于粗糙集理论的铁路货运需求预测研究[J]. 科技管理研究, 2012, 32(17):212-215.
[33] 韩敏. 混沌时间序列预测理论与方法[M]. 北京:中国水利水电出版社, 2007:79-92． [34] 廖荣华, 兰时勇, 刘正熙. 基于混沌时间序列局域法的短时交通流预测[J]. 计算机技术与
发展, 2015, 25(1):1-5. [35] Li Y, Jiang X, Zhu H, et al. Multiple measures-based chaotic time series for traffic flow
prediction based on bayesian theory[J]. Nonlinear Dynamics, 2016, 85(1):179-194. [36] Zhang Z, Zhang A, Sun C, et al. Research on air traffic flow forecast based on ELM
non-iterative algorithm[J]. Mobile Networks and Applications, 2020(2):1-15. [37] 王硕, 谷远利, 李萌, 等. 基于混沌理论和 MEA-BPNN 模型的快速路短时交通流预测[J].
山东科学, 2019, 32(2):98-107. [38] 陈伟, 赵庆堂, 郭建鹏, 等. 基于相空间重构的风电场日有功功率组合预测[J]. 电力系统
及其自动化学报, 2014, 26(6):20-24+36. [39] Tian Z D. Preliminary research of chaotic characteristics and prediction of short-term wind
speed time series[J]. International Journal of Bifurcation and Chaos, 2020, 30(12):1-24. [40] Li H, Romero C E, Zheng Y. Wind power forecasting based on principle component phase

62

北京交通大学硕士学位论文

参考文献

space reconstruction[J]. Renewable Energy, 2015, 81:737-744. [41] Xue H, Wang Y F, Fu Y C. An improved prediction method of PV output power based on
optimized chaotic phase space reconstruction[J]. IET Renewable Power Generation, 2020, 14(11):1831-1840. [42] Fan X H, Wang L, Li S S. Predicting chaotic coal prices using a multi-layer perceptron network model[J]. Resources Policy, 2016, 50:86-92. [43] Sun S H, Li H, Zhang Z F. Oil price predicting based on unified solving by phase space reconstruction and parameters[J]. Computer Engineering and Applications, 2013, 49(23):247-251. [44] Yu P F, Yan X S. Stock price prediction based on deep neural networks[J]. Neural Computing and Applications, 2020, 32(6):1609-1628. [45] Shi X T, Zhu B B. Carbon price forecasting based on phase space reconstruction and least square support vector regression[J]. Journal of Systems Science and Mathematical Sciences, 2017, 37(2):562-572. [46] 王硕. 基于特性分析的短时交通流预测方法研究[D]. 北京:北京交通大学学位论文, 2019. [47] Rosenstein M T, Collins J J, Luca C J. Reconstruction expansion as a geometry-based framework for choosing proper delay times[J]. Physica D: Nonlinear Phenomena, 1994, 73(1):82-98. [48] Fraser A M, Swinney H L. Independent coordinates for strange attractors from mutual information[J]. Physical Review A, 1986, 33(2):1134-1140. [49] Kennel M B, Brown R, Abarbanel H D, et al. Determining embedding dimension for phase-space reconstruction using a geometrical construction[J]. Physical Review A. 1992, 45(6):3403-4311. [50] 张艳兰, 栾元重, 尹燕运, 等. 混沌时间序列相空间重构及特性识别[J]. 测绘科学, 2016, 41(4):15-18. [51] Gatfaoui H, Peretti P D. Testing for non-chaoticity under noisy dynamics using the largest lyapunov exponent[J]. Soft Computing, 2020, 24(12):8617-8626. [52] Kim H S, Eykholt R, Salas J D. Nonlinear dynamics, delay times, and embedding windows[J]. PHYSICA D, 1999, 127(1):48-60. [53] Dragomiretskiy K, Zosso D. Variational mode decomposition[J]. IEEE Transaction on Signal Processing, 2014, 62(3):531-544. [54] 向超. 基于 ARIMA-SVR 组合模型的动力煤价格预测与实证研究[D]. 北京:对外经济贸易 大学学位论文, 2019. [55] 施佳. 基于 ARIMA-BP 组合模型的某餐饮 O2O 企业订单预测研究[D]. 北京:北京交通大 学学位论文, 2018. [56] 徐自励, 王一扬, 周激流. 估计非线性时间序列嵌入延迟时间和延迟时间窗的 C-C 平均方 法[J]. 四川大学学报(工程科学版), 2007, 39(1):151-155. [57] 董捷. 基于产业结构调整的铁路货物运输发展战略[J]. 全国流通经济, 2019(36):26-27. [58] 任 晓 雪 . 现 代 物 流 下 我 国 公 路 货 物 运 输 主 要 问 题 及 对 策 探 讨 [J]. 现 代 经 济 信 息 , 2018(11):379. [59] Li D D, Liu J L, Yang Z, et al. Speech emotion recognition using recurrent neural networks with directional self-attention[J]. Expert Systems with Applications, 2021, 173(3):1-13.

63

北京交通大学硕士学位论文

参考文献

[60] Xu G W, Su X M, Liu W X, et al. Target detection method based on improved particle search and convolution neural network[J]. IEEE Access, 2019, 7:25972-25979.
[61] Yu Y J, Wang X Z, Bründlinger R. Improved elman neural network short-term residents load forecasting considering human comfort index[J]. Journal of Electrical Engineering and Technology, 2019, 14:2315-2322.
[62] Cao Y W, Zeng M, Jiang S G, et al. Short-term forecast of multiple loads in integrated energy system based on IPSO-WNN[J]. E3S Web of Conferences, 2020, 194:1-5.

64

北京交通大学硕士学位论文

作者简历及攻读硕士学位期间取得的研究成果

作者简历及攻读硕士学位期间取得的研究成果
一、作者简历 姓名：徐菲 性别：女 出生年月：1996.07 教育经历： [1]2018.9-2021.6 北京交通大学 计算机与信息技术学院 计算机科学与技术 硕士 [2]2014.9-2018.6 东北林业大学 信息与计算机工程学院 计算机科学与技术 学士 二、发表论文 [1]徐菲, 任爽. 基于分解—集成的铁路货运需求预测研究.《运筹与管理》 三、参与科研项目 [1] 科技部重点研发项目：《高速铁路成网条件下运输需求预测应用技术研究》 [2] 国家铁路集团重点科研项目：《中欧班列信息平台关键技术研究》 [3] 中国科学技术协会项目：《网上科技工作者的数据决策分析及建设》

65

北京交通大学硕士学位论文

独创性声明

独创性声明
本人声明所呈交的学位论文是本人在导师指导下进行的研究工作和取得的研究成果，除 了文中特别加以标注和致谢之处外，论文中不包含其他人已经发表或撰写过的研究成果，也 不包含为获得北京交通大学或其他教育机构的学位或证书而使用过的材料。与我一同工作的 同志对本研究所做的任何贡献均已在论文中作了明确的说明并表示了谢意。

学位论文作者签名：

签字日期：

年 月 日

66

北京交通大学硕士学位论文

学位论文数据集

学位论文数据集

关键词*

密级*

货运需求预测； 公开

相空间重构；混

沌特性；神经网

络

表 1.1： 数据集页

中图分类号

UDC

学位授予单位名称*

北京交通大学

论文题名* 基于相空间重构的铁路货运需 求预测技术研究

作者姓名*

徐菲

培养单位名称*

北京交通大学

学位授予单位代码 * 10004 并列题名
培养单位代码* 10004

学科专业*

研究方向*

计算机科学与技术

大数据与预测

技术

论文提交日期* 2021 年 6 月

导师姓名*

任爽

评阅人

答辩委员会主席*

朱振峰

学位类别*
工学
学号* 培养单位地址 北京市海淀区西 直门外上园村 3 号 学制* 3年
职称* 答辩委员会成员

论文资助 国家重点研发计划资 助（2018YFB1201401， 高速铁路成网条件下 铁路客货运服务模式 设计与资源配置技 术） 学位级别*
硕士 论文语种* 汉语
18120430 邮编 100044
学位授予年* 2021 年
副教授

电子版论文提交格式 文本（√） 图像（ ） 视频（ ） 音频（ ） 多媒体（ ） 其他（ ）

推荐格式：application/msword；application/pdf

电子版论文出版（发布）者

电子版论文出版（发布）地

权限声明

论文总页数* 67 共 33 项，其中带*为必填数据，为 21 项。

67

